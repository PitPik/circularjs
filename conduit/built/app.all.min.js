!function(e,t){"use strict";var n=e.require||{},r=e.Math.random,i=null,o=0,a={},s=document.createElement("a"),l=function(e,t){if("object"!=typeof t||!t)return t;e=e||{};for(var n in t)e[n]=t[n].constructor===Array?t[n]:"object"==typeof t[n]?l(e[n],t[n]):t[n];return e},c=function(e){for(var t=["lookaheadMap","paths","options","baseUrl"],n=t.length;n--;)b[t[n]]=l(b[t[n]],e[t[n]])||b[t[n]]||""},u=function(e,t,n){return n=/(?:^\!|^http[s]*:|.*\.js$)/.test(e)?"":".js",e=(b.paths[e]||e).replace(/^\!/,""),p((b.baseUrl||".")+"/"+e+n).replace(/^.\//,"")},p=function(e){return s.href=e,(-1!==e.indexOf(s.host)?s.origin:"")+s.pathname+s.search},d=function(t,n,r,i){var o=e.document.createElement("script"),a={};return o.type="text/javascript",o.async=o.defer=!n,o.charset="utf-8",o.onload=o.onreadystatechange=function(e){var n=r._last;delete r._last,"load"!==e.type&&"complete"!==(e.currentTarget||e.srcElement).readyState||(t.factory||v(t),n&&!t.done&&(a=r[n.name],-1===t.parentNames.indexOf(i)&&t.parentNames.push(i),a.done&&(t.factory=function(){return a.done},v(t))),o.onload=o.onreadystatechange=null)},o.src=t.path,o},h=function(t){(i=i||e.document.createDocumentFragment()).appendChild(t),clearTimeout(o),o=setTimeout(function(){document.head.appendChild(i)},0)},f=function(e){for(var t=0,n=e.resolvedDeps.length;n--;)void 0!==(e.resolvedDeps[n]||{}).done&&t++;e.deps.length===t&&v(e)},m=function(e){for(var t=null,n=0,r=0,i=e.parentNames.length;r<i;r++)n=(t=x[e.parentNames[r]]).deps.indexOf(e.name),t.resolvedDeps[n]=e,!t.done&&f(t);e.parentNames=[]},v=function(e){e.done||(e.done=(e.factory||function(){}).apply(null,e.resolvedDeps.map(function(e){return e.done}))),m(e),b.options.debug||(delete e.factory,e.name.indexOf("_mod"))},g=function(e){var t=b.lookaheadMap[e];if(t&&-1===(b.paths[e]||"").indexOf(b.options.minifyPrefix)){b(t);for(var n=0,r=t.length;n<r;n++)b.lookaheadMap[t[n]]&&!x[t[n]]&&g(t[n])}};if(!e.define||!e.define.amd){var y=e.define=function(e,t,n,r){var i=[];if("string"!=typeof e)return a=b(e,t,n);if(x[e]){if(x[e].done)return m(x[e]),x[e].done;x[e].deps=t,x[e].factory=n}else x[e]={name:e,deps:t,factory:n,resolvedDeps:[],parentNames:[]};for(var o=0,s=t.length;o<s;o++)i=x[t[o]]&&x[t[o]].parentNames,x[t[o]]?-1===i.indexOf(e)&&i.push(e):(x[t[o]]={name:t[o],isFile:"!"===t[o].substr(0,1),path:u(t[o]),resolvedDeps:[],parentNames:[e]},x[t[o]].isFile?b.getFile(x[t[o]],v):(h(d(x[t[o]],r,x,e)),g(t[o]))),x[t[o]].done&&m(x[t[o]]);return f(x[e]),x[e]},b=e.require=function(e,t,n){var i="_mod"+(r()+r()),o=e.constructor===Array,a=o?t:e;return x._last=a?{factory:a,name:i}:void 0,o?y(i,e,t,n):y(i,[],e,t)},x=b.modules={},C=b.config=function(e){c(n=e)};b.getFile=function(e,t){return e},y.amd={},C(n)}}(this),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("toolbox",[],function(){return t(e)}):e.Toolbox=t(e)}(this,function(e,t){"use strict";function n(e){var t=document.cookie.split(e+"=")[1];return t&&t.split(";")[0]}function r(e,t,n){try{if(e.readyState===XMLHttpRequest.DONE){if(!(e.status<200||e.status>299))return e["xml"===t?"responseXML":"responseText"];var r=new Error(e.statusText);r.response=e.response,n(r)}}catch(e){n("Caught Exception: "+e.stack)}}function i(e){this._state=0,this._handled=!1,this._value=t,this._deferreds=[],c(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,setTimeout(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(e){return void s(t.promise,e)}a(t.promise,n)}else(1===e._state?a:s)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void c(n.bind(t),e)}e._state=1,e._value=t,l(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&setTimeout(function(){e._handled||console.warn("Possible Unhandled Promise Rejection:",e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1,r=function(e){n||(n=!0,s(t,e))};try{e(function(e){n||(n=!0,a(t,e))},r)}catch(e){r(e)}}var u=null,p=document.createElement("a"),d={closest:function(e,t,n){if(e.closest)d.closest=function(e,t){return e.closest(t)};else{var r=e.msMatchesSelector||e.webkitMatchesSelector||e.matches;d.closest=function(e,t){if(!(n||document.documentElement).contains(e))return null;do{if(r.call(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}}return d.closest(e,t,n)},$:function(e,t){return(t||document.body).querySelector(e)},$$:function(e,t){return(t||document.body).querySelectorAll(e)},parentsIndexOf:function(e,t){for(var n=e.length;n--;)if(e[n].contains(t))return n;return-1},addClass:function(e,t){e&&e.classList.add(t)},removeClass:function(e,t){e&&e.classList.remove(t)},toggleClass:function(e,t,n){if(e){var r=e.classList.contains(t);r&&!n?e.classList.remove(t):r||!1===n||e.classList.add(t)}},hasClass:function(e,t){return e&&e.classList.contains(t)},toggleClasses:function(e,t,n,r){e&&n&&d.removeClass(e,n),t&&d.addClass(t,r||n)},addEvents:function(e,t,n,r,i){for(var o=e.length;o--;)d.addEvent(e[o],t,n,r,i)},removeEvents:function(e,t,n){for(var r=t.length;r--;)d.removeEvent(e,t[r],n)},addEvent:function(e,t,n,r,i){d.addEvent.events=d.addEvent.events||[],d.addEvent.events.push({e:e,t:t,f:n,c:r,i:i||d}),e.addEventListener(t,n,r)},removeEvent:function(e,t,n){var r={},i=!1,o=0;for(o=(d.addEvent.events||[]).length;o--;)r=d.addEvent.events[o],i=!t||r.e===t&&(!n||n===r.t),r.i===(e||d)&&i&&(r.e.removeEventListener(r.t,r.f,r.c),d.addEvent.events.splice(o,1))},storageHelper:{fetch:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):t},saveLazy:function(e,t,n){d.lazy(function(){d.storageHelper.save(e,t)},n||d.storageHelper)},save:function(e,t){localStorage.setItem(t,JSON.stringify(e))}},lazy:function(e,t,n){clearTimeout(t._timer),t._timer=setTimeout(e,0,n)},itemsSorter:function(e,t,n,r){var i=e[n].toUpperCase(),o=t[n].toUpperCase();return r?i<o?1:i>o?-1:0:i<o?-1:i>o?1:0},normalizePath:function(e){return p.href=e,(-1!==e.indexOf(p.host)?p.origin:"")+p.pathname+p.search},ajax:function(e,i){var o=null,a=!1,s=(new Date).getTime(),l=0;return i=i||{},e=d.normalizePath(e),l=h[e]&&h[e].time||0,a=!0===i.cache?s+1e8:i.cache?l>s?l:s+i.cache:0,o=a&&!i.resetCache&&l>s?h[e]:null,o=o||new d.Promise(function(o,a){var s=new XMLHttpRequest,l=(i.method||i.type||"GET").toUpperCase();if(s||a("Giving up :( Cannot create an XMLHTTP instance"),i||(e=(i=e).url),s.onreadystatechange=function(){var e=r(this,i.dataType,a);if(e!==t){if("json"===i.dataType)try{e=JSON.parse(e)}catch(e){return void a("Caught Exception: "+e.stack)}o(e)}},s.open(l,e,i.async||!0,i.username,i.password),"xml"===i.dataType&&s.setRequestHeader("Content-Type","text/xml"),"GET"!==l&&i.csrf&&s.setRequestHeader("X-CSRF-Token",n(i.csrf)),i.headers)for(var c in i.headers)s.setRequestHeader(c,i.headers[c]);s.send(i.data)}),a?(h[e]=o,h[e].time=a):delete h[e],o},errorHandler:function(e){console.error(e)},Promise:i,requireResources:function(e,n,r){for(var i=[],o=null,a="",s=!1,l="",c="",p="styles"===n,h=p?"href":"src",f=p?e.styleSheets:e.scripts,m=u=u||d.captureResources();o=f.shift();)s=(a=o.getAttribute(h))&&-1!==a.indexOf("://"),l=d.normalizePath(e.path&&!s?e.path+"/"+a:""+a),a&&m[l]||(p||(c=o.text,(o=document.createElement("script")).setAttribute("type","text/javascript"),o.async=!0,a||(o.text=c)),a&&(o[h]=l,document.head.appendChild(o),m[l]=o),i.push(new d.Promise(function(e){a&&o.onload!==t?o.onload=function(){e(this)}:(!a&&(p?r:document.body).appendChild(o),e(o))})));return d.Promise.all(i)},captureResources:function(){for(var e={},t=[].slice.call(document.scripts).concat([].slice.call(d.$$("link",document))),n="",r=t.length;r--;)(n=t[r].getAttribute("src")||t[r].getAttribute("href"))&&(e[n=d.normalizePath(n)]=t[r]);return e}};e.Event=e.Event||function(e,t){var n=document.createEvent("CustomEvent");return t=t||{},n.initCustomEvent(e,t.bubbles||!1,t.cancelable||!1,t.detail),n};var h={};return i._cache={},i.prototype.catch=function(e){return this.then(null,e||function(e){console.error(e)})},i.prototype.then=function(e,t){var n=new i(function(){});return o(this,{onFulfilled:e||null,onRejected:t||null,promise:n}),n},i.prototype.cancel=function(e){var t=i._cache[e];return t&&(t._deferreds=[],t.then=t.catch=function(){},t._handled=!0),i._cache[e]=this},i.all=function(e){var t=[];return e.reduce(function(e,n){return e.then(function(){return n}).then(function(e){return t.push(e)})},new i(function(e,t){e(null)})).then(function(){return t})},e.require&&(require.getFile=function(e,t){d.ajax(e.path,{cache:"!!"!==e.name.substr(0,2)}).then(function(n){e.done=n,t(e)})}),d}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return t(e)}):e.Schnauzer=t(e)}(this,function(e,t){"use strict";function n(e,t){var n="{{"===t[0]?["{{2,3}","}{2,3}"]:t,r=e.options.characters+"\\][";e.inlineRegExp=new RegExp("("+n[0]+")([>!&=])*\\s*([\\w\\"+r+"\\.]+)\\s*([\\w"+r+"|\\.\\s]*)"+n[1],"g"),e.sectionRegExp=new RegExp("("+n[0]+")([#^][*%]*)\\s*([\\w"+r+"]*)(?:\\s+([\\w$\\s|./"+r+"]*))*("+n[1]+")((?:(?!\\1[#^])[\\S\\s])*?)\\1\\/\\3\\5","g"),e.elseSplitter=new RegExp(n[0]+"else"+n[1])}function r(e,t){for(var n=0,r=e.length;n<r;n++)t[t.length]=e[n];return t}function i(e,n,i,o){var a=i!==t,s=!e.__schnauzerData,l=a&&!s&&e.extra||[],c=!s&&e.helpers||[];return{extra:n?r(n,l):l,path:s?[e]:a?r(e.path,[i]):e.path,helpers:o?r(c,a&&[o]||[{}]):c,__schnauzerData:!0}}function o(e,t){for(var n=0,r=t.length;n<r;n++)"./"!==t[n]&&(e=e&&e[t[n]]);return e}function a(e,n){return e!==t?e:n}function s(e,n,r,i){if(r){var s=e.path[i]||{},l=e.helpers[i]||{},c=a(l[n],o(l,r));if(c===t&&(c=o(s,r)),c!==t)return c;for(var u=e.extra.length;u--;)if((c=a(e.extra[u][n],o(e.extra[u],r)))!==t)return c}}function l(e){if(!e)return{};var t=e.split("="),n=t.length>1?t[1]:t[0],r='"'===n.charAt(0)||"'"===n.charAt(0),i=!1,o=0,a=[],s=[],l=!1,c="%"===n.charAt(1)?2:"%"===n.charAt(0)?1:0;return r?n=n.replace(/(?:^['"]|['"]$)/g,""):((s=(n=c?n.substr(c):n).split("../")).length>1&&(n=("@"===s[0]&&"@"||"")+s.pop(),o=s.length),name=name.replace(/^(?:\.|this)\//,function(){return l=!0,""}),a=n.split(/[\.\/]/),n=n.replace(/^(\.\/|this\.|this\/|\*)/,function(e,t){return"*"===t?(i=!0,""):(l=!0,a[0]="./","")}).replace(/(?:^\[|\]$)/g,"")),{name:t.length>1?t[0]:n,value:n,isActive:c,isString:r,isInline:i,strict:l,keys:a,depth:o}}function c(e,t){return String(e).replace(t.entityRegExp,function(e){return t.options.entityMap[e]})}function u(e,t,n,r,o,a,l,u){return e.options.tools?e.options.tools(e,s,i,t,n,r,o,a,l,u):t[E(r)||a.isInline?"apply":"call"]({getData:function(e){return(e=a.rawParts[e]||{value:e,keys:[e],depth:0}).isString?e.value:s(o,e.value,e.keys,e.depth)},escapeHtml:function(t){return c(t,e)},getBody:function(){return l&&l(o)||""},gatAltBody:function(){return u&&u(o)||""}},a.isInline?[function(){return l||""},a.parts,e]:r)}function p(e,t,n,r,i,o,s){var l=t.name;return o=a(o,""),e.options.render?u(e,e.options.render,l,{name:l,data:n,section:!!t.section,partial:!!t.partial,isActive:t.isActive,fn:r,text:i,value:o,parent:t.parent,type:t.isInline&&e.decorators[l]&&"decorator"||t.partial&&e.partials[l]&&"partial"||e.helpers[l]&&"helper"||s||""},n,t,r):i+o}function d(e,t,n,r,i){for(var o={},a={},s=[],c=0,u=t.length,p={};c<u;c++)if(""!==t[c]){if("as"===t[c]){t.splice(c,1),s=[t.splice(c,1)[c],t.splice(c,1)[c]];break}o[(p=l(t[c])).name]=p,a[t[c]]=p}return{name:n.name,vars:t,parts:o,rawParts:a,partial:">"===i,isInline:n.isInline,isUnescaped:!e.options.doEscape||"&"===i||r,isActive:n.isActive,depth:n.depth,strict:n.strict,keys:n.keys,helpers:s}}function h(e,t,n,r,i,o){var a=i?{"@index":o,"@last":o===i-1,"@first":0===o,_parent:n&&[n.name,o]}:{};return a["@key"]=t,a["."]=a.this=e,0!==r.length&&(a[r[0]]=e,a[r[1]]=t),a}function f(e,t,n,r){var i=[],o=e.options.splitter;return t=t.replace(e.inlineRegExp,function(t,n,r,a,s){var c=r&&r.charAt(0)||"";return"!"===c||"="===c?"":(s=s.split(/\s+/),"-section-"===a?(a=l(s[1]),a.section=s[0],i.push(a),o):("*"===a&&(a+=s.shift()),i.push(d(e,s,l(a),"{{{"===n,c)),o))}).split(o),r=l(r).name,function(o,a){return m(e,o,t,n,r,i,a)}}function m(e,n,r,i,a,l,c){for(var d,h="",f="",m=null,g={},y={},b=0,x=r.length;b<x;b++)if((g=l[b])!==t)if(h+=r[b],g.section)g.parent=c&&o(n.helpers,[0,"_parent"]),h=p(e,g,n,m=i[g.section],h,m(n,c),a);else if(g.isInline)h=u(e,e.decorators[g.name||g.vars[0]],g.name,g.vars,n,g,h)||h,_(h)&&(h=h());else{if(g.partial){y=n.helpers[0]||(n.helpers[0]={}),d=t;for(var C in g.parts)d=g.parts[C],y[C]=d.keys.length&&s(n,d.name,d.keys,d.depth)||d.isString&&(d.value||d.name);f=e.partials[g.name](n)}else g.parent=c&&o(n.helpers,[0,"_parent"]),f=(m=v(e,g))(n);h=p(e,g,n,m,h,f,a)}else h=a?p(e,{},n,m,h,r[b],a):h+r[b];return h}function v(e,t){return function(n,r){var i=s(n,t.name,r||t.keys,t.depth),o=!t.strict&&(e.helpers[t.name]||e.partials[t.name])||_(i)&&i;return i=o?u(e,o,t.name,t.vars,n,t):i&&(t.isUnescaped?i:c(i,e))}}function g(e,t,n,r,i,o){var a=n;return n=l(!r.length||"if"!==n&&"each"!==n&&"with"!==n&&"unless"!==n?n:r.shift()),r=d(e,r,l(n.name),i,""),function(i,s){return y(e,i,t,n,r,o,a,s)}}function y(e,n,r,o,a,l,c,p){var d=s(n,o.name,E(p)?p:o.keys,o.depth),f=!o.strict&&(e.helpers[o.name]||_(d)&&d),m=f&&u(e,f,o.name,a.vars,n,a,r[0],r[1]),v=E(d),g="each"===c&&!v&&"object"==typeof d&&d,y="";if(d=d===t?E(n.path[0])&&n.path[0]:d,f){if(n.helpers[0]=h(m,o.name,t,a.helpers),"if"===c)return m?r[0](n):r[1]&&r[1](n);if("unless"===c)return m?r[1]&&r[1](n):r[0](n);v=E(d=m)}if("unless"===c?d=!d:g&&(d=N(d,[])),v||g){if(l)return d.length?"":r[0](d);n.path.unshift({}),n.helpers.unshift({});for(var b=0,x=d.length;b<x;b++)n.path[0]=v?d[b]:g[d[b]],n.helpers[0]=h(n.path[0],v?b:d[b],o,a.helpers,x,b),y+=r[0](n,d[b]);return n.path.shift(),n.helpers.shift(),y}return l&&!d||!l&&d?f&&"string"==typeof d?d:r[0]("unless"===c||"if"===c?n:i(n,t,d,h(d,o.name,t,a.helpers))):r[1]&&r[1](n)}function b(e,t,n){for(var r="",o=e.options.tags;r!==t&&(r=t);)t=t.replace(e.sectionRegExp,function(t,r,i,a,s,l,c){if("#*"===i){var u=s.replace(/(?:^['"]|['"]$)/g,"");return e.partials[u]=e.partials[u]||b(e,c,n),""}return c=c.split(e.elseSplitter),n.push(g(e,[f(e,c[0],n,a),c[1]&&f(e,c[1],n,a)],a,s&&s.replace(/[(|)]/g,"").split(/\s+/)||[],"{{{"===r,"^"===i)),o[0]+"-section- "+(n.length-1)+" "+(s||a)+o[1]});return t=f(e,t,n),function(e,n){return t(i(e,n&&(E(n)&&n||[n])))}}var x=function(e,n){this.version="1.3.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{},decorators:{},partials:{},recursion:"self",characters:'$"<>%-=@',splitter:"|##|",tools:t,render:t},C(this,n||{},e)},C=function(e,t,r){for(var i in t)e.options[i]=t[i];t=e.options,e.entityRegExp=new RegExp("["+N(t.entityMap,[]).join("")+"]","g"),n(e,t.tags),e.helpers=t.helpers,e.decorators=t.decorators,e.partials={};for(var o in t.partials)e.registerPartial(o,t.partials[o]);r&&e.registerPartial(t.recursion,r)},E=Array.isArray||function(e){return e&&e.constructor===Array},_=function(e){return e&&"function"==typeof e},N=Object.keys||function(e,t){for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return x.prototype={render:function(e,t){return this.partials[this.options.recursion](e,t)},parse:function(e){return this.registerPartial(this.options.recursion,e)},registerHelper:function(e,t){this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerDecorator:function(e,t){this.decorators[e]=t},unregisterDecorator:function(e,t){delete this.decorators[e]},registerPartial:function(e,t){return this.partials[e]=this.partials[e]||"function"==typeof t?t:b(this,t,[])},unregisterPartial:function(e){delete this.partials[e]},setTags:function(e){n(this,e)}},x}),function(e,t){"object"==typeof exports?module.exports=t(e,require("schnauzer")):"function"==typeof define&&define.amd?define("blick",["schnauzer"],function(n){return t(e,n)}):e.Blick=t(e,e.Schnauzer)}(this,function(e,t,n){"use strict";function r(e,t){for(var n in e)e[n]=document.createElement(e[n]);r=function(n){var r=((n||"").match(t)||[])[1],i=e[r]||e._default;return i.innerHTML=n||"",i}}function i(e,t){return document.evaluate('//text()[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue||document.evaluate('//@*[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function o(e){var t=f.length;return e.fn&&e.name&&e.isActive&&!e.partial&&"decorator"!==e.type&&"helper"!==e.type&&"@"!==e.name.charAt(0)?(e.isSection=s(e),f[t]=e,e.text+"{{#"+t+"}}"+e.value+"{{/"+t+"}}"):e.text+e.value}function a(e,t,n){return e.splitText(e.textContent.lastIndexOf(n)+n.length).textContent,e.splitText(e.textContent.indexOf(t))}function s(e,t){return e.section&&!e.type&&(-1!==e.value.indexOf("{{#")||t&&-1!==t.textContent.indexOf("{{#"))}function l(e){for(var t=!0,n={replacer:t,lastNode:t,fn:t,children:t,unregister:t,data:t},r=e.length;r--;){for(var i in e[r])n[i]||delete e[r][i];e[r]=null}return null}function c(e,t,n){for(;t.childNodes.length;)n.appendChild(t.childNodes[0]);if(!e)return n;e.parentNode.insertBefore(n,e.nextSibling)}function u(e,t,n,r){if(e&&0!==n.length)for(var i=n.length;i--;)n[i].children.push({unregister:function(e){return function(){r.unregisterProperty(e.name,e)}}(t)}),-1!==e.textContent.indexOf(n[i].search)&&(e.textContent=e.textContent.replace(n[i].search,""),n.pop());return n}function p(e,t,o,d,h){e.search;for(var m,v=r(o),g="",y="",b={},x={},C={},E=e.options,_=E.registerProperty,N=[],w=[],A={},k=t.length;k--;)g="{{#"+k+"}}",y="{{/"+k+"}}",b=t[k],(x=i(v,g))?x.ownerElement?(x.valueSplitter||((A=x.valueSplitter=[]).valueTracker={},A.push(x.textContent.replace(e.attrSplitter,function(e,t,n,r){return A.push(t),A.push(n),A.valueTracker[r]=A.length-1,""}))),b.replacer=function(e,t,r,i,o,a,s){return function(i,o){var l=o||a.fn(a.data,i);l===n&&(l=""),E.attributes[r]?(e=null,E.attributes[r](t,r,l)):l!==n&&(e.valueSplitter[e.valueSplitter.valueTracker[s]]=l,e.textContent=e.valueSplitter.join("").trim())}}(x,x.ownerElement,x.name,0,x.textContent,b,k),_(b,x),w=u(x.ownerElement.previousSibling,b,w,E),b.replacer(null,b.value)):s(b,x)?((w=u(x,b,w,E)).push({search:g,children:b.children=[]}),C=i(x.parentNode,y),b.lastNode=C=C.splitText(C.textContent.lastIndexOf(y)),C.textContent=C.textContent.replace(y,""),(x=x.splitText(x.textContent.indexOf(g))).textContent=x.textContent.replace(g,""),b.replacer=function(t,n){return function(r){for(;n.lastNode.previousSibling&&n.lastNode.previousSibling!==t;)t.parentNode.removeChild(n.lastNode.previousSibling);if(n.children)for(var i=n.children.length;i--;)n.children[i].unregister();t.textContent="",N=p(e,f,n.fn(n.data,r),t,h),n.children=l(N);for(var o=[],a=n.lastNode;a!==t&&(a=a.previousSibling);)1===a.nodeType&&o.push(a);return o}}(x,b),_(b,x)):(x=a(x,g,y),b.replacer=function(e,t){return function(n){e.textContent=t.fn(t.data,n)}}(x,b),x.textContent=b.value,_(b,x),w=u(x,b,w,E)):window.console&&console.warn("There might be an error in the SCHNAUZER template");return m=c(d,v,h),d||(t=l(t)),f=[],d?t:m}r({option:"select",legend:"fieldset",area:"map",param:"object",thead:"table",tr:"tbody",col:"colgroup",td:"td",_default:"div"},/<\s*(\w*)\s*[\s\S]*?>/);var d=function(e,t){this.version="0.0.1",this.options={registerProperty:m,unregisterProperty:m,attributes:{value:g,disabled:v,checked:v,autocomplete:v,contenteditable:v,readonly:v,required:v,selected:v}},h(this,t||{},e)},h=function(e,n,r){for(var i in n)if("attributes"===i)for(var a in n[i])e.options[i][a]=n[i][a];else e.options[i]=n[i];var s=e.options.registerProperty;e.options.registerProperty=function(e,t){s(e.name,e.replacer,e.data.path[0],e.isActive,e.parent,t)},n.render=o,e.search=/{{#\d+}}[\S\s]*{{\/\d+}}/,e.attrSplitter=/([^}{]*)({{#(\d+)}}[\s\S]*?{{\/\d+}})/g,e.schnauzer=new t(r,n)},f=[],m=function(){},v=function(e,t,n){!0===n||"true"===n||!n&&!1!==n?(e.setAttribute(t,""),e[t]=!0):(e.removeAttribute(t),e[t]=!1,"focus"===n&&e.focus())},g=function(e,t,n){e.setAttribute("value",n),e.value=n};return d.prototype={render:function(e,t){return this.schnauzer.render(e,t)},renderHTML:function(e,t){var n=document.createDocumentFragment(),r=this.schnauzer.render(e,t);return p(this,f,r,null,n)}},d}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("VOM",[],function(){return t(e)}):e.VOM=t(e)}(this,function(e,t){"use strict";function n(e,t){for(var n=0,r=t.length;n<r;n++){if("*"===t[n])return e;e=e&&e[t[n]]}return e}function r(e,t){for(var n=t.length;n--;)t[n][e.options.childNodes]&&r(e,t[n][e.options.childNodes]),delete b[e.id][t[n][e.options.idProperty]],t.pop();return t}function i(e,n){return n.__index!==t?n.__index:(n.parentNode?o(n.parentNode,e.options.childNodes):e.model).indexOf(n)}function o(e,t){return e[t]=e[t]||[],e[t]}function a(e,t,n,r,i,a){var u=e.options;return u.moveCallback.call(e,t,i,a),t.parentNode?u.parentCheck&&l(t,n,u):(t.__index=r,c(e,[t],n,i,a)),e.type=i,e.sibling=a,t.parentNode===n&&r>t.index&&-1!==t.index&&r--,t=-1!==t.index&&t.parentNode&&s(e,t,!0)||t,o(n,u.childNodes).splice(r||0,0,t),t.parentNode=n,t}function s(e,t,n){return!n&&r(e,[t]),o(t.parentNode,e.options.childNodes).splice(t.index,1)[0]||t}function l(e,t,n){var r=t;for(e===t&&m("ERROR: can't move element inside itself",n);r=r.parentNode;)r===e&&m("ERROR: can't move parent inside it's own child",n)}function c(e,t,n,r,i){for(var o=e.options,a=!1,s=!0,l=o.idProperty,h={},f=0,m=t.length;f<m;f++)(h=t[f])[l]||(h[l]="vom_"+x++,s=!1),b[e.id][h[l]]=h,a=!h.parentNode,h.parentNode=n||e.model.root,h.index=h.index||0,a&&(d(h,l,h[l],s),u(e,"index",{current:h},null,!0),u(e,"parentNode",{current:h},null,!0),p(e,h,e.options.listeners)),o.preRecursionCallback.call(e,h,r,i),h[o.childNodes]&&c(e,h[o.childNodes],h),o.enrichModelCallback.call(e,h,r,i),delete h.__index;return t}function u(e,t,n,r,i){var o={};if(e.options.forceEnhance||n.current.hasOwnProperty(t))return o[t]=n.current[t],h(e,t,n,o,!i,r)}function p(e,t,r,i,o){for(var a=[],s=0,l=0,c="",d={},h=[],f=r.length;f--;)if(a=r[f],s=a.indexOf("*"),c=(i||"")+a.join("."),d=o||n(t,a),-1!==s){l=s+1;for(var m in d)l===a.length?u(e,m,{current:d,root:t},c.replace("*",m)):(h=a.slice(l),p(e,t,[a.slice(l)],c.split("*")[0]+m+".",n(d[m],h.slice(0,h.length-1))))}else d=1!==a.length?n(o||t,a.slice(0,-1)):t,u(e,a[a.length-1],{current:o||d,root:t},c);return t}function d(e,t,n,r,i){return delete e[t],Object.defineProperty(e,t,{enumerable:!!i,configurable:!1,writable:!!r,value:n})}function h(e,t,n,r,o,a){return Object.defineProperty(n.current,t,{get:function(){return"index"===t?i(e,n.current):r[t]},set:function(i){f(a||t,n,r[t],r[t]=i,r,e)},enumerable:o})}function f(e,t,n,r,i,o){(e===o.options.idProperty||"index"===e||o.options.subscribe.call(o,o.type||e,t.root||t.current,r,n,o.sibling))&&(i[e]=n,m('ERROR: Cannot set property "'+e+'" to "'+r+'"',o.options)),delete o.type,delete o.sibling}function m(n,r){if(!r.throwErrors&&e!==t&&e.console)return console.warn?console.warn(n):console.log(n);throw n}var v=function(e,t){this.options={parentCheck:!1,idProperty:"id",subscribe:function(){},enrichModelCallback:function(){},preRecursionCallback:function(){},moveCallback:function(){},listeners:[],forceEnhance:!1,childNodes:"childNodes",throwErrors:!1},this.model=e||[],g(this,t||{})},g=function(e,t){var n={},r=e.options;b.push({}),d(e,"id",b.length-1);for(var i in t)r[i]=t[i];r.listeners=[];for(var o=t.listeners.length;o--;)t.listeners[o]&&(r.listeners[o]=t.listeners[o].split(y));n[r.childNodes]=e.model,d(e.model,"root",n),c(e,e.model)},y=/\.|\//,b=[],x=0;return v.prototype={getElementById:function(e){return b[this.id][e]},getElementsByProperty:function(e,r){var i=[],o=t!==r,a=t!==e,s=[],l=null;for(var c in b[this.id])l=t!==b[this.id][c][e]?b[this.id][c][e]:n(b[this.id][c],s[0]?s:s=a&&e.split(y)),(o&&l===r||!o&&t!==l||!o&&!a)&&i.push(b[this.id][c]);return i},appendChild:function(e,t){return t=t||this.model.root,a(this,e,t,o(t,this.options.childNodes).length,"appendChild",t)},prependChild:function(e,t){return t=t||this.model.root,a(this,e,t,0,"prependChild",t)},insertBefore:function(e,t){return a(this,e,t.parentNode,t.index,"insertBefore",t)},insertAfter:function(e,t){return a(this,e,t.parentNode,t.index+1,"insertAfter",t)},replaceChild:function(e,t){var n=t.index,r=t.parentNode;return e!==t&&s(this,t),a(this,e,r,n,"replaceChild",t),t},removeChild:function(e){return s(this,e),this.options.subscribe.call(this,"removeChild",e),e},sortChildren:function(e,t,n){for(var r=0,i=(t=(t||this.model).sort(e)).length;r<i;r++)this.options.subscribe.call(this,"sortChildren",t[r]),n&&t[r][this.options.childNodes]&&this.sort(e,t[r][this.options.childNodes],n)},addProperty:function(e,t,n){return u(this,e.split(y)[0],{current:t,root:t},e,n)},reinforceProperty:d,getProperty:function(e,t){return n(t,e.split(y))},getCleanModel:function(e){return JSON.parse(JSON.stringify(e||this.model))},destroy:function(){return r(this,this.model)}},v}),function(e,t){"object"==typeof exports?module.exports=t(e,require("toolbox"),require("blick"),require("VOM")):"function"==typeof define&&define.amd?define("circular",["toolbox","blick","VOM"],function(n,r,i){return t(e,n,r,i)}):e.Circular=t(e,e.Toolbox,e.Blick,e.VOM)}(this,function(e,t,n,r,i){"use strict";function o(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r].call(e,n)}function a(n,r,a){var l=e.onpopstate!==i?"popstate":"hashchange";t.addEvent(e,l,function(e){var t={};for(var i in n)(t=u(n[i],s(a)))&&o(r,n[i],t)},r.id)}function s(e){return decodeURI(e?location.hash.substr(e.length):location.pathname+location.search)}function l(e){var t=[];return e=e.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(e,n){return t.push(e.substr(1)),n?e:"([^/?]+)"}).replace(/\*/g,"([^?]*?)"),{regexp:new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$"),names:t}}function c(e){for(var t=0,n=(e=e?e.split("&"):[]).length,r={},i=[];t<n;t++)r[(i=e[t].split("="))[0]]=i[1];return r}function u(e,t){var n=e.regexp&&e.regexp.exec(t),r={};if(!n)return null;for(var i=0,o=(n=n.slice(1)).length;i<o;i++)n[i]=n[i]?i===o-1?n[i]:decodeURIComponent(n[i]):null,e.names[i]&&(r[e.names[i]]=n[i]);return n.parameters=r,n.queries=c(n[o-1]),n.path=t.replace(/^\//,"").split("/"),n}function p(e){for(var t=e.container.childNodes;t[0];)S[e.previousName].cache.appendChild(t[0])}function d(e,n,r,i){var o=e&&e.then?e:n.data,a=n.container,s=n.previousName,l=r[s],c=n.name,u=r[c].wrap,p=function(){s&&s!==c&&l.cache.appendChild(l.wrap)},d=function(){r[c].dontWrap&&(r[c].wrap=u=r[c].wrap.children[0],delete r[c].dontWrap),a&&a.appendChild(u),i&&!1!==n.init&&e(n.data,i)};!0===n.transition?(p(),d()):n.transition({container:a,remove:p,append:d,promise:new t.Promise(function(e){o?o.then(function(t){return e(),t}):e()}),component:u,previousComponent:(l||{}).wrap})}function h(e,t,n,r,i,o){var a="prependChild"===t,s={};11===e.nodeType?(s=e.children[0],"parent"===n.getAttribute("cr-mount")?s=s.children[0]:s.hasAttribute("cr-mount")&&s.removeChild(s.children[0]),s.setAttribute(i,o)):s=e;return s&&((a||"insertAfter"===t)&&(r=r&&r.nextSibling||a&&n.children[0],t=r?"insertBefore":"appendChild"),(n||s.parentElement)[t](s,r)),s}function f(e,t,n){for(var r=k(b(e.viewAttr),n),i="",o=(r=[n].concat([].slice.call(r))).length;o--;)(i=r[o].getAttribute(e.viewAttr))&&(t[i]=r[o])}function m(e,t,n,r,i){for(var o in e.prototype)r[o]||(i[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));return i}function v(e,t,n,r){var i=[],o=[],a={};if(n){a={};for(var s=0,l=0,c=(i=r||k("[cr-replace]",e)).length;l<c;l++)a[s=i[l].getAttribute("cr-replace")]||(i[l].parentNode.replaceChild(n[s],i[l]),a[s]=!0);(i=i.length!==n.length&&k("[cr-replace]",e)).length&&v(e,t,n,i)}else if(e&&t){for(var u={},l=0,p=(i=k(b(t),e)).length;l<p;l++)(u=document.createElement(i[l].tagName)).setAttribute("cr-replace",l),i[l].parentNode.replaceChild(u,i[l]),o.push(i[l]);return o}}function g(e,t){var n="";return"script"===e.tagName.toLowerCase()?e.innerHTML:(e.removeAttribute(t.templateAttr),n=e.outerHTML.replace(/(?:{{&gt;|cr-src=)/g,function(e){return"{"===e.charAt(0)?"{{>":"src="}),e.parentNode.removeChild(e),n)}function y(e,t,r,i){for(var o,a=r||document.body,s=e.containerAttr,l=b(e.templateAttr,i),c=r.hasAttribute(s)?r:A(b(s),r),u=c&&c.getAttribute(e.containerAttr),p=c&&(A(l,a)||A(l,document.body)),d=k(b(e.templatesAttr,i),a)||[],h={},f=d.length;f--;)o=g(d[f],e),h[d[f].id||d[f].getAttribute("name")]=new n(o,{helpers:t.helpers||e.helpers});return{element:r,template:p?g(p,e):p,templates:h,container:c,type:u?u+"Child":""}}function b(e,t){return"["+e+(t?'="'+t+'"]':"]")}function x(e,t){return e.isConnected!==i?e.isConnected:_this.options.appElement.contains(eventElement)}function C(e,n,r,i){var o,a=(t.closest(e.target,b(n))||r.element).getAttribute(n),s="elements.element",l=r.getElementById(a)||r.getElementsByProperty(s,r.element)[0]||r.getElementsByProperty(s,e.target)[0]||r.model[0],c=l&&l.events[e.type],u={},p=!1;for(var d in c)if(o=i.options.eventListeners[d])for(var h=c[d].length;h--;)x(u=c[d][h],i.options.appElement)?p||u!==e.target&&!u.contains(e.target)||(p=!1===o.call(r,e,u,l))&&e.stopPropagation():c[d].splice(h,1)}var E=function(e,t){this.options={componentAttr:"cr-component",containerAttr:"cr-container",templateAttr:"cr-template-for",templatesAttr:"cr-template",eventAttribute:"cr-event",viewAttr:"cr-view",devAttribute:"cr-dev",mountAttribute:"cr-mount",modelAttribute:"cr-model",elements:"elements",events:"events",views:"views",hash:"#",partials:{},helpers:{},decorators:{}},_(this,e,t)},_=function(e,n,r){var i="string"==typeof n;i||(r=n);for(var o in r)e.options[o]=r[o];e.version="0.1.0",e.components={},e.data={},e.id="cr_"+R++,e.Toolbox=t,e.name=i?n:e.id},N=function(e){this.options={appElement:document.body},w(this,e)},w=function(e,t){for(var n in t)e.options[n]=t[n];e.events={}},A=t.$,k=t.$$,R=0,P={},S={},T={},O=null,M={};return E.prototype.component=function(e,o){if("string"!=typeof e&&(e=(o=e).name||"component_"+R++),this.components[e])return this.components[e].reset(o.model,o.extraModel);var a=this,s={},l={},c=this.options,u=c.elements,p=c.componentAttr,d=b(p,e),g=o.componentElement||A(d,o.componentWrapper||document)||A(e,o.componentWrapper||document);if(g){var x=v(g,p),C=g&&g.getAttribute("name"),E=y(c,o,g,C||e),_=this.components[e]={name:e,model:o.model||[],element:E.element,container:E.container,templates:E.templates},w=o.mountSelector||b(c.mountAttribute),k=o.template,S=o.storage,O=S||{},L=t.storageHelper,D=S&&L.fetch(O.name)||{},j=O.category,I=O.listeners||o.listeners,q=O.storeAll||I&&-1!==I.indexOf("*");if(a.data[e]={extraModel:o.extraModel||c.extraModel},M[this.name]=M[this.name]||{},M[this.name][e]={},P[this.id]=P[this.id]||{},s=P[this.id][e]={},s.nestingData=x,o.onBeforeInit&&o.onBeforeInit(_),s.controller=o.eventListeners&&new N({appElement:E.element,eventAttribute:c.eventAttribute,eventListeners:o.eventListeners,instanceID:a.id}),s.collector={},s.template=k&&k.version?k:T[e]?T[e]:E.template?new n(k||E.template,{helpers:o.helpers||c.helpers,decorators:o.decorators||c.decorators,attributes:o.attributes||c.attributes||{},partials:c.partials,registerProperty:function(e,t,n,r,i){var o=i&&n[i[0]]&&!Object.getOwnPropertyDescriptor(n[i[0]],"0").get,a=i?i.slice(0):i;i&&o&&a.push(e);var l=s.collector[n["cr-id"]]=s.collector[n["cr-id"]]||{},c=a&&a.join(".")||e;l[c]=l[c]||[],l[c].push({fn:t,forceUpdate:2===r,parent:i&&("this"!==e&&"."!==e?i.concat(e.split(".")):i)})}}):null,s.template&&(T[e]=s.template),S){var H=D[j]||D;for(var z in _.model[0])H&&H[z]!==i&&(_.model[0][z]=H[z])}return s.vom=new r(_.model,{idProperty:a.options.idProperty||"cr-id",preRecursionCallback:function(t,n,r){var l=this.options.idProperty,p=t[l],d=s.template&&s.template.schnauzer.partials.self&&s.template.renderHTML(t,a.data[e].extraModel),m="replaceChild"===n&&r[u].element,v=t.parentNode[u]&&t.parentNode[u].container,g=d&&y||v||_.container,y=g?m||i:r&&r[u]&&r[u].element,b=d&&h(d,n||E.type||"appendChild",g,y,l,p)||_.element;this.reinforceProperty(t,u,{element:b,container:b.hasAttribute("cr-mount")?b:A(w,b)},!0),this.reinforceProperty(t,c.events,{},!0),s.controller&&s.controller.getEventListeners(t[u].element||_.element,t[c.events],_,l),this.reinforceProperty(t,c.views,{},!0),f(c,t[c.views],t[u].element||_.element),o.preRecursionCallback&&o.preRecursionCallback.call(this,t,b)},enrichModelCallback:this.options.enrichModelCallback||o.enrichModelCallback||function(){},listeners:this.options.listeners||o.listeners||[],subscribe:function(t,n,r,i,l){var p=this.options.idProperty,d=n[p],m=n[u]&&n[u].element,v=n.parentNode&&n.parentNode[u]?n.parentNode[u].container||n.parentNode[u].element:_.container,g=[];if("removeChild"===t)h(m,t,m.parentElement),delete s.collector[d];else if("sortChildren"===t)h(m,"appendChild",v);else if(this[t])if(n===l){m=h(s.template.renderHTML(n,a.data[e].extraModel),t,v,l[u].element,p,n[p]),n[u].element=m,n[u].container=A(w,m);for(b=(n.childNodes||[]).length;b--;)n[u].container.appendChild(n.childNodes[b].elements.element);n[c.events]={},s.controller&&s.controller.getEventListeners(n[u].element||_.element,n[c.events],_,this.options.idProperty),n[c.views]={},f(c,n[c.views],n[u].element||_.element)}else"replaceChild"===t||this.__isNew||h(m,t,v,l[u]&&l[u].element);else S&&(q||-1!==I.indexOf(t))&&(D=L.fetch(O.name)||{},q?D[j]=_.model[0]:(D[j]=D[j]||{},D[j][t]=r),L[!1===O.saveLazy?"save":"saveLazy"](j?D:D[j],O.name,this));if(g=s.collector[d]&&s.collector[d][t])for(var y,b=g.length;b--;)if((g[b].forceUpdate||r!==i)&&(y=g[b].fn(g[b].parent),s.controller&&y))for(var x=y.length;x--;)s.controller.getEventListeners(y[x],n[c.events],_,p,!0);o.subscribe&&o.subscribe.call(this,t,n,r,i),a.publish(_,e,t,{property:t,item:n,value:r,oldValue:i})}}),v(g,null,x),l=m(r,s.vom,0,this,l),l.uncloak=function(e){var e=e&&e.element||_.element;t.removeClass(e,"cr-cloak"),e.removeAttribute("cr-cloak")},l.reset=function(e,t){t&&(a.data[_.name].extraModel=t),s.vom.destroy(),this.container&&(this.container.innerHTML=""),s.vom.__isNew=!0;for(var n=0,r=e.length;n<r;n++)this.appendChild(e[n]);return s.nestingData.length&&v(g,null,s.nestingData),delete s.vom.__isNew,_},_.__proto__=l,o.onInit&&o.onInit(_),_}},E.prototype.getBaseModel=function(e){var t=this.components[e];return t?t.model[0]:null},E.prototype.destroy=function(e){var t=P[this.id],n={};for(var r in t)if(!e||e===r)for(var i in t[r])(n=t[r][i])&&n.destroy&&n.destroy(r)},E.prototype.model=function(e,t){return new r(e,t)},E.prototype.template=function(e,t){(t=t||{}).helpers=t.helpers||this.options.helpers;var r=new n(e,t);if(t.share)for(var i in r.schnauzer.partials)this.options.partials[i]||"self"===i||(this.options.partials[i]=r.schnauzer.partials[i]);return r},E.Toolbox=t,E.prototype.subscribe=function(e,t,n,r,o){if(e=e?e.name||e.components&&e.components[t]||e:this.name,M[e]=M[e]||{},(t=M[e][t]=M[e][t]||{})[n]=t[n]||[],r&&(t[n].push(r.callback||r),r.regexp&&!t[n].regexp&&(t[n].regexp=r.regexp,t[n].names=r.names)),n&&t[n])return o&&t[n].value!==i&&(r.callback||r).call(this,t[n].value),r.callback||r;delete M[e]},E.prototype.publish=function(e,t,n,r){e="string"==typeof e?e:this.name,M[e]=M[e]||{},M[e]&&((t=M[e][t]=M[e][t]||{})[n]=t[n]||[],t[n].value=r,t[n][0]&&o(this,t[n],r))},E.prototype.unsubscribe=function(e,t,n,r){var i=-1,o={};return e=e||this.name,M[e]&&M[e][t]&&M[e][t][n]&&-1!==(i=(o=M[e][t][n]).indexOf(r.callback||r))&&o.splice(i,1),r.callback||r},E.prototype.addRoute=function(e,t,n){var r="object"==typeof e.path?{regexp:e.path}:l(e.path),i=n||this.options.hash,o=u(r,s(i)),c=M[this.name]&&M[this.name].__router;return this.subscribe(null,"__router",e.path,{callback:e.callback,names:r.names,regexp:r.regexp||r},t),t&&o&&e.callback.call(this,o),!c&&a(M[this.name].__router,this,i),e},E.prototype.removedRoute=function(e){return this.unsubscribe(null,"__router",e.path,e.callback)},E.prototype.toggleRoute=function(e,t){var n=M[this.name].__router,r=n[e.path].paused||n[e.path];n[e.path]=t?r:[],n[e.path].paused=t?null:r},E.prototype.loadResource=function(e,n){var r=this,i=function(e){return!e.hasAttribute(r.options.devAttribute)};return t.ajax(e,{cache:n}).then(function(t){return O=O||document.implementation.createHTMLDocument(""),O.documentElement.innerHTML=t,{scripts:[].slice.call(O.scripts).filter(function(e){return"text/javascript"===e.type&&i(e.parentNode.removeChild(e))}),styleSheets:[].slice.call(k("link",O)||[]).filter(i).concat([].slice.call(k("style",O)||[]).filter(i)),body:O.body,head:O.head,path:e.split("/").slice(0,-1).join("/")}}).catch()},E.prototype.insertResources=function(e,n){var r=A(b(this.options.devAttribute,"container"),n.body)||n.body;for(t.requireResources(n,"styles",e);r.childNodes[0];)e.appendChild(r.childNodes[0]);return t.requireResources(n,"scripts",e)},E.prototype.insertModule=function(e,t){var n=this;return this.loadResource(e,!0).then(function(e){return n.insertResources(t,e).then(function(){return{path:e.path,container:t}})})},E.prototype.renderModule=function(e){var n=null,r=e.container,i=S,o=e.name,a=o&&i[o],s=a&&a.init,l=e.transition,c=t.Promise;return!i[e.previousName]||l&&o||p(e),o&&a?(s=s&&s(e.data,a.path),l?d(s,e,i):e.container.appendChild(a.cache),new c(function(t){t(e.returnData?e.data:s)})):(i[o]=a={cache:document.createDocumentFragment(),dontWrap:e.dontWrap},r||((n=document.createElement("div")).style.display="none",document.body.appendChild(n)),l&&(a.wrap=document.createElement("div"),a.wrap.setAttribute("cr-wrap",o),n?n.appendChild(a.wrap):e.data&&-1===(e.preInit||[]).indexOf(e.name)&&"*"!==(e.preInit||[])[0]||e.container.appendChild(a.wrap)),o?this.insertModule(e.path,a.wrap||e.container||n).then(function(t){return new c(function(s){var c=!0===e.require?o:!1===e.require?"":e.require;a.path=t.path,c?require([c],function(o){a.init=o,r||l?l?d(o,e,i,t.path):!1!==e.init&&o(e.data,t.path):(!1!==e.init&&o(e.data,t.path),e.container=n,p(e),n.parentElement.removeChild(n)),e.data&&e.data.then?e.data.then(function(){s(e.returnData?e.data:o)}):s(e.returnData?e.data:o)}):n&&(p(e),n.parentElement.removeChild(n),s())})}).catch():new c(function(e){e()}))},N.prototype={getEventListeners:function(e,t,n,r,o){for(var a=this.options.eventAttribute,s=e.querySelectorAll(b(a)),l="",c="",u="",p="",d=[],h={},f=e!==n.element?n.element:[],m=(s=[e].concat([].slice.call(s),f)).length;m--;)if(l=s[m].getAttribute(a))for(var v=(d=l.split(/\s*;+\s*/)).length;v--;)u=(c=d[v].split(/\s*:+\s*/))[0],p=c[1],(h=t[u]=t[u]||{})[p]===i&&(h[p]=[]),h[p].push(s[m]),this.events[u]||(this.events[u]=!0);this.installed&&!o||this.installEventListeners(n,r)},installEventListeners:function(e,n){var r=this;this.installed=this.installed||{};for(var i in this.events)this.installed[i]||(t.addEvent(this.options.appElement,i,function(t){C(t,n,e,r)},!!/(?:focus|blur|mouseenter|mouseleave)/.test(i),this.options.instanceID+"_"+e.name),this.installed[i]=!0);i||(this.installed=!1)},destroy:function(e){t.removeEvent(this.options.instanceID+"_"+e.name)}},E});
;define('!ui-components',[],function(){return '{{#* inline "author-image"}}\n<img{{#image}} src="{{.}}"{{/image}} class="{{#if id}}comment-author-img {{/if}}{{class}}" alt="" />\n{{/inline}}\n\n{{#* inline "author-data"}}\n<a href="#/profile/{{author.username}}" title="Profile data {{author.username}}" class="{{#if id}}comment-author{{/if}}">\n{{> author-image image=author.image}}\n</a>\n{{#unless id}}<div class="info">{{else}}&nbsp;{{/unless}}\n<a href="#/profile/{{author.username}}" title="Profile data {{author.username}}" class="{{#if id}}comment-{{/if}}author">{{author.username}}</a>\n<span class="date{{#if id}}-posted{{/if}}">{{simple-date createdAt}}</span>\n{{#unless id}}</div>{{/unless}}\n{{/inline}}\n\n{{#* inline "follow-button"}}\n{{#itsme user username}}\n<a class="btn btn-sm btn-outline-secondary action-btn" href="#/settings">\n<i class="ion-gear-a"></i> Edit Profile Settings\n</a>\n{{else}}\n<button class="btn btn-sm {{#%author.following}}btn-secondary{{else}}btn-outline-secondary{{/%author.following}}  {{extra}}" cr-event="click: follow">\n<i class="ion-plus-round"></i>\n&nbsp;\n{{#%author.following}}Unfollow{{else}}Follow{{/%author.following}} {{username}}\n</button>\n{{/itsme}}\n{{/inline}}\n\n{{#* inline "article-meta"}}\n<div class="article-meta">\n{{> author-data}}\n{{#if isMine}}\n<a class="btn btn-outline-secondary btn-sm" href="#/editor/{{slug}}">\n<i class="ion-edit"></i> Edit Article\n</a>\n&nbsp;&nbsp;\n<button class="btn btn-outline-danger btn-sm" cr-event="click: delete">\n<i class="ion-trash-a"></i> Delete Article\n</button>\n{{else}}\n{{> follow-button username=author.username}}\n&nbsp;&nbsp;\n<button class="btn btn-sm {{#%favorited}}btn-primary{{else}}btn-outline-primary{{/%favorited}}" cr-event="click: like">\n<i class="ion-heart"></i>\n&nbsp;\n{{#%favorited}}Unfavorite Post{{else}}Favorite Post{{/%favorited}} <span class="counter">({{%favoritesCount}})</span>\n</button>\n{{/if}}\n</div>\n{{/inline}}\n\n{{#* inline "tag-list"}}\n<ul class="tag-list">\n{{#each tagList}}<li class="tag-default tag-pill tag-outline" cr-event="click: getTag">{{#if ../renderLink}}<a href="#/articles/0/{{this}}">{{this}}</a>{{else}}{{this}}{{/if}}</li>{{/each}}\n</ul>\n{{/inline}}\n\n{{#* inline "article-preview"}}\n<div class="article-preview">\n<div class="article-meta">\n{{> author-data}}\n<button class="btn{{#%favorited}} btn-primary{{else}} btn-outline-primary{{/%favorited}} btn-sm pull-xs-right" cr-event="click: like">\n<i class="ion-heart"></i> {{%favoritesCount}}\n</button>\n</div>\n<a href="#/article/{{slug}}" title="Read more" class="preview-link">\n<h1>{{title}}</h1>\n<p>{{description}}</p>\n<span>Read more...</span>\n{{> tag-list}}\n</a>\n</div>\n{{/inline}}'});
!function(e){"use strict";var k={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:g,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,nptable:g,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:g,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}>|<\/?(?:tag)(?: +|\n|\/?>)|<(?:script|pre|style|!--))[^\n]+)*)/,text:/^[^\n]+/};function a(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||d.defaults,this.rules=k.normal,this.options.pedantic?this.rules=k.pedantic:this.options.gfm&&(this.options.tables?this.rules=k.tables:this.rules=k.gfm)}k._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,k._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,k.def=t(k.def).replace("label",k._label).replace("title",k._title).getRegex(),k.bullet=/(?:[*+-]|\d+\.)/,k.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,k.item=t(k.item,"gm").replace(/bull/g,k.bullet).getRegex(),k.list=t(k.list).replace(/bull/g,k.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+k.def.source+")").getRegex(),k._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",k._comment=/<!--(?!-?>)[\s\S]*?-->/,k.html=t(k.html,"i").replace("comment",k._comment).replace("tag",k._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),k.paragraph=t(k.paragraph).replace("hr",k.hr).replace("heading",k.heading).replace("lheading",k.lheading).replace("tag",k._tag).getRegex(),k.blockquote=t(k.blockquote).replace("paragraph",k.paragraph).getRegex(),k.normal=f({},k),k.gfm=f({},k.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),k.gfm.paragraph=t(k.paragraph).replace("(?!","(?!"+k.gfm.fences.source.replace("\\1","\\2")+"|"+k.list.source.replace("\\1","\\3")+"|").getRegex(),k.tables=f({},k.gfm,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),k.pedantic=f({},k.normal,{html:t("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",k._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/}),a.rules=k,a.lex=function(e,t){return new a(t).lex(e)},a.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},a.prototype.token=function(e,t){var n,r,s,i,l,o,a,h,p,c,u,g,f,d,b,m;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),1<s[0].length&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:y(s,"\n")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(t&&(s=this.rules.nptable.exec(e))&&(o={type:"table",header:x(s[1].replace(/^ *| *\| *$/g,"")),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3]?s[3].replace(/\n$/,"").split("\n"):[]}).header.length===o.align.length){for(e=e.substring(s[0].length),u=0;u<o.align.length;u++)/^ *-+: *$/.test(o.align[u])?o.align[u]="right":/^ *:-+: *$/.test(o.align[u])?o.align[u]="center":/^ *:-+ *$/.test(o.align[u])?o.align[u]="left":o.align[u]=null;for(u=0;u<o.cells.length;u++)o.cells[u]=x(o.cells[u],o.header.length);this.tokens.push(o)}else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,t),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),a={type:"list_start",ordered:d=1<(i=s[2]).length,start:d?+i:"",loose:!1},this.tokens.push(a),n=!(h=[]),f=(s=s[0].match(this.rules.item)).length,u=0;u<f;u++)c=(o=s[u]).length,~(o=o.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(c-=o.length,o=this.options.pedantic?o.replace(/^ {1,4}/gm,""):o.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&u!==f-1&&(i===(l=k.bullet.exec(s[u+1])[0])||1<i.length&&1<l.length||(e=s.slice(u+1).join("\n")+e,u=f-1)),r=n||/\n\n(?!\s*$)/.test(o),u!==f-1&&(n="\n"===o.charAt(o.length-1),r||(r=n)),r&&(a.loose=!0),m=void 0,(b=/^\[[ xX]\] /.test(o))&&(m=" "!==o[1],o=o.replace(/^\[[ xX]\] +/,"")),p={type:"list_item_start",task:b,checked:m,loose:r},h.push(p),this.tokens.push(p),this.token(o,!1),this.tokens.push({type:"list_item_end"});if(a.loose)for(f=h.length,u=0;u<f;u++)h[u].loose=!0;this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(t&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),s[3]&&(s[3]=s[3].substring(1,s[3].length-1)),g=s[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[g]||(this.tokens.links[g]={href:s[2],title:s[3]});else if(t&&(s=this.rules.table.exec(e))&&(o={type:"table",header:x(s[1].replace(/^ *| *\| *$/g,"")),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3]?s[3].replace(/(?: *\| *)?\n$/,"").split("\n"):[]}).header.length===o.align.length){for(e=e.substring(s[0].length),u=0;u<o.align.length;u++)/^ *-+: *$/.test(o.align[u])?o.align[u]="right":/^ *:-+: *$/.test(o.align[u])?o.align[u]="center":/^ *:-+ *$/.test(o.align[u])?o.align[u]="left":o.align[u]=null;for(u=0;u<o.cells.length;u++)o.cells[u]=x(o.cells[u].replace(/^ *\| *| *\| *$/g,""),o.header.length);this.tokens.push(o)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(t&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var n={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:g,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(href(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s])__(?!_)|^\*\*([^\s])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*"<\[])\*(?!\*)|^_([^\s][\s\S]*?[^\s_])_(?!_)|^_([^\s_][\s\S]*?[^\s])_(?!_)|^\*([^\s"<\[][\s\S]*?[^\s*])\*(?!\*)|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:g,text:/^(`+|[^`])[\s\S]*?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function h(e,t){if(this.options=t||d.defaults,this.links=e,this.rules=n.normal,this.renderer=this.options.renderer||new r,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=n.pedantic:this.options.gfm&&(this.options.breaks?this.rules=n.breaks:this.rules=n.gfm)}function r(e){this.options=e||d.defaults}function s(){}function p(e){this.tokens=[],this.token=null,this.options=e||d.defaults,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options}function c(e,t){if(t){if(c.escapeTest.test(e))return e.replace(c.escapeReplace,function(e){return c.replacements[e]})}else if(c.escapeTestNoEncode.test(e))return e.replace(c.escapeReplaceNoEncode,function(e){return c.replacements[e]});return e}function u(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function t(n,e){return n=n.source||n,e=e||"",{replace:function(e,t){return t=(t=t.source||t).replace(/(^|[^\[])\^/g,"$1"),n=n.replace(e,t),this},getRegex:function(){return new RegExp(n,e)}}}function i(e,t){return l[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?l[" "+e]=e+"/":l[" "+e]=y(e,"/",!0)),e=l[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}n._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,n._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,n._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,n.autolink=t(n.autolink).replace("scheme",n._scheme).replace("email",n._email).getRegex(),n._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,n.tag=t(n.tag).replace("comment",k._comment).replace("attribute",n._attribute).getRegex(),n._label=/(?:\[[^\[\]]*\]|\\[\[\]]?|`[^`]*`|[^\[\]\\])*?/,n._href=/\s*(<(?:\\[<>]?|[^\s<>\\])*>|(?:\\[()]?|\([^\s\x00-\x1f\\]*\)|[^\s\x00-\x1f()\\])*?)/,n._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,n.link=t(n.link).replace("label",n._label).replace("href",n._href).replace("title",n._title).getRegex(),n.reflink=t(n.reflink).replace("label",n._label).getRegex(),n.normal=f({},n),n.pedantic=f({},n.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:t(/^!?\[(label)\]\((.*?)\)/).replace("label",n._label).getRegex(),reflink:t(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",n._label).getRegex()}),n.gfm=f({},n.normal,{escape:t(n.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:t(n.text).replace("]|","~]|").replace("|$","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|$").getRegex()}),n.gfm.url=t(n.gfm.url).replace("email",n.gfm._extended_email).getRegex(),n.breaks=f({},n.gfm,{br:t(n.br).replace("{2,}","*").getRegex(),text:t(n.gfm.text).replace("{2,}","*").getRegex()}),h.rules=n,h.output=function(e,t,n){return new h(t,n).output(e)},h.prototype.output=function(e){for(var t,n,r,s,i,l,o="";e;)if(i=this.rules.escape.exec(e))e=e.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(e))e=e.substring(i[0].length),r="@"===i[2]?"mailto:"+(n=c(this.mangle(i[1]))):n=c(i[1]),o+=this.renderer.link(r,null,n);else if(this.inLink||!(i=this.rules.url.exec(e))){if(i=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.inRawBlock=!1),e=e.substring(i[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):c(i[0]):i[0];else if(i=this.rules.link.exec(e))e=e.substring(i[0].length),this.inLink=!0,r=i[2],this.options.pedantic?(t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r))?(r=t[1],s=t[3]):s="":s=i[3]?i[3].slice(1,-1):"",r=r.trim().replace(/^<([\s\S]*)>$/,"$1"),o+=this.outputLink(i,{href:h.escapes(r),title:h.escapes(s)}),this.inLink=!1;else if((i=this.rules.reflink.exec(e))||(i=this.rules.nolink.exec(e))){if(e=e.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){o+=i[0].charAt(0),e=i[0].substring(1)+e;continue}this.inLink=!0,o+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(e))e=e.substring(i[0].length),o+=this.renderer.strong(this.output(i[4]||i[3]||i[2]||i[1]));else if(i=this.rules.em.exec(e))e=e.substring(i[0].length),o+=this.renderer.em(this.output(i[6]||i[5]||i[4]||i[3]||i[2]||i[1]));else if(i=this.rules.code.exec(e))e=e.substring(i[0].length),o+=this.renderer.codespan(c(i[2].trim(),!0));else if(i=this.rules.br.exec(e))e=e.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(e))e=e.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.inRawBlock?o+=this.renderer.text(i[0]):o+=this.renderer.text(c(this.smartypants(i[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===i[2])r="mailto:"+(n=c(i[0]));else{for(;l=i[0],i[0]=this.rules._backpedal.exec(i[0])[0],l!==i[0];);n=c(i[0]),r="www."===i[1]?"http://"+n:n}e=e.substring(i[0].length),o+=this.renderer.link(r,null,n)}return o},h.escapes=function(e){return e?e.replace(h.rules._escapes,"$1"):e},h.prototype.outputLink=function(e,t){var n=t.href,r=t.title?c(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,c(e[1]))},h.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},h.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,s=0;s<r;s++)t=e.charCodeAt(s),.5<Math.random()&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},r.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+c(t,!0)+'">'+(n?e:c(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:c(e,!0))+"</code></pre>"},r.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},r.prototype.html=function(e){return e},r.prototype.heading=function(e,t,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},r.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},r.prototype.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},r.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},r.prototype.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},r.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},r.prototype.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},r.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},r.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},r.prototype.strong=function(e){return"<strong>"+e+"</strong>"},r.prototype.em=function(e){return"<em>"+e+"</em>"},r.prototype.codespan=function(e){return"<code>"+e+"</code>"},r.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},r.prototype.del=function(e){return"<del>"+e+"</del>"},r.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(u(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return n}this.options.baseUrl&&!o.test(e)&&(e=i(this.options.baseUrl,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch(e){return n}var s='<a href="'+c(e)+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>"},r.prototype.image=function(e,t,n){this.options.baseUrl&&!o.test(e)&&(e=i(this.options.baseUrl,e));var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},r.prototype.text=function(e){return e},s.prototype.strong=s.prototype.em=s.prototype.codespan=s.prototype.del=s.prototype.text=function(e){return e},s.prototype.link=s.prototype.image=function(e,t,n){return""+n},s.prototype.br=function(){return""},p.parse=function(e,t){return new p(t).parse(e)},p.prototype.parse=function(e){this.inline=new h(e.links,this.options),this.inlineText=new h(e.links,f({},this.options,{renderer:new s})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},p.prototype.next=function(){return this.token=this.tokens.pop()},p.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},p.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},p.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,u(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,s="",i="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(s+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});i+=this.renderer.tablerow(n)}return this.renderer.table(s,i);case"blockquote_start":for(i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":i="";for(var l=this.token.ordered,o=this.token.start;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,l,o);case"list_item_start":i="";var a=this.token.loose;for(this.token.task&&(i+=this.renderer.checkbox(this.token.checked));"list_item_end"!==this.next().type;)i+=a||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(i);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},c.escapeTest=/[&<>"']/,c.escapeReplace=/[&<>"']/g,c.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,c.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var l={},o=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function g(){}function f(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function x(e,t){var n=e.replace(/\|/g,function(e,t,n){for(var r=!1,s=t;0<=--s&&"\\"===n[s];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function y(e,t,n){if(0===e.length)return"";for(var r=0;r<e.length;){var s=e.charAt(e.length-r-1);if(s!==t||n){if(s===t||!n)break;r++}else r++}return e.substr(0,e.length-r)}function d(e,n,r){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(r||"function"==typeof n){r||(r=n,n=null);var s,i,l=(n=f({},d.defaults,n||{})).highlight,t=0;try{s=a.lex(e,n)}catch(e){return r(e)}i=s.length;var o=function(t){if(t)return n.highlight=l,r(t);var e;try{e=p.parse(s,n)}catch(e){t=e}return n.highlight=l,t?r(t):r(null,e)};if(!l||l.length<3)return o();if(delete n.highlight,!i)return o();for(;t<s.length;t++)!function(n){"code"!==n.type?--i||o():l(n.text,n.lang,function(e,t){return e?o(e):null==t||t===n.text?--i||o():(n.text=t,n.escaped=!0,void(--i||o()))})}(s[t])}else try{return n&&(n=f({},d.defaults,n)),p.parse(a.lex(e,n),n)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(n||d.defaults).silent)return"<p>An error occurred:</p><pre>"+c(e.message+"",!0)+"</pre>";throw e}}g.exec=g,d.options=d.setOptions=function(e){return f(d.defaults,e),d},d.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new r,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tables:!0,xhtml:!1}},d.defaults=d.getDefaults(),d.Parser=p,d.parser=p.parse,d.Renderer=r,d.TextRenderer=s,d.Lexer=a,d.lexer=a.lex,d.InlineLexer=h,d.inlineLexer=h.output,d.parse=d,"undefined"!=typeof module&&"object"==typeof exports?module.exports=d:"function"==typeof define&&define.amd?define('marked',[],function(){return d}):e.marked=d}(this||("undefined"!=typeof window?window:global));
;define("template-helpers",[],function(){var a={short:{},numeric:{}};return function(t){return{itsme:function(e,t){return this.getData(e)===this.getData(t)?this.getBody():this.gatAltBody()},"my-comment":function(e,t){return this.getData(e)===this.getData(t)?this.getBody():""},"simple-date":function(e,t){var n=this.getData(e),r={year:"numeric",month:"long",day:"short"===t?void 0:"numeric"},i=r.day||"short",o=n.substr(0,10);return a[i][o]=a[i][o]||new Date(n).toLocaleDateString(void 0,r),a[i][o]},markdown:function(e){return t.markdown(this.getData(e).trim())}}}}),define("form-helper",[],function(){var o={parse:function(e,t){var n={};return e.forEach(function(e){e.setAttribute("disabled",!0),e.name&&(n[e.name]=e.value?e.value.trim():null,-1!==t.indexOf(e.name)&&n[e.name]&&(n[e.name]=n[e.name].split(/,*\s(?:\s*,\s*)*\s*/)))}),n},error:function(e,t,n){var r=JSON.parse(e.response),i=[];Object.keys(r.errors).forEach(function(t){r.errors[t].forEach(function(e){i.push({message:t+" "+e})})});t.reset(i),o.enableForm(n)},enableForm:function(e,t){e.forEach(function(e){e.removeAttribute("disabled"),t&&(e.value="")})}};return o}),define("app-data.srv",["toolbox"],function(i){var n=window.Promise||i.Promise,r="https://conduit.productionready.io/api/",o="jwtToken",a=function(){return localStorage.getItem(o)},s=function(){return!!m.appData.user},u={"Content-Type":"application/json; charset=utf-8"},l={dataType:"json"},c=function(e,t,n){var r=a();return n.type=e&&e.toUpperCase()||"GET",t&&(n.headers=Object.assign({},u),r&&(n.headers.Authorization="Token "+r)),n},f=function(e){return null===e.user.image&&(e.user.image=""),null===e.user.bio&&(e.user.bio=""),localStorage.setItem(o,e.user.token),m.appData.user=e.user,e.user},e=function(e,t,n,r){return i.ajax(e,c("GET",t,Object.assign({cache:n,resetCache:r},l)))},t=function(e,t,n){return i.ajax(e,c(t||"POST",!0,Object.assign(n?{data:JSON.stringify(n||{})}:{},l)))},d=function(t){return t.user||!a()?new n(function(e){return e(t.user&&JSON.parse(JSON.stringify(t.user)))}):e(r+"user",!0,500).then(f).catch(function(){return localStorage.removeItem(o)})},p=new n(function(e){return e()}),g=function(n,e){return Array.apply(null,{length:Math.ceil((e<n.limit+1?0:e)/n.limit)}).map(function(e,t){return{value:t+1+"",active:void 0!==n.offset&&n.offset==t,tag:n.tag,ownFeed:n.ownFeed,author:n.author,favorited:n.favorited}})},m={appData:void 0,user:function(e){return d(e)},default:function(t){return d(t).then(function(e){return{cr:t.cr,user:e,isRegister:t.isRegister}})},articles:function(t){return n.all([e(r+"articles"+(t.ownFeed?"/feed":"")+"?limit="+t.limit+"&offset="+t.offset*t.limit+(t.tag?"&tag="+t.tag:""),a()).catch(function(){return window.location.href="#/login"}),t.isSameApp?p:e(r+"tags",!1,3e4),d(t)]).then(function(e){return{cr:t.cr,articles:e[0],tags:e[1],user:e[2],loggedIn:s,tag:t.tag,ownFeed:t.ownFeed,pagination:g(t,e[0].articlesCount)}})},article:function(t){return n.all([e(r+"articles/"+t.article,a()),e(r+"articles/"+t.article+"/comments"),d(t)]).then(function(e){return{cr:t.cr,article:e[0],comments:e[1],user:e[2],loggedIn:s}})},editor:function(t){return n.all([t.article?e(r+"articles/"+t.article,a()):p]).then(function(e){return{cr:t.cr,article:e[0]}})},profile:function(t){return n.all([t.isSameAuthor?p:e(r+"profiles/"+t.author,a()),e(r+"articles?"+(t.favorited?"favorited":"author")+"="+encodeURIComponent(t.author)+"&limit="+t.limit+"&offset="+t.offset*t.limit,a()),d(t)]).then(function(e){return{cr:t.cr,profile:e[0],articles:e[1],user:e[2],loggedIn:s,tag:t.tag,favorited:t.favorited,pagination:g(t,e[1].articlesCount)}})},userLogin:function(e){return t(r+"users/login",null,e).then(f)},userLogout:function(e){return new n(function(e){localStorage.removeItem(o),m.appData.user=void 0,e()})},userSignup:function(e){return t(r+"users",null,e).then(f)},putSettings:function(e){return t(r+"user","PUT",e.user)},postArticle:function(e){return e.slug?t(r+"articles/"+e.slug,"PUT",e):t(r+"articles","POST",e)},deleteArticle:function(e){return t(r+"articles/"+e.slug,"DELETE")},postComment:function(e){return t(r+"articles/"+e.slug+"/comments","POST",e.comment)},deleteComment:function(e){return t(r+"articles/"+e.slug+"/comments/"+e.id,"DELETE")},postLike:function(e){return t(r+"articles/"+e.slug+"/favorite",e.favorited?"DELETE":"POST")},postFollow:function(e){return t(r+"profiles/"+e.author.username+"/follow",e.author.following?"DELETE":"POST")}};return m}),define("article-preview",["app-data.srv"],function(i){return function(e,t,n,r){e.component({name:n||"article-preview",listeners:["favoritesCount","favorited"],model:t,eventListeners:{like:function(e,t,n){return r()?i.postLike(n).then(function(e){n.favoritesCount+=n.favorited?-1:1,n.favorited=!n.favorited}):window.location.href="#/login"},getTag:function(e,t,n){e.preventDefault(),window.location.href="#/articles/0/"+t.textContent}}})}}),define("app-article",["app-data.srv"],function(o){return function(e){return e.then(function(r){var i=r.cr.component("comments",{model:r.comments.comments.map(function(e){return e.slug=r.article.article.slug,e}),extraModel:r.user,eventListeners:{delete:function(e,t,n){var r=this;o.deleteComment({id:n.id,slug:n.slug}).then(function(e){return r.removeChild(n)})}}});r.cr.component("form",{model:[{user:r.user||{},slug:r.article.article.slug}],extraModel:{author:r.article.article.author},eventListeners:{submit:function(e,t,n){var r=n.views.textarea.value.trim();e.preventDefault(),r&&o.postComment({comment:{comment:{body:r}},slug:n.slug}).then(function(e){e.comment.slug=n.slug,i.prependChild(e.comment),n.views.textarea.value=""})}}}),r.cr.component("article",{listeners:["favoritesCount","favorited","author.following"],model:[r.article.article],extraModel:{loggedIn:!!r.user,isMine:r.user&&r.user.username===r.article.article.author.username},eventListeners:{like:function(e,t,n){return r.loggedIn()?o.postLike(n).then(function(e){n.favoritesCount+=n.favorited?-1:1,n.favorited=!n.favorited}):window.location.href="#/login"},follow:function(e,t,n){return r.loggedIn()?o.postFollow(n).then(function(e){n.author.following=!n.author.following}):window.location.href="#/login"},delete:function(e,t,n){return o.deleteArticle(n).then(function(e){window.location.href="#/profile/"+r.user.username})}}})})}}),define("app-articles",["article-preview"],function(t){return function(e){return e.then(function(a){t(a.cr,a.articles.articles,null,a.loggedIn),a.cr.component("pagination",{model:a.pagination}),a.tags&&a.cr.component("tag-list",{model:a.tags.tags.map(function(e){return{tag:e}})}),a.cr.component("feed-toggle",{model:[{user:a.user,tag:a.tag,ownFeed:a.ownFeed}],listeners:["ownFeed"],subscribe:function(e,t,n,r){var i=a.cr.Toolbox.toggleClass,o=t.views;i(o.own,"hidden",!t.user),i(o["own-link"],"active",!t.tag&&t.ownFeed),i(o.global,"active",!t.tag&&!t.ownFeed),i(o.tags,"hidden",!t.tag),o["tags-link"].textContent=t.tag?"# "+t.tag:""},eventListeners:{prerender:function(e,t,n){n.tag="",n.ownFeed=t===n.views["own-link"]}},onInit:function(e){return e.model[0].ownFeed=e.model[0].ownFeed,e.uncloak()}})})}}),define("app-editor",["app-data.srv","form-helper"],function(a,s){return function(e){return e.then(function(e){e.cr.component("editor",{model:[e.article?Object.assign(e.article.article,{textLength:3<e.article.article.body.length,isPreviewing:!1}):{textLength:0,isPreviewing:!1}],listeners:["textLength","isPreviewing"],eventListeners:{submit:function(e,t,n){var r=[].slice.call(n.elements.element.elements),i=s.parse(r,["tagList"]);e.preventDefault(),a.postArticle({article:i,slug:n.slug}).then(function(e){s.enableForm(r),window.location.href="#/article/"+e.article.slug}).catch(function(e){s.error(e,o,r)})},input:function(e,t,n){return n.textLength=3<t.value.length},preview:function(e,t,n){n.body=n.views.editor.value,n.views.preview.style.height=n.views.editor.offsetHeight+"px",n.isPreviewing=!n.isPreviewing}}});var o=e.cr.component("error-messages",{model:[]})})}}),define("app-login",["app-data.srv","form-helper"],function(s,u){return function(e){return e.then(function(e){var t=e.cr.component("login",{model:[{register:e.isRegister}],eventListeners:{submit:function(e,t,n){var r=[].slice.call(n.views.form),i=n.register?"userSignup":"userLogin",o=u.parse(r,[]);e.preventDefault(),s[i]({user:o}).then(function(e){u.enableForm(r,!0),window.location.href="#/articles/0/my-feed"}).catch(function(e){u.error(e,a,r)})}}}),a=e.cr.component("error-login",{model:[]}),n=t.model[0].views,r=e.cr.Toolbox.toggleClass;r(n.username,"hidden",!e.isRegister),e.isRegister?n.username.removeAttribute("disabled"):n.username.setAttribute("disabled",!0),r(n.register,"hidden",!e.isRegister),r(n.login,"hidden",e.isRegister)})}}),define("app-profile",["article-preview","app-data.srv"],function(t,r){return function(e){return e.then(function(s){t(s.cr,s.articles.articles,"articles",s.loggedIn),s.profile&&s.cr.component("profile",{model:[{author:s.profile.profile}],extraModel:{user:s.user&&s.user.username},listeners:["author.following"],eventListeners:{follow:function(e,t,n){return s.loggedIn()?r.postFollow({author:n.author}).then(function(e){n.author.following=e.profile.following}):window.location.href="#/login"}}}),s.cr.component("profile-pagination",{model:s.pagination}),s.cr.component("article-toggle",{model:[{user:s.user,ownFeed:!s.favorited,profileUser:s.cr.components.profile.model[0].author.username}],listeners:["ownFeed"],subscribe:function(e,t,n,r){var i=s.cr.Toolbox.toggleClass,o=/#\/profile\/[^/]+/,a="#/profile/"+t.profileUser;i(t.views["own-link"],"active",t.ownFeed),i(t.views["favorite-link"],"active",!t.ownFeed),t.views["own-link"].href=t.views["own-link"].href.replace(o,function(){return a}),t.views["favorite-link"].href=t.views["favorite-link"].href.replace(o,function(){return a})},eventListeners:{prerender:function(e,t,n){n.ownFeed=t===n.views["own-link"]}},onInit:function(e){return e.model[0].ownFeed=e.model[0].ownFeed,e.uncloak()}})})}}),define("app-settings",["app-data.srv","form-helper"],function(a,s){return function(e){return e.then(function(e){e.cr.component("settings",{model:[e.user],eventListeners:{logout:function(){return a.userLogout().then(function(){return window.location.href="#/"})},submit:function(e,t,n){var r=[].slice.call(n.views.form),i=s.parse(r,[]);e.preventDefault(),a.putSettings({user:i}).then(function(e){s.enableForm(r)}).catch(function(e){s.error(e,o,r)})}}});var o=e.cr.component("error-settings",{model:[]})})}}),require(["circular","app-data.srv","!ui-components","template-helpers","marked"],function(e,i,n,t,r){var a=e.Toolbox,o=a.removeClass,s=a.addClass,u=a.toggleClass,l=new e({helpers:t({markdown:r})}),c=l.component("app",{model:[{currentApp:"",path:void 0,offset:0,tag:"",slug:"",ownFeed:!1,favorited:!1,author:"",isSameAuthor:!1,isRegister:!1,wasRegister:!1}],listeners:["currentApp"],subscribe:function(e,t,n,r){(function(e,t,n){var r=e.elements.element;t!==n&&s(r,"pending-app");s(r,"pending-sub-app")})(t,n,r),f(t,n,r),l.renderModule({data:i[i[n]?n:"default"]({cr:l,limit:"articles"===n?10:5,isSameApp:n===r,author:t.author,offset:t.offset,article:t.slug,tag:t.tag,ownFeed:t.ownFeed,favorited:t.favorited,isSameAuthor:t.isSameAuthor,isRegister:t.isRegister,user:t.user}),name:n,previousName:r,path:"modules/"+n+"/index.html",container:t.views["app-modules"],require:"app-"+n,returnData:!0,dontWrap:!0,transition:function(e){e.promise.then(function(){e.remove(),e.append(),o(c.element,"pending-app"),o(c.element,"pending-sub-app")})}}).then(function(e){var t="articles"===n?"Home":"article"===n?e.article.article.title:n.charAt(0).toUpperCase()+n.substr(1);document.title=document.title.replace(/.*?- /,t+" - ")})},onInit:function(e){var t=e.model[0];i.appData=t,i.user({}).then(function(e){t.user=e,f(t,t.currentApp,null),o(t.views.navbar,"hidden")}),r.setOptions({sanitize:!0}),l.template(n,{share:!0}),l.addRoute({path:"(/:appName)(/:var0)(/:var1)(/:var2)(/*)",callback:function(e){return function(e,t){var n=e.parameters,r=n.appName||"articles",i=n.var0,o=n.var1,a=e.path.join("/");if(t.path===a)return;t.path=a,t.ownFeed=void 0,t.isSameAuthor=void 0,"editor"===r||"article"===r?t.slug=i:"articles"===r?(t.ownFeed="my-feed"===o,t.tag=t.ownFeed?"":o,t.offset=i||0):"profile"===r&&(t.isSameAuthor=i===t.author,t.author=i,t.offset=o||0,t.favorited="favorites"===n.var2);t.isRegister="register"===i,t.currentApp=r,t.wasRegister=t.isRegister}(e,t)}},!0)}});function f(e,t,n){var r=e.views,i=e.elements.element,o=e.user&&e.user.username;t="login"===t&&e.isRegister?"register":t,n=e.wasRegister?"register":n,u(i,"logged-in",!!o),a.toggleClasses(i,i,n,t),r["home-link"].href=o?"#/articles/0/my-feed":"#",u(r["user-link"],"active","profile"===e.currentApp&&e.author===o),o&&t!==n&&(r["user-name"].textContent=o,r["user-link"].href="#/profile/"+o,r["user-image"].src=e.user.image)}});
