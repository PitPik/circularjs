!function(e){"use strict";var t=e.Math.random,n=document.createElement("a"),r=e.document.createDocumentFragment(),o=f.modules={},i={};function a(){return"_module_"+(t()+t())}function l(e){var t,r=/(?:^\!|^http[s]*:|.*\.js$)/.test(e)?"":".js";return e=(f.development[e]||f.options.devMocks&&f.mocks[e]||""||f.paths[e]||e).replace(/^[!%]/,""),t=function(e){return n.href=e,(-1!==e.indexOf(n.host)?n.origin:"")+n.pathname+n.search}((f.baseUrl||".")+"/"+e+r).replace(/^.\//,""),f.mapPath?f.mapPath(e,r,t):t}function s(e){var t={mapPath:"function",baseUrl:"string"},n=["lookaheadMap","paths","options","mapPath","baseUrl","lazyPackages","development","mocks"];if(!f[n[0]])for(var r=n.length;r--;)f[n[r]]="string"===t[n[r]]?"":"function"===t[n[r]]?null:{};for(var o in e)if(-1!==n.indexOf(o))if(t[o])f[o]=e[o];else for(var i in e[o])f[o][i]=e[o][i];return f}function c(e){var t=f.lookaheadMap[e],n=f.options.minifyPrefix;if(t&&-1===(f.development[e]||f.options.devMocks&&f.mocks[e]||""||f.paths[e]||"").indexOf(n)){f(t);for(var r=0,i=t.length;r<i;r++)o[t[r]]||c(t[r])}}function u(e){for(var t=e.deps,n=!0,r=t.length;r--;)o[t[r]]&&void 0===o[t[r]].done&&(n=!1);n&&p(e)}function p(e){var t=e.parents||[];e.factory&&!e.isFile?(e.done=e.factory.apply(null,e.deps.map(function(e){return o[e].done})),delete e.factory):void 0===e.done&&delete o[e.name];for(var n=t.length;n--;)o[t[n]]&&u(o[t[n]])}function d(t,n){var r,a=e.document.createElement("script");return a.type="text/javascript",a.async=a.defer=!n,a.charset="utf-8",a.onload=a.onreadystatechange=(r=t,function(e){var t=e.currentTarget||e.srcElement;"load"!==e.type&&"complete"!==t.readyState||(a.onload=a.onreadystatechange=null,function(e){var e=o[e.name];if(0===i.name.indexOf("_module_")){e.done=i.done,e.factory=i.factory,e.deps=i.deps;for(var t=e.deps.length,n={};t--;)(n=o[e.deps[t]].parents)[n.indexOf(i.name)]=e.name;delete o[i.name]}u(e)}(r))}),a.src=t.path,a}function f(e,t,n,r){e.constructor===Array?h(a(),e,t,n,r):h(a(),[],e,t,n)}function h(e,t,n,s,h){var v={};if("string"!=typeof e)return f(e,t,n,s);(!e&&n&&n.name||s)&&(e=s||n.name),e=e||a(),v=o[e],function(e,t,n){for(var i=t.length,a={},s="";i--;)s=t[i],o[s]?o[s].parents.push(e):(a=o[s]={name:s,isInline:"%"===s.charAt(0),isFile:"!"===s.charAt(0),path:l(s),parents:[e]}).isFile?f.getFile(a,p):a.isInline||(r.appendChild(d(a,n)),c(s));r.children.length&&document.head.appendChild(r)}(e,t,h),v?(v.deps=t,v.factory=n,v.isInline&&p(v)):u(v=o[e]={name:e,deps:t,factory:n,parents:[]}),i=v}e.define&&e.define.amd||(h.amd={},f.config=s,f.getFile=function(e,t){return e},f.debug=function(){return{modules:o,executed:i}},e.define=h,e.require=f,s({}))}(this),define([],function(){"use strict";var e=document.createElement("a"),t={undefined:void 0,null:null,NaN:NaN,true:!0,false:!1},n={convertToType:function(e){return t.hasOwnProperty(e)?t[e]:e.toString&&+e.toString()===e?+e:e},closest:function(e,t,r){if(e.closest)n.closest=function(e,t){return e.closest(t)};else{var o=e.msMatchesSelector||e.webkitMatchesSelector||e.matches;n.closest=function(e,t){if(!(r||document.documentElement).contains(e))return null;do{if(o.call(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}}return n.closest(e,t,r)},findParent:function(e,t,n){do{if(e[t||"cr-id"])return e;e=e.parentElement||e.parentNode}while(null!==e&&e!==n&&1===e.nodeType);return null},$create:function(e,t){var n=document.createElement(e);return t&&(n.className=t),n},$:function(e,t){return"string"==typeof e?(t||document).querySelector(e):e},$$:function(e,t){return(t||document).querySelectorAll(e)},keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},cloneObject:function(e,t){var n=function(e,t,n){t[n]=e[n]};for(var r in t)n(t,e,r);return e},isArray:Array.isArray||function(e){return e&&e.constructor===Array},addEvent:function(e,t,n,r){return r=void 0!==r?r:!!/(?:focus|blur|mouseenter|mouseleave|scroll)/.test(t),e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r),e=n=t=r=null}},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},storageHelper:{fetch:function(e,t){var n=localStorage.getItem(e),r=n?JSON.parse(n):n;return t&&n?r[t]:r},saveLazy:function(e,t,r){n.lazy(function(){n.storageHelper.save(e,t)},r||n.storageHelper)},save:function(e,t,r){var o;if(null===e)return localStorage.removeItem(t);r?((o=n.storageHelper.fetch(t)||{})[r]=e,localStorage.setItem(t,JSON.stringify(o))):localStorage.setItem(t,JSON.stringify(e))}},lazy:function(e,t,n){clearTimeout(t._timer),t._timer=setTimeout(e,0,n)},normalizePath:function(t){return e.href=t,(-1!==t.indexOf(e.host)?e.origin:"")+e.pathname+e.search},ajax:function(e,t){var o,i,a=null,l=(new Date).getTime();return t=t||{},e=n.normalizePath(e),i=r[e]&&r[e].time||0,a=(a=(o=!0===t.cache?l+1e8:t.cache?i>l?i:l+t.cache:0)&&!t.resetCache&&i>l?r[e]:null)||new n.Promise(function(n,r){var o,i,a=new XMLHttpRequest,l=(t.method||t.type||"GET").toUpperCase();if(a||r("Giving up :( Cannot create an XMLHTTP instance"),t||(e=(t=e).url),a.onreadystatechange=function(){var e=function(e,t,n){try{if(e.readyState===XMLHttpRequest.DONE){if(!(e.status<200||e.status>299))return e["xml"===t?"responseXML":"raw"===t?"response":"responseText"];var r=new Error(e.statusText);r.response=e.response,n(r)}}catch(e){n("Caught Exception: "+e.stack)}}(this,t.dataType,r);if(void 0!==e){if("json"===t.dataType)try{e=JSON.parse(e)}catch(e){return void r("Caught Exception: "+e.stack)}n(e)}},a.open(l,e,t.async||!0,t.username,t.password),"raw"===t.dataType&&(a.responseType="blob"),"xml"===t.dataType&&a.setRequestHeader("Content-Type","text/xml"),"json"===t.dataType&&a.setRequestHeader("Content-Type","application/json"),"GET"!==l&&t.csrf&&a.setRequestHeader("X-XSRF-TOKEN",(o=t.csrf,(i=document.cookie.split(o+"=")[1])&&i.split(";")[0])),t.headers)for(var s in t.headers)a.setRequestHeader(s,t.headers[s]);return a.send(t.data),function(){a.abort()}}),o?(r[e]=a,r[e].time=o):delete r[e],a},errorHandler:function(e){console.error(e)},Promise:o},r={};function o(e,t){this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],this._returnFn=c(e,this),this._staticData=t}function i(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,setTimeout(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(e){return void l(t.promise,e)}a(t.promise,n)}else(1===e._state?a:l)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return c(n.bind(t),e)}e._cancelFn=null,e._state=1,e._value=t,s(e)}catch(t){l(e,t)}}function l(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&setTimeout(function(){e._handled||console.warn("Possible Unhandled Promise Rejection:",e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1,r=function(e){n||(n=!0,l(t,e))};try{return e(function(e){n||(n=!0,a(t,e))},r)}catch(e){r(e)}}return o._cache={},o.prototype.catch=function(e){return this.then(null,e||function(e){console.error(e)})},o.prototype.then=function(e,t){var n=this._returnFn,r=new o(function(){return n});return i(this,{onFulfilled:e||null,onRejected:t||null,promise:r}),r},o.prototype.cancel=function(e,t){var n=o._cache[e];return o._cache[e]=this,n?(1!==n._state?(n._returnFn&&"function"==typeof n._returnFn&&n._returnFn(),n._deferreds=[],n.then=n.catch=function(){},n._handled=!0,n._state=1,n._cancelFn&&n._cancelFn()):this._cancelFn=t,n._returnFn=null,n._cancelFn=null,this):this},o.all=function(e){var t=[];return e.reduce(function(e,n){return e.then(function(){return n}).then(function(e){return t.push(e)})},new o(function(e,t){e(null)})).then(function(){return t})},window.require&&(require.getFile=function(e,t){var r=e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase(),o=/^(?:json|xml)$/.test(r)?r:"";n.ajax(e.path,{cache:"!!"!==e.name.substr(0,2),dataType:o}).then(function(n){e.done=n,t(e)})}),n},"toolbox"),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],function(){return t()},"schnauzer"):"object"==typeof exports?exports.Schnauzer=t():e.Schnauzer=t()}(this&&this.window||global,function(){"use strict";var e=Object.keys||function(e){var t=[],n="";for(n in e)hasOwnProperty.call(e,n)&&t.push(n);return t},t=function(e,t,n){t[n]=e[n]},n=function(e,n){for(var r in n)t(n,e,r);return e},r=function(e,t){return t.push.apply(t,e),t},o={start:/^\s*/,all:/^\s*|\s*$/g,end:/\s*$/},i=function(e,t){this.version="2.0.8",this.partials={},this.helpers={},this.regexps={},this.controls={active:!1,stop:!1,loop:[]},this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},helpers:{},partials:{},self:"self",escapeHTML:!0,limitPartialScope:!0,loopHelper:null,renderHook:null},a(this,t||{},e)},a=function(e,t,r){"string"!=typeof r&&(t=r,r=""),s(e,(t=n(e.options,t)).tags),e.helpers=t.helpers,e.registerPartial(t.partials),void 0!==r&&e.parse(r),delete t.helpers,delete t.partials},l=i.SafeString=function(e){this.string=e};return l.prototype.toString=l.prototype.toHTML=function(){return""+this.string},i.getObjectKeys=e,i.cloneObject=n,i.concatArrays=r,i.isEmpty=function(t){return!t||(t.constructor===Array?!t.length:"object"==typeof t?!e(t).length:!t)},i.prototype={render:function(e,t){var n=u(this,"","",0,e,null,[{scope:e}]);return[this.partials[this.options.self]({blocks:{},extra:t,scopes:[{scope:e,helpers:n,level:[],values:null,alias:{}}]}),this.controls.active=!0][0]},parse:function(e){return this.registerPartial(this.options.self,e)},registerHelper:function(e,t){if("string"==typeof e)return this.helpers[e]=t;for(var n in e)this.helpers[n]=e[n]},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if("string"==typeof e)return this.partials[e]=this.partials[e]||(t.constructor===Function?t:function(e,t,n){var r=t.split(e.regexps.tags);n.push({text:r[0]});for(var o=1,i="",a="",l="",s=0,c="",u=[],p=[],d=/^[!-]+/,f=/^else\s*/,h={"#":"B","^":"B","/":"C",E:"E"},v={},g="",m="",y={},b=r.length;o<b;o+=5)i=r[1+o].replace("~",""),a=r[2+o],l=N(r[4+o],r[3+o],r[6+o]||""),"\\"===r[o].charAt(0)||d.test(i)||(s=a.indexOf(" "),c="/"!==i&&a.substring(0,s)||a,m=h[(g="^"===i&&(-1!==s||""===a)||"else"===c?"E":i).charAt(0)]||"I","#>"===i&&(u.unshift("@"+c),p.unshift("@"+a)),"E"===g&&(a=a.replace(f,"")),y="/"===i?{tag:"C",text:l,vars:a}:S(e,a,i,r[o],m,l),"^"===i&&"B"===m&&(y.alt=y.vars[0].orig),"#*"===i&&(y.isPartial=!0),n=T(e,n,y,r[o]),"C"===m&&(n[n.length-1].isPartial||u[0])&&(y=n.splice(-1,1,u[0]?S(e,p[0],">",r[o],"I",y.text):{text:y.text})[0],(v=y.children[0]).children.unshift({text:v.text}),e.registerPartial(u[0]||y.vars[0].value,v.bodyFn),u.shift(),p.shift()));if(n.parent)throw"Schnauzer Error: Missing closing tag(s)";return r=t=null,O(e,{children:n})}(this,t,[]));for(var n in e)this.registerPartial(n,e[n])},unregisterPartial:function(e){delete this.partials[e]},setTags:function(e){s(this,e)},escapeExpression:function(e){return c(this,e,!0)}},i;function s(t,n){var r=function(e){for(var t=e.length;t--;)e[t]="("+e[t]+")";return e}("{{"===n[0]?["{{2,3}","[~}]{2,4}"]:n);t.regexps={tags:new RegExp(r[0]+"([#~^/!>*-]*)\\s*([^~}]*)"+r[1]),entity:new RegExp("["+e(t.options.entityMap).join("")+"]","g")}}function c(e,t,n){return null==t?"":t.constructor===i.SafeString?t.string:n&&e.options.escapeHTML?String(t).replace(e.regexps.entity,function(t){return e.options.entityMap[t]}):t}function u(e,t,n,r,o,i,a){return r?{"@index":t,"@number":t+1,"@key":n,"@odd":t%2!=0,"@last":t===r-1,"@first":0===t,"@length":r,"@depth":e.options.limitPartialScope?void 0:a.length-2,"@loop":i,"@parent":a[1].scope,"@root":a[a.length-1].scope,this:o,".":o}:{"@parent":i,"@root":a[a.length-1].scope,this:o,".":o}}function p(e,t,o){var i=e.scopes,a=e.alias?[e.alias]:[],l=r(i[0].level,a),s=e.values,c=i[1]?n({},i[1].alias):{};return e.alias=null,e.values=null,o=o?n(c,o):c,e.scopes=r(i,[{scope:t,helpers:i[0].helpers,level:l,values:s,alias:o}]),function(){e.scopes=i}}function d(e,t){var n=e.scope;return e.scope=t||{},function(){e.scope=n}}function f(e,t,n){if("."===t.value||"this"===t.value)return{value:e,variable:t};if("key"!==t.type)return{value:t.value,variable:t};for(var r="@root"===t.path[0]?1:0,o=t.path.length;r<o;r++)if(!(e=e[t.path[r]]))return{variable:t};return{value:e[t.value],parent:e,variable:t,alias:n||!1}}function h(e,t,n,r){for(var o=0,i=e.length;o<i;o++)if(void 0!==(r=f(e[o],t,!0)).value)return(n=n.alias[r.variable.value])&&(r.parent=n.parent,r.key=n.key),r;return{variable:t}}function v(e,t,n,r,o){void 0!==o.value&&void 0!==r&&(n[e]||(n[e]={}),n[e][r]=o.value,t&&(t.alias[r]={parent:o.parent,key:o.variable.value}))}function g(e,t,n,r){var o=n.vars,i=!!e.options.renderHook;if(!o)return r;for(var a,l=0,s=o.length,c={},u={},p={},d=[];l<s;l++)(u=(c=o[l]).path&&"@root"===c.path[0]?t.scopes[t.scopes.length-1]:t.scopes[c.depth||0])?(void 0===(p={value:u.helpers[c.value],variable:c,parent:a="@"===(c.value+"").charAt(0)?u.helpers:u.scope}).value&&u.values&&(p=h([u.values],c,u,p)),void 0!==p.value||c.isStrict||(p=h(u.level,c,u,p)),void 0===p.value&&(p=c.helper?{value:y(e,d=g(e,t,c,[]),t,c)}:f(u.scope,c)),void 0===p.value&&t.extra&&(p=f(t.extra,c)),void 0===p.value&&a&&(p.parent=u.helpers),c.alias&&v("alias",i&&u,t,c.alias[0],p),c.name&&v("values",i&&u,t,c.name,p),p.type=p.value&&p.value.constructor===Array?"array":typeof p.value,p.variable||(p.variable=c),i&&c.helper&&(p.renderArgs=d),i&&e.controls.loop[0]&&(p.loop=e.controls.loop[0]),r.push(p)):r.push(p);return i&&n.helper&&!n.tag&&(n.renderFn=function(r){return y(e,r,t,n)}),r}function m(t,n,r){var o=t.value,i="object"===t.type;return"each"!==n&&"with"!==n&&("array"!==t.type||"if"!==n&&"unless"!==n)||void 0===o?o:(i&&(r.keys=e(o)),i?r.keys.length&&o:o.length&&o)}function y(t,o,a,l,s){var c,u=!l.helper&&l.children&&(o[0]?b:void 0)||l.helperFn,p=[],h=a.scopes[0].values;return u?u(t,o,a,l,s):((u=function(e,t,n){var r=t.scopes[n.helper.depth||0].scope,o=e.helpers[n.helper.orig];return n.helperFn||(n.helper.isStrict||!o?f(r,n.helper).value:o)}(t,a,l))||1!==o.length||"function"!==o[0].type||(u=o.shift().value),a.values&&(a.scopes[0].values=a.values),o.length&&p.push(function(t,o,a,l,s,c){var u=null,p=a.helper?a.helper.orig:"",f=o.scopes[0].helpers,h=a.children,v={name:p,hash:{},data:{root:f["@root"],scope:f.this,parent:f["@parent"]},escapeExpression:function(e){return t.escapeExpression(e)},SafeString:i.SafeString,keys:e,extend:n,concat:r,getDataDetails:function(){return l},isEmpty:i.isEmpty};f["@length"]&&n(v.data,{loop:f["@loop"],depth:f["@depth"],index:f["@index"],number:f["@number"],length:f["@length"],first:f["@first"],last:f["@last"],key:f["@key"],odd:f["@odd"]});for(var g=l.length;g--;)l[g].variable.name?v.hash[l[g].variable.name]=l[g].value:s.unshift(l[g].value);return h&&(v.fn=function(e){return c.fnIdx=0,c.checkFn&&c.checkFn(0),u=d(o.scopes[0],e),[h[0].text+h[0].bodyFn(o),u()][0]},v.inverse=h[1]&&function(e){return c.fnIdx=1,c.checkFn&&c.checkFn(1),u=d(o.scopes[0],e),[h[1].text+h[1].bodyFn(o),u()][0]}||function(){return""}),v}(t,a,l,o,p,s)),c=u?u.apply(a.scopes[0].scope,p):"",a.scopes[0].values=h,void 0===c?"":c)}function b(e,t,n,r,o){for(var i=0,a={keys:[]},l=r.children,s=l[i],c=r.helper,d="if"===c||"each"===c||"with"===c,f=!c&&1===t.length,h=t[0]||{},v=m(h,c,a),y=(d||f)&&v||"unless"===c&&!v,b=null;l[i+1]&&!y;)d="if"===(c=(s=l[++i]).helper)||"each"===c||"with"===c,t=s.vars.length?g(e,n,s,[]):[],f=!c&&1===t.length,v=m(h=t[0]||{},c,a),y=(d||f)&&v||"unless"===c&&!v||!c&&!t.length&&s.bodyFn;if(o.fnIdx=y?i:i+1,o.checkFn&&o.checkFn(i),f&&"array"===h.type&&(c="each"),e.controls.stop&&"string"!=typeof e.controls.stop&&"each"===c)return"";if(f&&!c&&(c="with"),"with"===c||"each"===c){if(b=p(n,v,"with"===c&&n.scopes[0].alias),"each"===c)return function(e,t,n,r,o,i,a,l){var s=o.bodyFn,c=r.scopes[0],p=n.variable.alias,d=c.level[0],f="array"===n.type,h=f||"object"===n.type?f?t:i:[],v=r.scopes,g=a&&function(i,l){return r.scopes=v,r.scopes[0].scope=i,r.scopes[0].helpers=u(e,l,l,n.value.length,i,t,r.scopes),e.controls.loop.unshift(c.helpers),[a(e,o.text+s(r),n,+l,g,!0),e.controls.loop.shift()][0]};p&&a&&(c.alias[p[0]]={parent:t});if(e.controls.stop)return["",a(e,g,n),l()][0];a&&e.controls.loop.unshift(null);for(var m=0,y=h.length,b="",x="";m<y;m++)b=f?m:h[m],c.helpers=u(e,m,b,y,t[b],t,r.scopes),c.scope=t[b],p&&(p[1]&&(d[p[1]]=b),d[p[0]]=t[b],a&&(c.alias[p[0]].key=b)),a&&(e.controls.loop[0]=c.helpers),x+=g?a(e,(a(e,b,n),o.text+s(r)),n,m,g):o.text+s(r);return[x,l(),a&&e.controls.loop.shift()][0]}(e,v,h,n,s,a.keys,e.options.loopHelper,b);n.scopes[0].helpers=u(e,"","",0,f?v:n.scopes[0].scope,n.scopes[1].scope,n.scopes)}return[y?s.text+s.bodyFn(n):"",b&&b()][0]}function x(e,t,n,r,o,i,a){return t.values=null,e.options.renderHook&&"B"===r.tag&&(t={extra:t.extra,scopes:t.scopes,alias:t.alias,blocks:t.blocks}),e.options.renderHook&&n.length&&!e.controls.active?e.options.renderHook(e,o,n,function(n,o,l){return o&&(t.scopes[0].helpers=o),n[0].parent&&(t.scopes[0].scope=n[0].parent),l&&(e.controls.stop=l),[i(e,r,n,t,a||{fnIdx:0}),e.controls.stop=!1,e.controls.active=!0][0]},r,"B"===r.tag?a||{fnIdx:0}:void 0,r.children&&r.children[1]&&"E"===r.children[1].tag?function(n){return g(e,t,n,[])}:null):o}function _(e,t,n,r){var o=n[0]&&n[0].type,i=t.partial?function(e,t,n,r){var o=r.partial.vars&&g(e,n,r.partial,[]),i=r.partial.helper&&y(e,o,n,r.partial),a=r.partial.orig||o&&(i||o[0].value)||"",l="@partial-block"===a,s=!l&&"@"===a.charAt(0),c=e.partials[s?a.substring(1):a]||n.extra&&n.extra[a],u=p(n,t[0]&&!t[0].variable.name?t[0].value:n.scopes[0].scope,n.scopes[0].alias);return n.scopes[0].level=[],!c&&s&&(c=e.partials[a]),s?n.blocks[a]=e.partials[a]:l&&(c=n.blocks[a]),e.options.limitPartialScope?n.scopes=[n.scopes[0]]:n.scopes.splice(1,1),[c?c(n):"",u()][0]}(e,n,r,t):c(e,t.helper||"function"===o?y(e,n,r,t):n[0]&&n[0].value,"boolean"!==o&&"number"!==o&&t.isEscaped);return x(e,r,n,t,i,_,null)}function k(e,t,n,r,o){var i=o||{fnIdx:0},a=y(e,n,r,t,i);return o?a:x(e,r,n,t,a,k,i)}function N(e,t,n){var r=-1!==t.indexOf("~"),i=-1!==n.indexOf("~"),a=r||i?r?i?o.all:o.start:o.end:"";return a?e.replace(a,""):e}function C(e,t){return t?e:"true"===e||"false"!==e&&(isNaN(e)||""===e?e:+e)}function A(e,t,n){var r=!1,o=e.replace(/@parent[/.]/,"../").replace(/\[.*?]/g,function(e){return e.substring(1,e.length-1).replace(/\./g,function(){return r=!0,"^"})}),i=n?[]:o.split("../"),a=i[1]?i[0]:"",l=i.length-1,s=n?o:i[l];if(n||"."===s||"this"===s||+s==s)return{value:s,path:[],depth:l,type:"key"};if(i=function(e,t){return e.replace(/^(?:this[/.]|\.\/|\|)/,function(e){return e&&(t.isStrict=!0),""})}(s,t).split(/[./]/),r){for(var c=i.length;c--;)i[c]=i[c].replace(/\^/g,".");o=o.replace(/\^/g,".")}return{value:a+i.pop(),path:i,depth:l,orig:o}}function E(e,t,n){for(var r=e.length,o=[];r--;)o.unshift(e[r].value);if(n)for(;o.length;)t[t.length-o.length].name=o.shift();else t[t.length-1].alias=o}function P(e,t,r,o){for(var i="string"===o?[e]:e.split(/[,;]*\s+[,;]*/),a="alias"===o||"string"===o,l=0,s=i.length,c=/--(\d+)--/,u=/%+/,p="",d=[],f="",h={},v={},g=!1;l<s;l++)if(i[l]&&""!==(f=void 0!==(d=i[l].split("="))[1]?d[1]:d[0])&&"as"!==f){if("object"===(p=typeof(h=t[(f.match(c)||[])[1]]||{value:f,type:"key"}).value)&&h.value[0]&&h.value[0].single)return h.value;void 0!==d[1]&&(h.name=d[0]),"string"===h.type?h.value=h.value[0]&&h.value[0].value||"":h.value&&"string"===p&&(h.value=h.value.replace(u,function(e){return h.active=e.length,""}),v=A(h.value,h,a),g=a||v.orig&&v.orig!==v.value,h.value=C(v.value,g),"string"!==(p=typeof h.value)?h.type=p:v.path&&!a&&n(h,v)),"alias"===h.type?E(h.value,r,l>3):r.push(h)}return r}function S(e,t,n,r,o,i){var a=t?function(e,t){var n=/\([^()]*\)/g,r=function(e){var n={vars:P(e.substring(1,e.length-1),t,[],"fn")};return n.vars.length>1&&(n.helper=n.vars.shift()),"--"+(t.push(n)-1)+"--"};for(e=e.replace(/(['"|])(?:[^\\'"]|\\+['"]|['"])*?\1/g,function(n,r){var o={type:"|"!==r?"string":"alias",value:""};return-1!==e.indexOf("["+r)||-1!==e.indexOf(r+"=")?n:(o.value=n===e?[{value:n.substring(1,n.length-1),path:[],depth:0,single:!0,type:"key"}]:P(n.substring(1,n.length-1),t,[],o.type),"--"+(t.push(o)-1)+"--")});e!==(e=e.replace(n,r)););return P(e,t,[],"")}(t,[]):[],l="^"===n?"unless":/^(?:if|each|with|unless)$/.test((a[0]||{}).value)?a.shift().value:"";return{partial:">"===n?a.shift():void 0,helper:l||(">"!==n&&a.length>1?a.shift():""),helperFn:l?b:void 0,isEscaped:r.lastIndexOf(e.options.tags[0])<1,bodyFn:null,vars:a,isInline:"B"!==o,tag:o,text:i,children:null}}function O(e,t){return t.bodyFn="B"===t.tag?void 0:function(n){return function(e,t,n){for(var r=0,o=t.length,i="";r<o;r++)i+=("B"===t[r].tag?k:_)(e,t[r],g(e,n,t[r],[]),n)+t[r].text;return i}(e,t.children,n)}}function T(e,t,n,r){var o='Schnauzer Error: Wrong closing tag: "/'+n.vars+'"',i=t.parent,a=[],l=function(n,o){n.children=a=[],a.parent=t,t=a,o&&(t.push(S(e,"","",r,"",n.text)),l(t[t.length-1]),t.isElse=!0)},s=function(){delete t.parent,delete t.isElse,i=(t=i).parent,O(e,t[t.length-1])};if("C"===n.tag){if(!t.parent)throw o;if(t.isElse&&s(),s(),t.lastBlock!==n.vars)throw o;delete t.lastBlock,t[t.length-1].text=n.text}else"B"===n.tag?(t.push(n),t.lastBlock=n.alt||n.helper.value||n.helper||n.vars[0].orig,l(n,!0)):"E"===n.tag?(t.isElse&&s(),t.push(n),l(n),t.isElse=!0):t.push(n);return t}}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(e,require("schnauzer")):"function"==typeof define&&define.amd?define(["schnauzer"],function(n){return t(e,n)},"blick"):"object"==typeof exports?exports.Blick=t(e,require("schnauzer")):e.Blick=t(e,e.Blick)}(this,function(e,t,n){"use strict";var r=function(e,t){for(var r in t)t[r]=document.createElement(t[r]);return function(r,o,i){var a="string"==typeof r?((r||"").match(e)||[])[1]:n,l=t[a]||t.default;return o&&(l="boolean"==typeof o?l.cloneNode():o),i?r?l.textContent=r:l.appendChild(document.createTextNode("")):l.insertAdjacentHTML("afterbegin",r||""),l}}(/<\s*(\w*)[\s\S]*?>/,{option:"select",legend:"fieldset",area:"map",param:"object",thead:"table",tr:"tbody",col:"colgroup",td:"tr",default:"div"}),o=document.createDocumentFragment();return function(e,t){var o=function(r,o){e.call(this,r,o),this.options=t(this.options,{registerLoopItem:function(e,t,n,r){},isDynamic:function(e,t,n,r,o){return!1},scanHTML:function(e,t,n,r,o,i){},loopHelperName:"loop-helper",loopFnName:"__loopFn",loopLimitsName:"__loopLimits",limiters:["{{#","{{END:","}}"],forceUpdate:!1,missingProperty:n,debugMode:"",debugLevel:2,attributes:{value:l,disabled:a,hidden:a,checked:a,autocomplete:a,contenteditable:a,readonly:a,required:a,selected:a}}),this.version={blick:"1.0.4",schnauzer:this.version},this.collector={destroyers:{},updaters:{},movers:{},helpers:{},element:{}},this.returnFragment=document.createDocumentFragment(),this.dataDump=[],this._firstTimeLoop=null,this._tempNode=null,i(this,o||{},r)},i=function(e,n,r){var o;"string"!=typeof r&&(n=r),t(n.attributes||{},e.options.attributes),t(e.options,n),delete e.options.helpers,delete e.options.partials,e.options.renderHook=f,e.options.loopHelper=N,o=e.options.limiters,e.xpath={xpath:['//text()[contains(., "'+o[0]+'") or contains(., "'+o[1]+'")]','//@*[contains(., "'+o[0]+'")]'].join(" | "),regex:new RegExp("("+o[0]+"|"+o[1]+")(\\d+)"+o[2],"g"),startTag:o[0],type:XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE}};return function(e,t){function n(){this.constructor=e}for(var r in t)t[r]&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n}(o,e),o.setScroll=T,t(o.prototype,{renderHTML:function(e,t){return function(e,t,n,o){var i=e.returnFragment.childNodes.length?document.createDocumentFragment():e.returnFragment;for(e.controls.active=!1,o=u(e,e.dataDump,r(e.render(t,n),!0)).childNodes;o.length;)i.appendChild(o[0]);return i}(this,e,t,[])},destroyInstance:function(e){!function(e,t){for(var n in t){for(var r in e.destroyers[n])k(e,n+":"+r);delete e.destroyers[n]}}(this.collector,e)},removeChild:function(e,t,n){return E(this,e,t,n)},moveChild:function(e,t,n,r,o,i){return function(e,t,n,r,o,i,a){var l=e.options,s=o[l.loopLimitsName],c=n!==o,u=s[r+(c||n===o&&r<t?0:1)],p=n[l.loopLimitsName][t+1];if(t===r&&n===o)return;u||s.push(u=e._tempNode);e._tempNode=null,u.nextSibling?u.parentNode.insertBefore(E(e,t,n,n[t],!0,c),u.nextSibling):u.parentNode.appendChild(E(e,t,n,n[t],!0,c));s.splice(r+1,0,p),!a&&e.controls.helpers&&A(e,t,n,c?o[r]:n[t],!1,r,o,i)}(this,e,t,n,r,o,i)},addChild:function(e,t,n){return function(e,t,n,o){var i=e.options,a=Node.COMMENT_NODE,l=n[i.loopLimitsName],s=n[i.loopFnName],c=(l||{})[t],p=c,d=c;if(!l)throw"Blick error:\n- Template might have wrong notation(s).\n- Check %variable.";if(2===l.length&&1===n.length&&l[0].parentNode.childNodes.length>4)return;if(!s||!c)return;e.controls.active=!1,d=e._firstTimeLoop||u(e,e.dataDump,r(s(o,t))),e.controls.active=!0,i.scanHTML(e,d,n[t],n);for(var f=d.childNodes,h=f.length;h--;)f[h].nodeType!==a||f[h].textContent!==i.loopHelperName?(1===f[h].nodeType&&(e.collector.element[n[t]["cr-id"].split(":")[1]]=f[h]),c=c.parentNode.insertBefore(f[h],c)):(f[h].parentNode.removeChild(f[h]),l.splice(t+1,0,p=f[--h]),c=c.nextSibling?c.parentNode.insertBefore(p,c.nextSibling):c.parentNode.appendChild(p));e._firstTimeLoop&&(l.splice(1,1),e._firstTimeLoop=null);e.controls.helpers&&A(e,t,n)}(this,e,t,n)},findElement:function(e){return this.collector.element[e["cr-id"].split(":")[1]]}}).constructor}(t,t.cloneObject);function i(t,n){!t.options.debugMode||t.options.debugLevel>n||e.console&&e.console[t.options.debugMode]&&e.console[t.options.debugMode].apply(null,[].slice.call(arguments).slice(2))}function a(e,t,n){var r=-1!==n.indexOf("focus"),o=r&&-1!==n.indexOf(":end");return!0===n||"true"===n||n&&!1!==n&&"false"!==n&&!r?(e.setAttribute(t,"selected"===t?t:""),function(){e[t]=!0}):(e.removeAttribute(t),r&&e.focus(),o&&(e.selectionStart=e.selectionEnd=e.value.length),function(){e[t]=!1})}function l(e,t,n){return e.setAttribute(t,n),e.value=n,function(){}}function s(e,t){var n=document.createTextNode("");return t?e.insertBefore(n,e.childNodes[0]):e.appendChild(n)}function c(e,t,n,r,o,i,a){var l=!!n;l?t=[n[0].parentNode]:(o=s(a=(t=Array.prototype.slice.call(t))[0].parentNode,!0),e[e.length-1].node=s(a));for(var c=e.length-(l?0:1),u=(t[0],c);u--;)if("each"===r[e[u].id].tagData.helper){if(!l&&e[u].id===e[c].id){e[u].node=o;break}!l&&!e[u].isStart||l&&e[u].isStart?(a=t.pop().childNodes[0].parentNode,i=!l&&s(a,!l),e[u].node=s(a,l)):e[u].node=i||s(t[0],!l)}}function u(e,t,o,a,l){var s,u,p=t.length&&function(e,t,o,i,a){for(var l,s,u,p=document.evaluate(e.xpath,t,null,e.type,null),d=[],f=0,h=0;l=p.snapshotItem(f++);){d=[],h=0,l.textContent=l.textContent.replace(e.regex,function(t,n,r,o){return u={id:+r,isStart:n===e.startTag,index:o-h},d.push(u),h+=t.length,""}),l.nodeType===Node.ATTRIBUTE_NODE?(s=l,l=r(l.textContent,!0,!0).firstChild):s=n,(l.nextSibling&&(l.nextSibling.rows||l.parentNode.rows)&&"each"===i[u.id].tagData.helper||l.parentNode.rows)&&c(d,l.nextSibling.rows,(l.parentNode.rows||[{}])[0].cells,i);for(var v=d.length;v--;)o[(u=d[v]).id]||(o[u.id]={start:u.node||l,end:l,attr:s}),u.node?o[u.id][u.isStart?"start":"end"]=u.node:u.isStart?o[u.id].start=l.splitText(u.index).splitText(0).previousSibling:o[u.id].end=l.splitText(u.index)}return o}(e.xpath,o,[],t,e.options.loopHelperName);for(l&&p&&(e._tempNode=p[t[0].id].start);s=t.shift();)(u=p[s.id]?p[s.id].attr?P:"B"!==s.tagData.tag?S:O:null)?u(e,p[s.id],s,t,a):i(e,3,"Missing NodeElement in template:",{template:o.innerHTML});return o}function p(e,t,r){for(var o=0,i={},a=e.length;o<a;o++)i=e[o].variable,e[o].renderArgs&&p(e[o].renderArgs,e[o],r),i.active&&t.value!==n&&(t.renderArgs[o].parentHelper=t,r.push(t.renderArgs[o]))}function d(e,t,r,o,a){var l,s=r.variable,c=r.value!==n,u=r.key||s.value,d=a.partial&&a.partial.value;if("cr-scroll"===s.value&&o[0].variable.active&&(o[0].scrollers={}),r.renderArgs&&!d&&p(r.renderArgs,r,t),s&&s.active&&d!==s.value){if("@"===u.charAt(0)&&(r.parent[u]===n&&(r.parent[u]=""),c=!0,s.depth&&(r.movingParent=!0)),"@root"===s.path[0]&&(r.isFromRoot=!0),r.loop&&!r.parent.parent&&Object.defineProperty(r.parent,"__cr-id",{value:r.loop["@root"]["__cr-id"]}),r.parent["cr-id"]||r.parent.this||Object.defineProperty(r.parent,"cr-id",{value:r.loop.this["cr-id"]||r.loop["@parent"]["cr-id"]}),null===(l=e.options.isDynamic(r,u,e.options.forceUpdate)))return i(e,3,"No subscriber defined for:",'"'+u+'"',"in:",r.parent);e.options.debugMode&&function(e,t,r,o,a,l,s){t?1===r?i(e,1,"Engaging property",o.helper&&o.helper.value||o.helper||"-",'"'+s+'" ->',a.value,l.length,r):i(e,2,2===r?'Added model activity: "'+s+'" ->':'Missing model activity: "'+s+'" ->',a.value):t||e.options.missingProperty===n?t||e.options.missingProperty!==n||i(e,3,'Property "'+s+'", defined in template'+(o.helper?' by block "'+(o.helper.value||o.helper)+'"':"")+", is missing in model."):i(e,2,"Installing",a,"not supported yet if not in model")}(e,c,l,a,r,o,u),c&&t.push(r)}}function f(e,t,n,r,o,i,a){for(var l=e.options.limiters,s=e.dataDump.length+l[2],c="B"!==o.tag&&(o.helper&&!o.helperFn||!!o.partial),u=[],f=0,h=n.length;f<h;f++)n[f].parent?d(e,u,n[f],n,o):n[f].renderArgs&&p(n[f].renderArgs,n[f],u);return a&&function(e,t,n,r,o){for(var i,a=1,l=t.length;a<l;a++)if(t[a].vars.length)for(var s=(i=n(t[a])).length;s--;)d(e,o,i[s],i,r)}(e,o.children,a,o,u),0===u.length||o.partial?t:(e.dataDump.push({id:e.dataDump.length,out:t,track:i,bodyFn:r,data:n,actives:u,tagData:o,helperFn:c?r:null}),l[0]+s+t+l[1]+s)}function h(e,t,r,o){var i=e.parentHelper,a=i&&i.variable.renderFn,l=i&&i.renderArgs,s=!!e.variable.path.length;return function(c,u,p){var d=c!==n&&null!==c&&(c[o]||"").length,f="array"===e.type;s&&p!==e.parent||!f&&c===e.value&&e.variable.active<2||(e.value=c,a&&(l!==t[0].renderArgs&&function e(t,n){if(t.value=t.variable.renderFn(t.renderArgs),n)for(var r=n.length;r--;)n[r].renderArgs&&t.renderArgs!==n[r].renderArgs&&e(n[r])}(i,t[0].renderArgs),t[0].value=a(t[0].renderArgs)),r(t,e.loop,u||d&&(!f||0!==c.length),e.scrollers))}}function v(e,t,n,r){return e[t]||(e[t]={}),e[t][n]?e[t][n].push(r):e[t][n]=[r],e[t][n]}function g(e,t){var r=e[t[0]]=e[t[0]]||{};return t[1]===n&&(t[1]="root"),r[t[1]]=r[t[1]]||[]}function m(e,t){return function(){return e.splice(e.indexOf(t),1)[0]}}function y(e,t,n,r,o){var i=m(e,n);return function(e){var n=i(),a=(t.updaters,o);if(e){for(;a;)e=e.parentNode||{},a--;t.updaters[e["cr-id"]][r].push(n)}}}function b(e,t,n,r,o){e.controls.helpers||(e.controls.helpers=!0),t[r]=t[r]||{},t[r][o]=n.parent}function x(e,t,r,o,i,a){for(var l,s,c=i.length,u={},p="",d="",f="";c--;)p=(u=i[c]).key||u.variable.value,l=h(u,o,t,e.options.loopLimitsName),f=u.loop&&u.loop.this["cr-id"],d=u.parent.this!==n?u.parent.this["cr-id"]:u.parent["cr-id"],u.parent["cr-id"]===n&&Object.defineProperty(u.parent,"cr-id",{value:d}),g(r.destroyers,d.split(":")),s=v(r.updaters,d,p,l),"@"===p.charAt(0)&&b(e,e.collector.helpers,u,d,p),u.movingParent&&v(r.movers,f,p,y(s,r,l,p,u.variable.depth)),u.isFromRoot&&g(r.destroyers,f.split(":")).push(m(s,l));a&&function(e,t,n,r,o,i){for(var a=r[0].value.length,l=-1,s=t.length,c=e.options;s--;)8===t[s].nodeType&&t[s].textContent===c.loopHelperName?(i.unshift(t[s-1]),t[s].parentNode.removeChild(t[s]),a--):3!==t[s].nodeType&&(e.collector.element[r[0].value[a]["cr-id"].split(":")[1]]=t[s],c.registerLoopItem(t[s],r[0].value[a],c.debugMode,l===a),l=a);o[0].value[c.loopLimitsName]||Object.defineProperty(o[0].value,c.loopLimitsName,{value:i})}(e,a,0,o,i,[])}function _(e,t,n,r){var o,i=r.destroyers[n[0]];if(delete t[e],i[n[1]]){for(;o=i[n[1]].shift();)o();delete i[n[1]]}}function k(e,t,n,r){var o=e.updaters,i=t.split(":"),a=e.movers;for(var l in delete e.element[i[1]],"root"===i[1]&&(t=i[0]),o[t])_(l,o[t],i,e);if(delete o[t],delete e.helpers[t],a=e.movers[t]){for(var s in a)for(var c=a[s].length;c--;)a[s][c]();delete e.movers[t]}if(n){var u=r(n);for(c=u.length;c--;)k(e,u[c]["cr-id"],u[c],r)}}function N(e,t,n,r,o,a){var l=e.options.loopFnName,s=n.variable.active,c=n.value,u=s?" \x3c!--"+e.options.loopHelperName+"--\x3e":"";if("function"!=typeof t)return o?(i(e,0,"loopHelper:","->",n),c&&!c[l]&&s&&Object.defineProperty(c,l,{value:o}),!c||c["cr-id"]||s||(c["cr-id"]=n.parent["cr-id"]),(r||a?"":u)+t+u):c&&c.length?"":u;!c[l]&&s&&Object.defineProperty(c,l,{value:t})}function C(e){for(var t=0;e&&e.parent;)t++,e=e.parent;return t}function A(e,t,r,o,i,a,l,s){var c,u,p=["@index","@key","@number","@odd","@first","@last","@length","@depth"],d=e.collector.helpers,f=d[(r[0]||o)["cr-id"]],h=0,v=0,g="",m=o||r[t],y=e.collector.updaters[m["cr-id"]],b=l&&l[a],x=!(!i&&f)||y["@length"],_=f&&function(e,t,r){!function(e,t,r,o){var i=e.length,a=o.length,l="",s=t;if(t)for(;a--;)t[l=o[a]]!==n&&(s=t[l],0===a?s[l]=r:1===a?s[l]=Array.isArray(e)?r:Object.keys(e)[r]:2===a?s[l]=r+1:3===a?s[l]=r%2!=0:4===a?s[l]=0===r:5===a?s[l]=r===i-1:6===a?s[l]=i:7===a&&(s[l]=C(e)))}(r,d[r[e]["cr-id"]],e-t,p)};if(f)if(i)for(h=x?0:t,v=r.length;h<v;h++)_(h,0,r);else if(o){if(o){if(r!==l)for(g in c=e.collector.movers[b["cr-id"]])for(;u=c[g].shift();)u(m);for(h=x?0:a,v=l.length;h<v;h++)_(h,0,l);for(h=x?0:t,v=r.length;h<v;h++)_(h,0,r);y["@depth"]&&s&&function e(t,n,r,o){for(var i=t[o].length,a=t,l="",s=0;i--;){l=(a=t[o][i])["cr-id"],n.updaters[l][r].length&&(s=C(t[o]));for(var c=n.updaters[l][r].length;c--;)n.helpers[l][r][r]=s;a[o].length&&e(a,n,r,o)}}(b,e.collector,"@depth",s)}}else for(h=x?0:t+1,v=r.length;h<v;h++)_(h,0,r)}function E(e,t,n,r,a,l){var s=e.options,c=n[s.loopLimitsName],u=c&&c[t].nextSibling,p=c&&c[t+1].nextSibling,d=u;if(!c)throw"Blick error: Array is not defined as being dynamically mutable";if(!u||!p||c.length!==n.length+(a?1:2)&&!l)return i(e,3,"Blick error: model doesn't match view. \nModel:",n);for(;(u=d)&&u!==p&&(d=u.nextSibling);)o.appendChild(u);return c.splice(t+1,1),a?o:(k(e.collector,r[["cr-id"]],r,s.scanHTML(e,o,r,n,!1,!0)),e.controls.helpers&&A(e,t,n,r,!0),o)}function P(e,t,n,r){var o=/>/g,i=t.attr.ownerElement,a=t.attr.nodeName,l=e.options.attributes[a],s=function(e){var n=e.parentNode;if(11!==n.nodeType)return l?l(i,a,n.textContent)():void(t.attr.textContent=n.textContent.replace(o,""))};return s("B"!==n.tagData.tag?S(e,t,n,r,s):O(e,t,n,r,s))}function S(e,t,n,o,i){var a=t.start;return x(e,function(e,t,n,o,i){var a=n||o?null:document.createDocumentFragment(),l=e.nextSibling;return function(s,c){var u=[],p=i?i(s,c):s[0].value,d=e,f=null;if(o||n&&!i)return l.textContent=p,o&&o(l),p;for(u=r(p+"").childNodes;d.nextSibling!==t;)u.length?(d.parentNode.replaceChild(f=u[0],d.nextSibling),d=f):d.parentNode.removeChild(d.nextSibling);if(u.length){for(;u.length;)a.appendChild(u[0]);t.parentNode.insertBefore(a,t)}}}(a,t.end,n.tagData.isEscaped,i,n.helperFn),e.collector,n.data,n.actives),a}function O(e,t,o,i,a){var l="each"===o.tagData.helper||!o.tagData.helper&&!o.data[1]&&"array"===o.data[0].type,s=t.start,c=l?[]:n,p=l?t.start.nextSibling:t.start;if(l)for(;s&&s!==t.end.nextSibling;)c.push(s),s=s.nextSibling;else o.data[0].scrollers&&T(!0,o.data[0],o.track.fnIdx,p.parentNode);return x(e,function(e,t,o,i,a,l,s,c,p){var d=[],f=a.fnIdx,h=[],v=e.options;return h[f]=document.createDocumentFragment(),d[f]=l.length>0,a.checkFn=function(t){d[t]||(e.controls.active=!1)},function(l,g,m,y){y&&T(!0,l[0],f);var b=l[0].value&&l[0].value.length,x=i(l,g,m),_=t,k=t,N=!d[a.fnIdx],C=f>a.fnIdx&&p&&d[a.fnIdx]===n,A=l[0].loop&&l[0].loop.this,E=f!==a.fnIdx;if(f!==a.fnIdx||!x)for(;(k=t.nextSibling)&&k!==o;)h[f].appendChild(k);if(f=a.fnIdx,N){for(h[f]=h[f]||document.createDocumentFragment(),_=u(e,s,r(x),c,m===v.loopHelperName),y&&T(!0,l[0],f,_);k=_.childNodes[0];)h[f].appendChild(k);d[f]=!!x}if(C&&l[0].value[v.loopLimitsName]&&b)return e._firstTimeLoop=h[f],l[0].value[v.loopLimitsName].push(t),"";N&&x&&!c&&v.scanHTML(e,h[f],A,l[0].renderArgs?l[0]:l[0].parent["__cr-id"]&&l[0].parent||l[0].value,"skip"),x&&o.parentNode.insertBefore(h[f],o),y&&x&&T(!1,l[0],f),c&&(E||(t.nextSibling.textContent=x),c(t)),s.length&&s.splice(0,s.length)}}(e,p,t.end,o.bodyFn,o.track,o.out,i,a,l),e.collector,o.data,o.actives,c),p}function T(e,t,n,r){r&&(t.scrollers[n]=r.querySelectorAll("[cr-scroll]"));for(var o=t.scrollers[n].length,i=t;o--;)i=t.scrollers[n][o],r&&i.removeAttribute("cr-scroll"),e?i.__scroll={y:i.scrollTop,x:i.scrollLeft}:(i.scrollTop=i.__scroll.y,i.scrollLeft=i.__scroll.x);return t}}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],function(){return t()},"VArray"):"object"==typeof exports?exports.VArray=t():e.VArray=t()}(this&&this.window||global,function(){"use strict";var e=void 0,t=Array.prototype,n=0,r={},o=function(e,t){for(var n=e.length;n--;)t.unshift(e[n]);return t},i=function(){return t=i,n=arguments,(e=[]).push.apply(e,n),Object.setPrototypeOf(e,t.prototype);var e,t,n};return i.prototype=Object.create(Array.prototype),i.prototype.constructor=Array,i.adopt=function(e,t){return v(e,t)},(e=i.prototype).shift=function(){return s(e=this,e[0]);var e},e.pop=function(){return s(e=this,e[e.length-1]);var e},e.unshift=function(){return function(e,t){for(var n=t.length;n--;)l(e,t[n],0,0===n);return e.length}(this,o(arguments,[]))},e.push=function(){return function(e,t){for(var n=0,r=t.length;n<r;n++)l(e,t[n],e.length,n===r-1);return e.length}(this,o(arguments,[]))},e.splice=function(){return function(e,t){var n=e._onChange._options.children,r=t[0]<0?e.length+t[0]:t[0],o=t[1],i=0,a=0,c=[];for(i=0;i<o&&t[i+2]&&e[r+i];i++)c.push(e.replace(t[i+2],r+i)),void 0!==t[i+2].index&&t[i+2][n].parent.remove(t[i+2]);for(a=i;a<o&&e[r+i];a++)c.push(s(e,e[r+i]));r>e.length&&(r=e.length);for(i+=2;i<t.length;i++)l(e,t[i],r+(i-2),i>=t.length);return c}(this,o(arguments,[]))},e.sort=function(e){return a(this,e)},e.reverse=function(){return function(e){for(var n=e._onChange._options.idProperty,r={},o=e.length;o--;)r[e[o][n]]=o;return a(e,t.reverse.call(e),r)}(this)},e.fill=function(e,t,n){return function(e,t,n,r){if(n=+n||0,r=void 0===r?e.length:Math.min(+r,e.length),NaN===n||n>=r)return e;for(var o=r-n;o--;)l(e.getCleanModel(t),n,!!o);return e}(this,e,t,n)},e.copyWithin=function(e,t,n){return function(e,t,n,r){if(n=+n||0,r=void 0===r?e.length:Math.min(+r||0,e.length),NaN===n||n>=r)return e;for(var o=n;o<r;o++)l(e.getCleanModel(e[o]),t,o<r);return e}(this,e,t,n)},e.move=function(e,t){return l(this,e,t)},e.remove=function(e){return s(this,e)},e.replace=function(e,t){return f(this[t],e),this[t]},e.filterAll=function(e,t){return function(e,t,n,o){var i=e._onChange._options.children,a=r[e[e._onChange._options.idProperty].split(":")[0]],l=!e.parent,s=a,c="";n&&(t=t.bind(n));for(c in a)s=a[c],!l&&!p(s[i].parent,e)||t&&!t(s,c,a)||o.push(s);return o}(this,e,t,[])},e.getElementById=function(e,t){var n=t?e.substring(0,e.indexOf(":")):"",o=r[n||this[this._onChange._options.idProperty]];return o?o[e.substring(e.indexOf(":")+1)]:null},e.addSubscriber=function(e,t){var n=Array.isArray(e)?e:e.split(/[./]/),r=function(e,t){for(var n=0,r=t.length,o=e;n<r;n++){if("*"===t[n])return{model:o,value:e,path:t};o=e,e=e&&e[t[n]]}return{model:o,value:e,path:t}}(t,n);if(r.model)return x(r.model,n[n.length-1],{},n,this._onChange._options.promoter)},e.getCleanModel=function(e){return JSON.parse(JSON.stringify(e||this))},e.updateModel=function(e){return d(this,e)},e.destroy=function(e){for(var t in e="object"!=typeof e?e:this[this._onChange._options.idProperty].split(":")[0],r[e])delete r[e][t];delete r[e]},i;function a(e,n,r){var o,i,a=e._onChange._options.idProperty,l=r||{},s=0,u=0,p=!r&&function(e,t){for(var n in e)e[t]<e[n]&&--e[n];delete e[t]};if(!r)for(s=e.length;s--;)l[e[s][a]]=s;for(i="function"==typeof n||void 0===n?t.sort.call(e,n):n,s=0,o=e.length;s<o;s++)e._onChange(c,{action:"sort",index:(u=l[e[s][a]],p&&p(l,e[s][a]),u),item:e[s],parent:e,last:s===o-1});return i}function l(e,n,r,o){var i=e._onChange._options,a=i.children,l=void 0!==n.index,s=l?n.parentNode:void 0,p=l?n[a].parent:void 0,d=l?n.index:r,f=l?void 0:function(e){for(;e.parent;)e=e.parent;return e}(e),h=t.splice;h.call(e,r,0,l?h.call(p,d,1)[0]:n),p&&p!==e&&function(e,t,n){var r=e.parentNode;e[n].parent=t,(r=t.parent&&t.parent[u(t,e.index,n)])?void 0!==e.parentNode?e.parentNode=r:b(e,"parentNode",r,!0,!1,!0):delete e.parentNode}(n,e,a),l||(n=m(n,u(e,r,a),i,e.parent,f),a&&(n[a]=v(n[a]||[],i,e,f,r))),e._onChange(c,{action:l?"move":"add",index:d,parent:e,previousParent:p,previousNode:s,item:n,last:void 0===o||o})}function s(e,n){var r=n.index,o=t.splice.call(e,r,1);return e._onChange(c,{action:"remove",index:r,parent:e,item:n,last:!0}),o[0]}function c(e,t,n){if(e!==c)return n.error&&n.error("VArray._onChange() only for internal use",1);"remove"===t.action&&function e(t,n){var o=r[t[0]];var i=o[t[1]][n.children]||[];var a=i.length;for(;a--;)e(i[a][n.idProperty].split(":"),n);delete o[t[1]]}(t.item[n.idProperty].split(":"),n),n.promoter.onChange(t)}function u(e,t,n){var r=e[t-1]||e[t+1],o=r?r.parentNode&&r.parentNode.index:-1;return(!r&&e.parent?e.parent.find(function(t,r){if(t[n]===e)return o=r,!0}):void 0)||r?o:t}function p(e,t){for(;e&&e!==t;)e=e.parent;return e}function d(e,t){for(var n=0,r=e.length;n<r;n++)void 0!==t[n]?h(e,t,n):e.pop();if(t&&r<t.length)for(n=r,r=t.length;n<r;n++)e._onChange?l(e,t[n],n,n===r-1):e.push(t[n])}function f(e,t){for(var n=Object.keys(e),r=0,o=n.length;r<o;r++)h(e,t,n[r])}function h(e,t,n){var r=e._onChange&&e._onChange._options.promoter.onUpdate;r&&r(e[n],t[n],n,e),e[n]&&Array.isArray(e[n])?d(e[n],t[n]):e[n]&&"object"==typeof e[n]?f(e[n],t[n]):e[n]!==t[n]&&void 0!==t[n]&&(e[n]=t[n])}function v(e,t,o,a,l){var s=!Array.isArray(e),u=i.apply(null,s?[e]:e);return b(u,"_onChange",a?a._onChange:function(e,n){c(e,n,t)},!1),a||b(u._onChange,"_options",t,!1),s&&b(u[0],t.idProperty,""+n++,!1),s?g(u[0],t)&&u:function(e,t,o,i,a){i||(r[n]={});b(e,t.idProperty,(i?i[t.idProperty]+":":"")+n++,!1),o&&b(e,"parent",o,!0);for(var l=0,s=e.length;l<s;l++)m(e[l],a,t,o,i||e),t.children&&(e[l][t.children]=v(e[l][t.children]||[],t,e,i||e,l));return e}(u,t||{},o,a,l)}function g(e,t){for(var n,r=t.listeners.length;r--;)(n=N(e,t.listeners[r].split("."),0,0,t.promoter))&&x(n.model,n.key,{},n.path,t.promoter);return e}function m(e,t,o,i,a){return o.promoter.interseptor&&o.promoter.interseptor(e,i&&i[t],i,a,y),r[a[o.idProperty].split(":")[0]][n]=e,b(e,o.idProperty,a[o.idProperty]+":"+n++,!1),i&&b(e,"parentNode",i[t],!0,!1,!0),function(e,t,n){Object.defineProperty(e,"index",{get:function(){return(e[t]&&e[t].parent||n).indexOf(e)}})}(e,o.children,a),g(e,o),e}function y(e,t,n){for(var r in(n=n||{}).force=void 0===n.force||n.force,t)(void 0===e[r]||n.force)&&b(e,r,t[r],!0,!!n.show,!0)}function b(e,t,n,r,o,i){return Object.defineProperty(e,t,{enumerable:!!o,configurable:void 0!==i&&i,writable:void 0===r||!!r,value:n})}function x(e,t,n,r,o){return n[t]=e[t],Object.defineProperty(e,t,{get:function(){return n[t]},set:function(i){var a=n[t];if(a&&a._onChange&&i!==a)return d(a,i);n[t]=i,!1===o.onChange({action:"change",value:i,oldValue:a,path:r,item:e,key:t})&&(n[t]=a)}})}function _(e,t,n,r,o,i,a){var l="object"==typeof e,s=l&&N(e[t],n,r+o+1,t,a),c=r+2===n.length;if(s&&l&&(s.path=s.path.slice(0),s.path[r]=""+t,o&&"*"===s.path[o-1]&&(s.path[o-1]=""+i),"*"===s.key&&(s=N(e,s.path,r,0,a)),s))return x(c?s.model:e,c?s.key:t,{},s.path,a)}function k(e,t,n,r,o,i){if(Array.isArray(e))for(var a=0,l=e.length;a<l;a++)_(e,a,t,n,r,o,i);else for(var s in e)_(e,s,t,n,r,o,i)}function N(e,t,n,r,o){for(var i=e,a=n,l=t.length;a<l;a++){if("*"===t[a])return k(e[t[a-1]]||e,t,a,n,r,o);if(void 0===i[t[a]])return;e=i,i=i[t[a]]}return{model:e,path:t,key:t[t.length-1]}}}),define(["toolbox"],function(e){return function(t,n){var r={},o={};function i(e,t,n){for(var r=0,o=t.length;r<o;r++)t[r]&&t[r].call(e,n)}function a(e){return decodeURI(e?location.hash.substring(e.length):location.pathname+location.search)}function l(e,t){var n=e.regexp&&e.regexp.exec(t),r={};if(!n)return null;for(var o=0,i=(n=n.slice(1)).length;o<i;o++)n[o]=n[o]?o===i-1?n[o]:decodeURIComponent(n[o]):null,e.names[o]&&(r[e.names[o]]=n[o]);return n.parameters=r,n.queries=function(e){for(var t=0,n=(e=e?e.split("&"):[]).length,r={},o=[];t<n;t++)r[(o=e[t].split("="))[0]]=o[1];return r}(n[i-1]),n.path=t.replace(/^\//,"").split("/"),n}for(var s in o.triggerEvent=function(t,n,r){var o,i=r||{},a=i.ownerDocument===document?e.findParent(r,"cr-id"):void 0,l=!a&&i.parentOnly?this.getParentComponent(i.parentOnly).element:void 0;i.detail=n,i.element=a||l||i.element||window,i.bubbles=!l&&(void 0===i.bubbles||i.bubbles),o=new CustomEvent(t,i),i.element.dispatchEvent(o)},o.installEvent=function(t,n,r,o){return e.addEvent(t||window,n,r,o)},o.getView=function(t,n){return e.$('[cr-view="'+t+'"]',n["cr-id"]?n:e.findParent(n))},o.subscribe=function(e,t,n,o,i){var a=this,l=t;if(e=e?e.name||e.components&&e.components[t]||e:this.name,r[e]=r[e]||{},(t=r[e][t]=r[e][t]||{})[n]=t[n]||[],o&&(t[n].push(o.callback||o),o.regexp&&!t[n].regexp&&(t[n].regexp=o.regexp,t[n].names=o.names)),n&&t[n])return i&&void 0!==t[n].value&&(o.callback||o).call(this,t[n].value),function(){a.unsubscribe(e,l,n,o)};delete r[e]},o.publish=function(e,t,n,o){return e="string"==typeof e?e:this.name,r[e]=r[e]||{},r[e]&&((t=r[e][t]=r[e][t]||{})[n]=t[n]||[],t[n].value=o,t[n][0]&&i(this,t[n],o)),t[n]&&t[n].length?o:void 0},o.unsubscribe=function(e,t,n,o){var i=-1,a={};return e="string"==typeof e?e:e.name||this.name,r[e]&&r[e][t]&&r[e][t][n]&&-1!==(i=(a=r[e][t][n]).indexOf(o.callback||o))&&a.splice(i,1),o.callback||o},o.addRoute=function(t,n,o){var s,c,u=this,p="object"==typeof t.path?{regexp:t.path}:(s=t.path,c=[],s=s.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(e,t){return c.push(e.substring(1)),t?e:"([^/?]+)"}).replace(/\*/g,"([^?]*?)"),{regexp:new RegExp("^"+s+"(?:\\?([\\s\\S]*))?$"),names:c}),d=o||this.options.hash,f=l(p,a(d)),h=r[this.name]&&r[this.name].__router,v={};return this.subscribe(null,"__router",t.path,{callback:t.callback,names:p.names,regexp:p.regexp||p},n),n&&f&&t.callback.call(this,f),v=!h&&function(t,n,r){var o=void 0!==window.onpopstate?"popstate":"hashchange";return e.addEvent(window,o,function(e){var o={};for(var s in t)(o=l(t[s],a(r)))&&i(n,t[s],o)},n.id)}(r[this.name].__router,this,d),function(){u.removeRoute(t),!h&&v()}},o.removeRoute=function(e){return this.unsubscribe(null,"__router",e.path,e.callback)},o.toggleRoute=function(e,t){var n=r[this.name].__router,o=n[e.path].paused||n[e.path];n[e.path]=t?o:[],n[e.path].paused=t?null:o},Object.defineProperties(n,{Toolbox:{value:e},CreateInstance:{value:function(e,t,r){var o,i,a=!!n.circular,l=n.circular||Object.defineProperties(n,{circular:{value:new n(e,t)}}).circular;return r&&require([r],function(){}),!a&&l.options.debug&&(o=l.version,(i=document.createElement("meta")).setAttribute("mvc-name","CircularJS"),i.setAttribute("version",o),document.head.insertBefore(i,document.head.children[0])),l}}}),o)t[s]={value:o[s]};return t}},"api"),define(["toolbox"],function(e){"use strict";function t(e){this.element=e||document.body,this.listeners={},this.events={},this.items={}}return t.prototype={installEvent:function(t,n,o,i){!function(t,n,o,i,a){var l=o.length-(o=o.replace(/\!/g,"")).length,s=o.length-(o=o.replace(/\?/g,"")).length,c=t.events[o]=t.events[o]||{},u=!!/(?:focus|blur|mouseenter|mouseleave|scroll)/.test(o);t.items[o]||(t.items[o]=[]);n.delegate=s,n.path=[];for(var p=i.length,d="";p--;)d=i[p]=i[p].replace(/[?!]/g,""),c[d]?c[d].push(n):c[d]=[n];if(t.listeners[o])return;t.listeners[o]=e.addEvent(t.element,o,function(n){!function(t,n,o,i,a){var l=i[n.type],s=e.keys(l),c=n.composedPath&&n.composedPath()||n.path,u=a[n.type].length?a[n.type]:function(e,t,n,o,i){var a=0,l=0,s="",c=n;for(a=t.length;a--;)if(s=t[a],o[s])for(l=n[s].length;l--;)(c=n[s][l]).model.index<0?n[s].splice(l,1):(c.element!==e&&(c.path=r(c.element,e,[c.element])),i.push(c));return i.length<2?i:i.sort(function(e,t){const n=e.path.indexOf(t.element),r=t.path.indexOf(e.element);return n>r?1:n<r?-1:e.model[e.idTag]>t.model[t.idTag]?1:e.model[e.idTag]<t.model[t.idTag]?-1:e.path.length>t.path.length?1:t.path.length>e.path.length?-1:0})}(t.element,s,l,o,[]),p="",d=0,f=0,h=!1,v=u[0],g=v&&v.model,m=v&&v.element,y=g;for(a[n.type]=u,d=u.length;d--;){if(h)return;if(v=u[d],c?-1!==c.indexOf(v.element):v.element.contains(n.target))for(f=s.length;f--;)p=s[f],o[p]&&-1!==v.callbacks.indexOf(p)&&(m=v.delegate?e.findParent(n.target,v.idTag,v.element):v.element,g=v.delegate?m&&v.getElementById(m[v.idTag],!0):v.model,y=g&&g[v.children]&&g[v.children].parent,g&&(h=!1===o[p](n,m,g,y,y&&(v.delegate?m:e.findParent(n.target,v.idTag,v.element)))||n.cancelBubble||h))}}(t,n,a,t.events,t.items)},!!(u||l>1)||1!==l&&void 0)}(this,n,t,o,i)},removeEvent:function(e){n(this,e)},destroy:function(){var t=this;return e.keys(this.listeners).forEach(function(e){n(t,e)}),this.element=null},setSort:function(){for(var e in this.items)this.items[e]=[]}},t;function n(t,n){var r=t.listeners[n],o=r&&t.events[n],i=o&&e.keys(o)||[],a={};if(r){t.listeners[n]=r();for(var l=i.length;l--;)for(;a=o[i[l]].pop();)a.element=a.model=null}}function r(e,t,n){for(;(e=e.parentNode)&&e!==t;)n.unshift(e);return n}},"controller"),define(["toolbox","blick","VArray","api","controller"],function(e,t,n,r,o){"use strict";var i=0,a={},l={},s=e.$,c=e.$$,u=e.$create,p=e.isArray,d=e.keys,f=e.cloneObject,h=function(e,t){this.controls={initPartials:!1},this.version="2.0.3",this.id=0,this.name="",this.options={hash:"#",partials:{},helpers:{},attributes:{},debug:0},v(this,e,t||{})},v=function(e,t,n){var r="string"==typeof t;for(var o in r||(n=t||{}),n)e.options[o]=n[o];e.id="cr_"+i++,e.name=r?t:e.id,l[e.id]={}};return Object.defineProperties(h.prototype,r({createComponent:{value:function(e,t,n,r,o){var i=g(n["__cr-id"]),a=document.createElement(e);for(var l in t)a.setAttribute(l,t[l]);return o&&(a.innerHTML=o),(r||i.element).appendChild(a),x(i,r||i.element,e,!0),a}},hideComponent:{value:function(e){var n=e&&e._tracker||document.createTextNode(""),r=e&&g(e["cr-id"]);if(e&&(e.__scrollers=e.__scrollers?t.setScroll(!0,e.__scrollers,0):t.setScroll(!0,{scrollers:[]},0,e)),e&&e.parentNode)return e._tracker||(e._tracker=e.parentNode.insertBefore(n,e)),e.parentNode.removeChild(e),function(o){return o&&e._tracker&&o!==e._tracker.parentNode?(e._tracker.parentNode.removeChild(e._tracker),delete e._tracker):o=void 0,o?o.appendChild(e):n.parentNode.insertBefore(e,e._tracker),t.setScroll(!1,e.__scrollers,0),y(e,r),e}}},getChildComponents:{value:function(e){for(var t=e["__cr-id"].split(":"),n=l[t[0]][t[1]].children,r=[],o=n.length;o--;)t=n[o].split(":"),r.push(m(this,t[1],t[0]));return r}},getParentComponent:{value:function(e){return m(this,l[this.id][e["__cr-id"].split(":")[1]].parent.split(":")[1])}},destroyComponent:{value:function(e,t){e&&(b(e["cr-id"],g(g(e["cr-id"]).parent)),t&&e.parentNode.removeChild(e))}},getModelElement:{value:function(e,t){return l[this.id][e["__cr-id"].split(":")[1]].template.blick.findElement(t)}}},h)),Object.defineProperties(h,{Service:{value:function(e,t){}},App:{value:function(e,t){return e.selector||(e.selector="app"),e.initialize=!0,h.Component(e,t)}},Component:{value:function(t,r){var c,v,m,b,E=!!a[t.selector],T=t.circular||h.CreateInstance(),w=!E&&function(e,t){var n=d(e);e.this||(e.this=[]);for(var r=n.length,o="",i=[];r--;)if(o=n[r],!((i=o.split(":")).length<2))for(var a=i.length;a--;)a>0?t[i[a-1]]=i[a].replace(/\]/g,""):(e[i[a]]=e[o],delete e[o]);return t}(t.subscribe$||(t.subscribe$={}),{}),F=E?a[t.selector]:a[t.selector]={Klass:r,selector:t.selector,subscribe$:t.subscribe$,childNames:w,template:t.template&&t.template.blick?t.template:S(t.template||"",function(e,t){return{helpers:f(f({},e.helpers),t.helpers||{}),partials:f(f({},e.partials),t.partials||{}),attributes:f(f({},e.attributes),t.attributes||{}),forceUpdate:!0,limitPartialScope:!1,debugMode:e.debug?"warn":"",debugLevel:e.debug,registerLoopItem:N,isDynamic:A,scanHTML:C}}(T.options,t)),styles:(c=t.styles,v=t.selector,m=c?p(c)?c.join("\n"):c:"",b=m&&u("style"),b?(b.setAttribute("name",v),b.innerHTML="\n"+m+"\n",document.head.appendChild(b)):null),singleton:!1,initialize:!1,crInst:T,init:function(r,a,c,u){return t.initialize&&(F.initialised=!0),function(t,r,a,s,c,u){var f=r.crInst,h=i++,v=t["cr-id"],m=v&&!s,b=r.template,N=m?null:l[f.id][h]={instance:{},controller:{},models:[],parent:"",template:b,element:t,crInst:f,children:[],views:{},listeners:{},destroyers:[]},C=e.trim(t.innerHTML),A=f.id+":"+h,E=r.template.blick.options,T=r.template.blick.partials;if(m||r.singleton&&!s)return g(v);r.singleton=!!a.singleton||a.initialised,s||(t["cr-id"]=A,N.crInst.options.debug&&t.setAttribute("cr-id",A));C&&(t.innerHTML=function(e,t,n){var r=t.replace(/cr-src/g,"src"),o=S(r,n,!0),i=e.childComponents;e.enableEvents=e.enableEvents||o.enableEvents;for(var a=o.childComponents.length;a--;)-1===i.indexOf(o.childComponents[a])&&i.push(o.childComponents[a]);return e.blick.registerPartial("@content",r),""}(b,C,E),a.extra||(a.extra=Object.create(null)),a.extra["@content"]=T["@content"],T["@content"]=null);N.name=a.selector,N.controller=new o(t),c&&(N.parent=c["__cr-id"],g(N.parent).children.push(A));N.instance=function(e,t,n,r){return new e.Klass(t.element,function(e,n){return function(e,t,n,r){var o=n.parent&&n.parent.split(":"),i=n.parent&&(l[o[0]][o[1]]||{})||{};!1!==t&&(t=!0),O(n.element,"cr-input",function(o,a,l){!function(e,t,n,r,o,i){var a=e.split(/\s*=\s*/),l=a[1]&&(0===a[1].indexOf('"')||0===a[1].indexOf("'")),s=a[1]&&"!"===a[1].charAt(0),c=(e=s?a[1].substring(1):a[1])||a[0];e=l?e.substring(1,e.length-1):"true"===e||"false"!==e&&(+e==e?+e:void 0),hasOwnProperty.call(t,a[0])&&(void 0!==e?t[a[0]]=e:hasOwnProperty.call(r.instance,c)&&(t[a[0]]=r.instance[c],!n||l||s||function(e,t,n,r,o,i){e[o]||(e[o]={}),e[o][r]={scope:t,key:i},n.push(function(){delete e[o][r]})}(r.listeners,t,o.destroyers,i,c,a[0])))}(a,e,t,i,n,r)}),n.crInst.options.debug||n.element.removeAttribute("cr-input")}(e,n,t,r)},t.crInst)}(r,N,0,A),Object.defineProperty(N.instance,"__cr-id",{value:A}),N.models=d(r.subscribe$).sort(function(e){return"this"===e?-1:1}).reduce(function(e,t){var o=function(e,t,r){var r=r.instance,o=p(r[e])?t.childNames[e]:null,i=function(e,t,r,o){var i=e+"$PR",a=e+"$Update",s={collector:t.template.blick.collector,inst:r,blick:t.template.blick,name:e,childNodes:o};return n.adopt("this"===e?r:r[e]||[],{idProperty:"cr-id",children:o,listeners:t.subscribe$[e],instId:r["__cr-id"],error:function(e,t){if(!t)throw"VArray Error: "+e;console.error("VArray Error: "+e)},promoter:{interseptor:r[i]&&r[i].bind(r),onUpdate:r[a]&&r[a].bind(r),onChange:function(e){return"change"===e.action?function(e,t){var n=e.childNodes,r=e.inst,o=e.collector.updaters[t.item["cr-id"]],i=o&&o[t.key],a=e.name+"$",s=e.inst["__cr-id"].split(":");if(r[a]&&!1===r[a](t.key,t.item,t.value,t.oldValue))return!1;if(i)for(var c=i.length;c--;)i[c](t.value,null,t.item);if(r=l[s[0]][s[1]].listeners[t.key])for(n in r)r[n].scope[r[n].key||t.key]=t.value}(s,e):function(e,t,n,r,o,i,a,s){var c=s.blick,u=r!==n?r:n,p=n.length,d=s.name+"$Move",f="move"===e&&n._onChange._options.instId.split(":");"move"===e?(r!==n&&1===p&&k(s,t.parentNode,c.options.loopHelperName),c.moveChild(i,u,t.index,n,s.childNodes,a),0===r.length&&k(s,o),r!==n&&l[f[0]][f[1]].controller.setSort()):"add"===e?(1===p&&_(t,n,s),c.addChild(i,n,t)):"remove"===e?(c.removeChild(i,n,t),0===p&&_(t,n,s)):"sort"===e&&c.moveChild(i,n,p-1,n,s.childNodes,a),s.inst[d]&&s.inst[d](e,n.parent?s.childNodes:s.name,t,n,r,o)}(e.action,e.item,e.parent,e.previousParent,e.previousNode,e.index,!e.last,s)}}})}(e,t,r,o);return"this"!==e&&p(r[e])?(r[e]=i,{model:i,id:i["cr-id"]}):{model:i,standalone:!0,id:r["cr-id"]}}(t,r,N);return e[o.id]=o,e},{}),b&&function(e,t){var n=e.template.blick.renderHTML(e.instance,t),r=d(e.models)[0],o=e.models[r].model;x(e,n),P(e,o,n),e.element.removeAttribute("cr-cloak"),e.element.appendChild(n)}(N,a.extra);N.instance.onInit&&N.instance.onInit(t,f),u&&y(t,N);return N}(s(r),this,t,a,c,u)}},I=t.initialize?s(t.selector,t.context):{};return function(e,t){!e.controls.initPartials&&t.template&&(e.controls.initPartials=function(e,t){for(var n in e)e[n]=t.partials[n];return!0}(e.options.partials,t.template.blick))}(T,F),t.initialize&&delete a[t.selector],F.initialised?null:t.initialize?{component:F,instance:F.init(I),element:I}:F}},extend$:{value:function(e,t){var n=t.subscribe$,r="",o="",i=0;for(r in n)for(e[o=t.childNames[r]?r+":"+t.childNames[r]:r]||(e[o]=[]),i=n[r].length;i--;)-1===e[o].indexOf(n[r][i])&&e[o].push(n[r][i]);return e}}});function g(e){return e=e.split(":"),l[e[0]][e[1]]}function m(e,t,n){var r=l[n||e.id][t];return r&&{element:r.element,instance:r.instance,name:r.name}}function y(e,t){if(t.instance.onLoad&&t.instance.onLoad(e,t.crInst))for(var n,r=t.children.length,o=[];r--;)o=t.children[r].split(":"),y((n=l[o[0]][o[1]]).element,n)}function b(e,t){var n,r={};if(e){t.children.splice(t.children.indexOf(e),1),n=e.split(":"),r=l[n[0]][n[1]],delete l[n[0]][n[1]];for(var o=r.destroyers.length;o--;)r.destroyers[o]();for(var i in r.instance.onDestroy&&r.instance.onDestroy(),r.template.blick.destroyInstance(r.models),r.models)r.models[i].model.destroy();r.controller.destroy();for(o=r.children.length;o--;)b(r.children[o],r)}}function x(e,t,n,r){var o,i,l=e.template,s=l.childQuery||[],u=l.childComponents,p=!1,d="",f=[],h="",v=0,g=0,m=null===l.blick.partials["@content"];if(n||u.length&&t.firstElementChild){if("string"!=typeof s){for(v=u.length;v--;)s.push(u[v]);l.childQuery=s.join(",")}if(f=[].slice.call(c((n||l.childQuery)+", [cr-lazy]",t)),m)for(v=f.length;v--;)for(f[v]["cr-id"]&&f.splice(v,1),g=v;g--;)f[g].contains(f[v])&&f.splice(v,1);for(v=0,i=f.length;v<i;v++)e.instance.onBeforeChildInit&&e.instance.onBeforeChildInit(f[v]),h=f[v].tagName.toLowerCase(),p=f[v].hasAttribute("cr-lazy"),d=p&&f[v].getAttribute("cr-lazy")||h,!e.crInst.options.debug&&p&&f[v].removeAttribute("cr-lazy"),!p||a[h]?(o=a[h].init(f[v],null,e.instance,r),e.instance.onChildInit&&e.instance.onChildInit(o.element,o.instance,h)):function(e,t,n){require([require.lazyPackages[d]||d],function(o){var i=o.init(t,null,e.instance,r);return e.instance.onChildInit&&e.instance.onChildInit(i.element,i.instance,n),o})}(e,f[v],h)}}function _(e,t,n){t.parent?k(n,e.parentNode):n.inst[n.name]=n.inst[n.name]}function k(e,t,n){for(var r=e.childNodes,o=e.collector.updaters[t["cr-id"]][r]||[],i=o.length;i--;)o[i](t[r],n,t)}function N(e,t,n,r){r||(e["cr-id"]=t["cr-id"],n&&e.setAttribute("cr-id",t["cr-id"]))}function C(e,t,n,r,o,i){var a=r.renderArgs?E(r.renderArgs).parent:r,s=(a["__cr-id"]||a._onChange._options.instId).split(":"),u=l[s[0]][s[1]],p=u.models,f=n&&n["cr-id"],h=p[f&&f.split(":")[0]||d(p)[0]].model,v=h._onChange._options.children,g=t.children,m=0;if(!0===i)return function(e,t){for(var n=e.childNodes,r=c(t.template.childQuery,e),o=n.length;o--;)e.removeChild(n[o]);for(var o=r.length;o--;)b(r[o]["cr-id"],t)}(t,u),function(e){return e[v]||[]};if(g.length){if(f)for(m=g.length;m--;)N(g[m],n,e.options.debugMode,g[m]["cr-id"]);if(x(u,t),P(u,h,t),o)for(m=g.length;m--;)delete g[m]["cr-id"]}}function A(e,t,n){var r=e.renderArgs?E(e.renderArgs):e,o=r.parent,i=function(e){return e.parent["__cr-id"]||e._onChange&&e._onChange._options.instId||e.loop&&e.loop["@root"]["__cr-id"]||e.value&&e.value._onChange&&e.value._onChange._options.instId||e.parent["@root"]&&e.parent["@root"]["__cr-id"]||""}(r),a=(r.parent["cr-id"]||r.parent.this["cr-id"]).split(":")[0],s=i.split(":"),c=(l[s[0]][s[1]].models[a]||{}).model,u=o&&(Object.getOwnPropertyDescriptor(o,t)||{}).set?1:0;return c?(!u&&n&&o&&hasOwnProperty.call(o,t)&&(c.addSubscriber(t,o),u=2),u):null}function E(e){for(var t=0,n=e.length;t<n;t++){if(e[t].renderArgs)return E(e[t].renderArgs);if(e[t].parent["__cr-id"])return e[t]}}function P(t,n,r){var o=!1;if(!t.template.enableEvents)return null;r&&P(t,n),O(r||t.element,"cr-event",function(r,i,a){var l=e.findParent(a,"cr-id",t.element),s=l?l["cr-id"]:"",c=s.substring(0,s.indexOf(":")),u=n&&s&&n.getElementById(s,!0)||t.instance,p=t.models[c]&&t.models[c].model,d=p&&p._onChange&&p._onChange._options.children,f=i.split(/\s*,\s*/);o||(o=!0),t.controller.installEvent(r,{idTag:"cr-id",getElementById:n&&n.getElementById,model:u,children:d,element:a,callbacks:f},f,t.instance),!t.crInst.options.debug&&a.removeAttribute("cr-event")}),o&&t.controller.setSort()}function S(n,r,o){var i={},l=d(a).join("|"),s="<(?:"+(l?"("+l+")[^/]?|":"")+"([^ >]+)[^>]*cr-lazy)[^/]*?>";d(r.partials||{});return n.replace(new RegExp(s,"g"),function(e,t,n,r){var o=t||n||r;o&&(i[o]=!0)}),{blick:o?null:new t(e.trim(n),r),childComponents:d(i),enableEvents:!0}}function O(e,t,n,r){for(var o=e.hasAttribute&&e.hasAttribute(t)?[e]:[],i=e.childNodes.length?c("["+t+"]",e):[],a=i.length?(o.push.apply(o,i),o):o,l={},s=a.length,u="",p=[];s--;){p=(u=a[s].getAttribute(t))?u.split(/\s*;+\s*/):[],l[u]=a[s];for(var d=p.length,f=[],h="",v="";d--;)h=(f=p[d].split(/\s*:+\s*/))[0],v=f[1]||f[0],n&&n(h,v,a[s]),r&&(v?(r[h]=r[h]||{},r[h][v]=r[h][v]||[],r[h][v].push(a[s])):(r[h]=r[h]||[],r[h].push(a[s])))}return r||l}},"circular");
//# sourceMappingURL=circular.min.js.map