!function(e){"use strict";function t(){return"_module_"+(h()+h())}function n(e){return v.href=e,(-1!==e.indexOf(v.host)?v.origin:"")+v.pathname+v.search}function r(e){var t=/(?:^\!|^http[s]*:|.*\.js$)/.test(e)?"":".js",r="";return e=(f.paths[e]||e).replace(/^\!/,""),r=n((f.baseUrl||".")+"/"+e+t).replace(/^.\//,""),f.mapPath?f.mapPath(e,t,r):r}function i(e){var t={mapPath:"function",baseUrl:"string"},n=["lookaheadMap","paths","options","mapPath","baseUrl"];if(!f[n[0]])for(var r=n.length;r--;)f[n[r]]="string"===t[n[r]]?"":"function"===t[n[r]]?null:{};for(var i in e)if(-1!==n.indexOf(i))if(t[i])f[i]=e[i];else for(var o in e[i])f[i][o]=e[i][o];return f}function o(e){var t=f.lookaheadMap[e],n=f.options.minifyPrefix;if(t&&-1===(f.paths[e]||"").indexOf(n)){f(t);for(var r=0,i=t.length;r<i;r++)b[t[r]]||o(t[r])}}function s(e){for(var t=e.deps,n=!0,r=t.length;r--;)b[t[r]]&&void 0===b[t[r]].done&&(n=!1);n&&a(e)}function a(e){var t=e.parents||[];e.factory&&!e.isFile?(e.done=e.factory.apply(null,e.deps.map(function(e){return b[e].done})),delete e.factory):void 0===e.done&&delete b[e.name];for(var n=t.length;n--;)b[t[n]]&&s(b[t[n]])}function c(e){m.appendChild(e),clearTimeout(g),g=setTimeout(function(){document.head.appendChild(m)})}function l(t,n){var r=e.document.createElement("script");return r.type="text/javascript",r.async=r.defer=!n,r.charset="utf-8",r.onload=r.onreadystatechange=function(e){return function(t){var n=t.currentTarget||t.srcElement;"load"!==t.type&&"complete"!==n.readyState||(r.onload=r.onreadystatechange=null,u(e))}}(t),r.src=t.path,r}function u(e){var e=b[e.name];if(0===y.name.indexOf("_module_")){e.done=y.done,e.factory=y.factory,e.deps=y.deps;for(var t=e.deps.length,n={};t--;)(n=b[e.deps[t]].parents)[n.indexOf(y.name)]=e.name;delete b[y.name]}s(e)}function p(e,t,n){for(var i=t.length,s={},u="";i--;)u=t[i],b[u]?b[u].parents.push(e):(s=b[u]={name:u,isFile:"!"===u.charAt(0),path:r(u),parents:[e]}).isFile?f.getFile(s,a):(c(l(s,n)),o(u))}function f(e,n,r){e.constructor===Array?d(t(),e,n,r):d(t(),[],e,n)}function d(e,n,r,i){var o={};if("string"!=typeof e)return f(e,n,r);e=e||t(),o=b[e],p(e,n,i),o?(o.deps=n,o.factory=r):s(o=b[e]={name:e,deps:n,factory:r,parents:[]}),y=o}var h=e.Math.random,v=document.createElement("a"),m=e.document.createDocumentFragment(),g=0,b=f.modules={},y={};d.amd={},f.config=i,f.getFile=function(e,t){return e},e.define=d,e.require=f,i({})}(this),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("toolbox",[],function(){return t(e)}):e.Toolbox=t(e)}(this,function(e,t){"use strict";function n(e,t){var n=document.createEvent("CustomEvent");return t=t||{},n.initCustomEvent(e,t.bubbles||!1,t.cancelable||!1,t.detail),n}function r(e){var t=document.cookie.split(e+"=")[1];return t&&t.split(";")[0]}function i(e,t,n){try{if(e.readyState===XMLHttpRequest.DONE){if(!(e.status<200||e.status>299))return e["xml"===t?"responseXML":"responseText"];var r=new Error(e.statusText);r.response=e.response,n(r)}}catch(e){n("Caught Exception: "+e.stack)}}function o(e){this._state=0,this._handled=!1,this._value=t,this._deferreds=[],this._returnFn=u(e,this)}function s(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,setTimeout(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(e){return void c(t.promise,e)}a(t.promise,n)}else(1===e._state?a:c)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return u(n.bind(t),e)}e._state=1,e._value=t,l(e)}catch(t){c(e,t)}}function c(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&setTimeout(function(){e._handled||console.warn("Possible Unhandled Promise Rejection:",e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function u(e,t){var n=!1,r=function(e){n||(n=!0,c(t,e))};try{return e(function(e){n||(n=!0,a(t,e))},r)}catch(e){r(e)}}var p=document.createElement("a"),f={undefined:t,null:null,NaN:NaN,true:!0,false:!1},d={convertToType:function(e){return f.hasOwnProperty(e)?f[e]:e.toString&&+e.toString()===e?+e:e},closest:function(e,t,n){if(e.closest)d.closest=function(e,t){return e.closest(t)};else{var r=e.msMatchesSelector||e.webkitMatchesSelector||e.matches;d.closest=function(e,t){if(!(n||document.documentElement).contains(e))return null;do{if(r.call(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}}return d.closest(e,t,n)},$:function(e,t){return(t||document).querySelector(e)},$$:function(e,t){return(t||document).querySelectorAll(e)},parentsIndexOf:function(e,t){for(var n=e.length;n--;)if(e[n].contains(t))return n;return-1},keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},isArray:Array.isArray||function(e){return e&&e.constructor===Array},addClass:function(e,t){e&&e.classList.add(t)},removeClass:function(e,t){e&&e.classList.remove(t)},toggleClass:function(e,t,n){if(e){var r=e.classList.contains(t);r&&!n?e.classList.remove(t):r||!1===n||e.classList.add(t)}},hasClass:function(e,t){return e&&e.classList.contains(t)},toggleClasses:function(e,t,n,r){e&&n&&d.removeClass(e,n),t&&d.addClass(t,r||n)},addEvents:function(e,t,n,r){for(var i=[],o=e.length;o--;)i.push(d.addEvent(e[o],t,n,r));return i},removeEvents:function(e){for(var t=e.length;t--;)e[t]()},addEvent:function(e,n,r,i){return i=i!==t?i:!!/(?:focus|blur|mouseenter|mouseleave)/.test(n),e.addEventListener(n,r,i),function(){e.removeEventListener(n,r,i)}},storageHelper:{fetch:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):t},saveLazy:function(e,t,n){d.lazy(function(){d.storageHelper.save(e,t)},n||d.storageHelper)},save:function(e,t){localStorage.setItem(t,JSON.stringify(e))}},lazy:function(e,t,n){clearTimeout(t._timer),t._timer=setTimeout(e,0,n)},itemsSorter:function(e,t,n,r){var i=e[n].toUpperCase(),o=t[n].toUpperCase();return r?i<o?1:i>o?-1:0:i<o?-1:i>o?1:0},normalizePath:function(e){return p.href=e,(-1!==e.indexOf(p.host)?p.origin:"")+p.pathname+p.search},ajax:function(e,n){var o=null,s=!1,a=(new Date).getTime(),c=0;return n=n||{},e=d.normalizePath(e),c=h[e]&&h[e].time||0,s=!0===n.cache?a+1e8:n.cache?c>a?c:a+n.cache:0,o=s&&!n.resetCache&&c>a?h[e]:null,o=o||new d.Promise(function(o,s){var a=new XMLHttpRequest,c=(n.method||n.type||"GET").toUpperCase();if(a||s("Giving up :( Cannot create an XMLHTTP instance"),n||(e=(n=e).url),a.onreadystatechange=function(){var e=i(this,n.dataType,s);if(e!==t){if("json"===n.dataType)try{e=JSON.parse(e)}catch(e){return void s("Caught Exception: "+e.stack)}o(e)}},a.open(c,e,n.async||!0,n.username,n.password),"xml"===n.dataType&&a.setRequestHeader("Content-Type","text/xml"),"GET"!==c&&n.csrf&&a.setRequestHeader("X-CSRF-Token",r(n.csrf)),n.headers)for(var l in n.headers)a.setRequestHeader(l,n.headers[l]);return a.send(n.data),function(){a.abort()}}),s?(h[e]=o,h[e].time=s):delete h[e],o},errorHandler:function(e){console.error(e)},Promise:o};e.Event=e.Event||n,e.CustomEvent=e.CustomEvent||n;var h={};return o._cache={},o.prototype.catch=function(e){return this.then(null,e||function(e){console.error(e)})},o.prototype.then=function(e,t){var n=this._returnFn,r=new o(function(){return n});return s(this,{onFulfilled:e||null,onRejected:t||null,promise:r}),r},o.prototype.cancel=function(e){var t=o._cache[e];return o._cache[e]=this,t?(1!==t._state&&(t._returnFn&&"function"==typeof t._returnFn&&t._returnFn(),t._deferreds=[],t.then=t.catch=function(){},t._handled=!0,t._state=1),t._returnFn=null,this):this},o.all=function(e){var t=[];return e.reduce(function(e,n){return e.then(function(){return n}).then(function(e){return t.push(e)})},new o(function(e,t){e(null)})).then(function(){return t})},e.require&&(require.getFile=function(e,t){d.ajax(e.path,{cache:"!!"!==e.name.substr(0,2)}).then(function(n){e.done=n,t(e)})}),d}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return t(e)}):e.Schnauzer=t(e)}(this,function(e,t){"use strict";function n(e,t){var n="{{"===t[0]?["{{2,3}","}{2,3}"]:t,r=e.options.characters+"\\][";e.inlineRegExp=new RegExp("("+n[0]+")([>!&=])*\\s*([\\w\\"+r+"\\.]+)\\s*([\\w"+r+"|\\.\\s]*)"+n[1],"g"),e.sectionRegExp=new RegExp("("+n[0]+")([#^][*%]*)\\s*([\\w"+r+"]*)(?:\\s+([\\w$\\s|./"+r+"]*))*("+n[1]+")((?:(?!\\1[#^])[\\S\\s])*?)\\1\\/\\3\\5","g"),e.elseSplitter=new RegExp(n[0]+"else"+n[1])}function r(e,t){for(var n=0,r=e.length;n<r;n++)t[t.length]=e[n];return t}function i(e,n,i,o){var s=i!==t,a=!e.__schnauzerData,c=s&&!a&&e.extra||[],l=!a&&e.helpers||[];return{extra:n?r(n,c):c,path:a?[e]:s?r(e.path,[i]):e.path,helpers:o?r(l,s&&[o]||[{}]):l,__schnauzerData:!0}}function o(e,t){for(var n=0,r=t.length;n<r;n++)"./"!==t[n]&&(e=e&&e[t[n]]);return e}function s(e,n,r){return e!==t?e:r?o(n,r):n}function a(e,n,r,i){if(r){var a=e.path[i]||{},c=e.helpers[i]||{},l=s(c[n],c,r);if("this"===n||"."===n)return e.path[0];if(l===t&&(l=o(a,r)),l!==t)return l;for(var u=e.extra.length;u--;)if((l=s(e.extra[u][n],e.extra[u],r))!==t)return l}}function c(e){if(!e)return{};var t=e.split("="),n=t.length>1?t[1]:t[0],r=n.charAt(0),i='"'===r||"'"===r,o=!1,s=0,a=[],c=[],l=!1,u="%"===n.charAt(1)?2:"%"===r?1:0;return i?n=n.replace(/(?:^['"]|['"]$)/g,""):((c=(n=u?n.substr(u):n).split("../")).length>1&&(n=("@"===c[0]&&"@"||"")+c.pop(),s=c.length),a=n.split(/[\.\/]/),n=n.replace(/^(\.\/|this\.|this\/|\*)/,function(e,t){return"*"===t?(o=!0,""):(l=!0,a[0]="./","")}).replace(/(?:^\[|\]$)/g,"")),{name:t.length>1?t[0]:n,value:n,isActive:u,isString:i,isInline:o,strict:l,keys:a,depth:s}}function l(e,t){return String(e).replace(t.entityRegExp,function(e){return t.options.entityMap[e]})}function u(e,t,n,r,o,s,c,u){return e.options.tools?e.options.tools(e,a,i,t,n,r,o,s,c,u):t[E(r)||s.isInline?"apply":"call"]({getData:function(e){return(e=s.rawParts[e]||{value:e,keys:[e],depth:0}).isString?e.value:a(o,e.value,e.keys,e.depth)},escapeHtml:function(t){return l(t,e)},getBody:function(){return c&&c(o)||""},gatAltBody:function(){return u&&u(o)||""}},s.isInline?[function(){return c||""},s.parts,e]:r)}function p(e,t,n,r,i,o,a){var c=t.name;return o=s(o,""),e.options.render?u(e,e.options.render,c,{name:c,data:n,section:!!t.section,partial:!!t.partial,isActive:t.isActive,fn:r,text:i,value:o,parent:t.parent,type:t.isInline&&e.decorators[c]&&"decorator"||t.partial&&e.partials[c]&&"partial"||e.helpers[c]&&"helper"||a||""},n,t,r):i+o}function f(e,t,n,r,i){for(var o={},s={},a=[],l=0,u=t.length,p={};l<u;l++)if(""!==t[l]){if("as"===t[l]){t.splice(l,1),a=[t.splice(l,1)[l],t.splice(l,1)[l]];break}o[(p=c(t[l])).name]=p,s[t[l]]=p}return{name:n.name,vars:t,parts:o,rawParts:s,partial:">"===i,isInline:n.isInline,isUnescaped:!e.options.doEscape||"&"===i||r,isActive:n.isActive,depth:n.depth,strict:n.strict,keys:n.keys,helpers:a}}function d(e,t,n,r,i,o){var s=i?{"@index":o,"@last":o===i-1,"@first":0===o,_parent:n&&[n.name,o]}:{};return s["@key"]=t,s["."]=s.this=e,0!==r.length&&(s[r[0]]=e,s[r[1]]=t),s}function h(e,t,n,r){var i=[],o=e.options.splitter;return t=t.replace(e.inlineRegExp,function(t,n,r,s,a){var l=r&&r.charAt(0)||"";return"!"===l||"="===l?"":(a=a.split(/\s+/),"-section-"===s?(s=c(a[1]),s.section=a[0],i.push(s),o):("*"===s&&(s+=a.shift()),i.push(f(e,a,c(s),"{{{"===n,l)),o))}).split(o),r=c(r).name,function(o,s){return v(e,o,t,n,r,i,s)}}function v(e,n,r,i,s,c,l){for(var f,d="",h="",v=null,g={},b={},y=0,x=r.length;y<x;y++)if((g=c[y])!==t)if(d+=r[y],g.section)g.parent=l&&o(n.helpers,[0,"_parent"]),d=p(e,g,n,v=i[g.section],d,v(n,l),s);else if(g.isInline)d=u(e,e.decorators[g.name||g.vars[0]],g.name,g.vars,n,g,d)||d,_(d)&&(d=d());else{if(g.partial){b=n.helpers[0]||(n.helpers[0]={}),f=t;for(var C in g.parts)f=g.parts[C],b[C]=f.keys.length&&a(n,f.name,f.keys,f.depth)||f.isString&&(f.value||f.name);h=e.partials[g.name](n)}else g.parent=l&&o(n.helpers,[0,"_parent"]),h=(v=m(e,g))(n);d=p(e,g,n,v,d,h,s)}else d=s?p(e,{},n,v,d,r[y],s):d+r[y];return d}function m(e,t){return function(n,r){var i=a(n,t.name,r||t.keys,t.depth),o=!t.strict&&(e.helpers[t.name]||e.partials[t.name])||_(i)&&i;return i=o?u(e,o,t.name,t.vars,n,t):i&&(t.isUnescaped?i:l(i,e))}}function g(e,t,n,r,i,o){var s=n;return n=c(!r.length||"if"!==n&&"each"!==n&&"with"!==n&&"unless"!==n?n:r.shift()),r=f(e,r,c(n.name),i,""),function(i,a){return b(e,i,t,n,r,o,s,a)}}function b(e,n,r,o,s,c,l,p){var f=a(n,o.name,E(p)?p:o.keys,o.depth),h=!o.strict&&(e.helpers[o.name]||_(f)&&f),v=h&&u(e,h,o.name,s.vars,n,s,r[0],r[1]),m=E(f),g="each"===l&&!m&&"object"==typeof f&&f,b="";if(f=f===t?E(n.path[0])&&n.path[0]:f,h){if(n.helpers[0]=d(v,o.name,t,s.helpers),"if"===l)return v?r[0](n):r[1]&&r[1](n);if("unless"===l)return v?r[1]&&r[1](n):r[0](n);m=E(f=v)}if("unless"===l?f=!f:g&&(f=N(f,[])),m||g){if(c)return f.length?"":r[0](f);n.path.unshift({}),n.helpers.unshift({});for(var y=0,x=f.length;y<x;y++)n.path[0]=m?f[y]:g[f[y]],n.helpers[0]=d(n.path[0],m?y:f[y],o,s.helpers,x,y),b+=r[0](n,f[y]);return n.path.shift(),n.helpers.shift(),b}return c&&!f||!c&&f?h&&"string"==typeof f?f:r[0]("unless"===l||"if"===l?n:i(n,t,f,d(f,o.name,t,s.helpers))):r[1]&&r[1](n)}function y(e,t,n){for(var r="",o=e.options.tags;r!==t&&(r=t);)t=t.replace(e.sectionRegExp,function(t,r,i,s,a,c,l){if("#*"===i){var u=a.replace(/(?:^['"]|['"]$)/g,"");return e.partials[u]=e.partials[u]||y(e,l,n),""}return l=l.split(e.elseSplitter),n.push(g(e,[h(e,l[0],n,s),l[1]&&h(e,l[1],n,s)],s,a&&a.replace(/[(|)]/g,"").split(/\s+/)||[],"{{{"===r,"^"===i)),o[0]+"-section- "+(n.length-1)+" "+(a||s)+o[1]});return t=h(e,t,n),function(e,n){return t(i(e,n&&(E(n)&&n||[n])))}}var x=function(e,n){this.version="1.3.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{},decorators:{},partials:{},recursion:"self",characters:'$"<>%-=@',splitter:"|##|",tools:t,render:t},C(this,n||{},e)},C=function(e,t,r){for(var i in t)e.options[i]=t[i];t=e.options,e.entityRegExp=new RegExp("["+N(t.entityMap,[]).join("")+"]","g"),n(e,t.tags),e.helpers=t.helpers,e.decorators=t.decorators,e.partials={};for(var o in t.partials)e.registerPartial(o,t.partials[o]);r&&e.registerPartial(t.recursion,r)},E=Array.isArray||function(e){return e&&e.constructor===Array},_=function(e){return e&&"function"==typeof e},N=Object.keys||function(e,t){for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return x.prototype={render:function(e,t){return this.partials[this.options.recursion](e,t)},parse:function(e){return this.registerPartial(this.options.recursion,e)},registerHelper:function(e,t){this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerDecorator:function(e,t){this.decorators[e]=t},unregisterDecorator:function(e,t){delete this.decorators[e]},registerPartial:function(e,t){return this.partials[e]=this.partials[e]||"function"==typeof t?t:y(this,t,[])},unregisterPartial:function(e){delete this.partials[e]},setTags:function(e){n(this,e)}},x}),function(e,t){"object"==typeof exports?module.exports=t(e,require("schnauzer")):"function"==typeof define&&define.amd?define("blick",["schnauzer"],function(n){return t(e,n)}):e.Blick=t(e,e.Schnauzer)}(this,function(e,t,n){"use strict";function r(e,t){for(var n in e)e[n]=document.createElement(e[n]);r=function(n){var r=((n||"").match(t)||[])[1],i=e[r]||e._default;return i.innerHTML=n||"",i}}function i(e,t){return document.evaluate('//text()[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue||document.evaluate('//@*[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function o(e){var t=v.length;return e.fn&&e.name&&e.isActive&&!e.partial&&"@"!==e.name.charAt(0)?(e.isSection=a(e),v[t]=e,e.text+"{{#"+t+"}}"+e.value+"{{/"+t+"}}"):e.text+e.value}function s(e,t,n){return e.splitText(e.textContent.lastIndexOf(n)+n.length).textContent,e.splitText(e.textContent.indexOf(t))}function a(e,t){return e.section&&!e.type&&(-1!==e.value.indexOf("{{#")||t&&-1!==t.textContent.indexOf("{{#"))}function c(e){for(var t=!0,n={replacer:t,lastNode:t,fn:t,children:t,unregister:t,data:t},r=e.length;r--;){for(var i in e[r])n[i]||delete e[r][i];e[r]=null}return null}function l(e,t,n){for(;t.childNodes.length;)n.appendChild(t.childNodes[0]);if(!e)return n;e.parentNode.insertBefore(n,e.nextSibling)}function u(e,t,n,r){if(e&&0!==n.length)for(var i=n.length;i--;)n[i].children.push({unregister:function(e){return function(){r.unregisterProperty(e.name,e)}}(t)}),-1!==e.textContent.indexOf(n[i].search)&&(e.textContent=e.textContent.replace(n[i].search,""),n.pop());return n}function p(e,t){for(var n=0,r=0,i="";r<t.length;)e[n]!==t[r]||n===e.length?i+=t[r]:n++,r++;return i}function f(e,t,o,d,h){e.search;for(var m,g=r(o),b="",y="",x={},C={},E={},_=e.options,N=_.registerProperty,w=[],P=[],A={},O=t.length;O--;)b="{{#"+O+"}}",y="{{/"+O+"}}",x=t[O],(C=i(g,b))?C.ownerElement?(C.valueSplitter||((A=C.valueSplitter=[]).valueTracker={},A.push(C.textContent.replace(e.attrSplitter,function(e,t,n,r){return A.push(t),A.push(n),A.valueTracker[r]=A.length-1,""}))),x.replacer=function(e,t,r,i,o,s,a){return function(i,o){var c=o||s.fn(s.data,i);if(c===n&&(c=""),_.attributes[r])e=null,_.attributes[r](t,r,c);else if(c!==n){var l=e.valueSplitter.join("").trim(),u=[],f="";l!==e.textContent&&(f=e.textContent.split(l)[1]||"",u=(u=p(e.textContent,l))&&u.split(/\s+/)),e.valueSplitter[e.valueSplitter.valueTracker[a]]=c;for(var d=e.valueSplitter.join("").trim()+f,h=u.length;h--;)u[h]&&(d=d.replace(u[h],""));e.textContent=d}}}(C,C.ownerElement,C.name,0,C.textContent,x,O),N(x,C),P=u(C.ownerElement.previousSibling,x,P,_),x.replacer(null,x.value)):a(x,C)?((P=u(C,x,P,_)).push({search:b,children:x.children=[]}),E=i(C.parentNode,y),x.lastNode=E=E.splitText(E.textContent.lastIndexOf(y)),E.textContent=E.textContent.replace(y,""),(C=C.splitText(C.textContent.indexOf(b))).textContent=C.textContent.replace(b,""),x.replacer=function(t,n){return function(r){for(;n.lastNode.previousSibling&&n.lastNode.previousSibling!==t;)t.parentNode.removeChild(n.lastNode.previousSibling);if(n.children)for(var i=n.children.length;i--;)n.children[i].unregister();t.textContent="",w=f(e,v,n.fn(n.data,r),t,h),n.children=c(w);for(var o=[],s=n.lastNode;s!==t&&(s=s.previousSibling);)1===s.nodeType&&o.push(s);return o}}(C,x),N(x,C)):(C=s(C,b,y),x.replacer=function(e,t){return function(n){e.textContent=t.fn(t.data,n)}}(C,x),C.textContent=x.value,N(x,C),P=u(C,x,P,_)):window.console&&console.warn("There might be an error in the SCHNAUZER template");return m=l(d,g,h),d||(t=c(t)),v=[],d?t:m}r({option:"select",legend:"fieldset",area:"map",param:"object",thead:"table",tr:"tbody",col:"colgroup",td:"tr",_default:"div"},/<\s*(\w*)\s*[\s\S]*?>/);var d=function(e,t){this.version="0.0.1",this.options={registerProperty:m,unregisterProperty:m,attributes:{value:b,disabled:g,checked:g,autocomplete:g,contenteditable:g,readonly:g,required:g,selected:g}},h(this,t||{},e)},h=function(e,n,r){for(var i in n)if("attributes"===i)for(var s in n[i])e.options[i][s]=n[i][s];else e.options[i]=n[i];var a=e.options.registerProperty;e.options.registerProperty=function(t,n){a(t.name,t.replacer,t.data.path[0],t.isActive,t.parent,n,e.collector)},n.render=o,e.search=/{{#\d+}}[\S\s]*{{\/\d+}}/,e.attrSplitter=/([^}{]*)({{#(\d+)}}[\s\S]*?{{\/\d+}})/g,e.schnauzer=new t(r,n),e.collector={}},v=[],m=function(){},g=function(e,t,n){!0===n||"true"===n||!n&&!1!==n?(e.setAttribute(t,""),e[t]=!0):(e.removeAttribute(t),e[t]=!1,"focus"===n&&e.focus())},b=function(e,t,n){e.setAttribute("value",n),e.value=n};return d.prototype={render:function(e,t){return this.schnauzer.render(e,t)},renderHTML:function(e,t){var n=document.createDocumentFragment(),r=this.schnauzer.render(e,t);return f(this,v,r,null,n)}},d}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("VOM",[],function(){return t(e)}):e.VOM=t(e)}(this,function(e,t){"use strict";function n(e,t){for(var n=0,r=t.length;n<r;n++){if("*"===t[n])return e;e=e&&e[t[n]]}return e}function r(e,t){for(var n=t.length;n--;)t[n][e.options.childNodes]&&r(e,t[n][e.options.childNodes]),delete y[e.id][t[n][e.options.idProperty]],t.pop();return t}function i(e,n){return n.__index!==t?n.__index:(n.parentNode?o(n.parentNode,e.options.childNodes):e.model).indexOf(n)}function o(e,t){return e[t]=e[t]||[],e[t]}function s(e,t,n,r,i,s){var u=e.options,p=t.parentNode;return t.parentNode?u.parentCheck&&c(t,n,u):(t.__index=r,l(e,[t],n,i,s)),e.type=i,e.sibling=s,t.parentNode===n&&r>t.index&&-1!==t.index&&r--,t=-1!==t.index&&t.parentNode&&a(e,t,!0)||t,o(n,u.childNodes).splice(r||0,0,t),t.parentNode=n,u.moveCallback.call(e,t,i,s,p),t}function a(e,t,n){return!n&&r(e,[t]),o(t.parentNode,e.options.childNodes).splice(t.index,1)[0]||t}function c(e,t,n){var r=t;for(e===t&&v("ERROR: can't move element inside itself",n);r=r.parentNode;)r===e&&v("ERROR: can't move parent inside it's own child",n)}function l(e,t,n,r,i){for(var o=e.options,s=!1,a=!0,c=o.idProperty,d={},h=0,v=t.length;h<v;h++)(d=t[h])[c]||e.standalone||(d[c]=x++,a=!1),y[e.id][d[c]]=d,s=!d.parentNode,e.standalone||(d.parentNode=n||e.model.root,d.index=d.index||0),s&&(e.standalone||(f(d,c,d[c],a),u(e,"index",{current:d},null,!0),u(e,"parentNode",{current:d},null,!0)),p(e,d,e.options.listeners)),o.preRecursionCallback.call(e,d,r,i),d[o.childNodes]&&l(e,d[o.childNodes],d),o.enrichModelCallback.call(e,d,r,i),delete d.__index;return t}function u(e,t,n,r,i){var o={};if(e.options.forceEnhance||n.current.hasOwnProperty(t))return o[t]=n.current[t],d(e,t,n,o,!i,r)}function p(e,t,r,i,o){for(var s=[],a=0,c=0,l="",f={},d=[],h=r.length;h--;)if(s=r[h],a=s.indexOf("*"),l=(i||"")+s.join("."),f=o||n(t,s),-1!==a){c=a+1;for(var v in f)c===s.length?u(e,v,{current:f,root:t},l.replace("*",v)):(d=s.slice(c),p(e,t,[s.slice(c)],l.split("*")[0]+v+".",n(f[v],d.slice(0,d.length-1))))}else f=1!==s.length?n(o||t,s.slice(0,-1)):t,u(e,s[s.length-1],{current:o||f,root:t},l);return t}function f(e,n,r,i,o){return delete e[n],Object.defineProperty(e,n,{enumerable:!!o,configurable:!1,writable:i===t||!!i,value:r})}function d(e,t,n,r,o,s){return Object.defineProperty(n.current,t,{get:function(){return"index"===t?i(e,n.current):r[t]},set:function(i){h(s||t,n,r[t],r[t]=i,r,e)},enumerable:o})}function h(e,t,n,r,i,o){(e===o.options.idProperty||"index"===e||o.options.subscribe.call(o,o.type||e,t.root||t.current,r,n,o.sibling))&&(i[e]=n,v('ERROR: Cannot set property "'+e+'" to "'+r+'"',o.options)),delete o.type,delete o.sibling}function v(n,r){if(!r.throwErrors&&e!==t&&e.console)return console.warn?console.warn(n):console.log(n);throw n}var m=function(e,t){this.options={parentCheck:!1,idProperty:"id",subscribe:function(){},enrichModelCallback:function(){},preRecursionCallback:function(){},moveCallback:function(){},listeners:[],forceEnhance:!1,childNodes:"childNodes",throwErrors:!1},this.model=e||[],g(this,t||{})},g=function(e,t){var n={},r=e.options;y.push({}),f(e,"id",y.length-1);for(var i in t)r[i]=t[i];r.listeners=[];for(var o=(t.listeners||[]).length;o--;)t.listeners[o]&&(r.listeners[o]=t.listeners[o].split(b));e.model.constructor!==Array&&(e.model=[e.model],e.standalone=!0),n[r.childNodes]=e.model,e.standalone||f(e.model,"root",n),l(e,e.model)},b=/\.|\//,y=[],x=0;return m.prototype={getElementById:function(e){return y[this.id][e]},getElementsByProperty:function(e,r){var i=[],o=t!==r,s=t!==e,a=[],c=null,l=y[this.id];for(var u in l)c=t!==l[u][e]?l[u][e]:n(l[u],a[0]?a:a=s&&e.split(b)),(o&&c===r||!o&&t!==c||!o&&!s)&&i.push(l[u]);return i},appendChild:function(e,t){return t=t||this.model.root,s(this,e,t,o(t,this.options.childNodes).length,"appendChild",t)},prependChild:function(e,t){return t=t||this.model.root,s(this,e,t,0,"prependChild",t)},insertBefore:function(e,t){return s(this,e,t.parentNode,t.index,"insertBefore",t)},insertAfter:function(e,t){return s(this,e,t.parentNode,t.index+1,"insertAfter",t)},replaceChild:function(e,t){var n=t.index,r=t.parentNode;return e!==t&&a(this,t),s(this,e,r,n,"replaceChild",t),t},removeChild:function(e){return a(this,e),this.options.subscribe.call(this,"removeChild",e),e},sortChildren:function(e,t,n){for(var r=0,i=(t=(t||this.model).sort(e)).length;r<i;r++)this.options.subscribe.call(this,"sortChildren",t[r]),n&&t[r][this.options.childNodes]&&this.sort(e,t[r][this.options.childNodes],n)},addProperty:function(e,t,n){return u(this,e.split(b)[0],{current:t,root:t},e,n)},reinforceProperty:f,getProperty:function(e,t){return n(t,e.split(b))},getCleanModel:function(e){return JSON.parse(JSON.stringify(e||this.model))},destroy:function(){return r(this,this.model)}},m.getElementById=function(e){var t=e.split(":");return y[t[0]]&&y[t[0]][t[1]]},m}),define("api",["VOM","blick","toolbox"],function(e,t,n){return function(r,i){function o(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r]&&t[r].call(e,n)}function s(e,t,r){var i=void 0!==window.onpopstate?"popstate":"hashchange";return n.addEvent(window,i,function(n){var i={};for(var s in e)(i=u(e[s],a(r)))&&o(t,e[s],i)},t.id)}function a(e){return decodeURI(e?location.hash.substr(e.length):location.pathname+location.search)}function c(e){var t=[];return e=e.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(e,n){return t.push(e.substr(1)),n?e:"([^/?]+)"}).replace(/\*/g,"([^?]*?)"),{regexp:new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$"),names:t}}function l(e){for(var t=0,n=(e=e?e.split("&"):[]).length,r={},i=[];t<n;t++)r[(i=e[t].split("="))[0]]=i[1];return r}function u(e,t){var n=e.regexp&&e.regexp.exec(t),r={};if(!n)return null;for(var i=0,o=(n=n.slice(1)).length;i<o;i++)n[i]=n[i]?i===o-1?n[i]:decodeURIComponent(n[i]):null,e.names[i]&&(r[e.names[i]]=n[i]);return n.parameters=r,n.queries=l(n[o-1]),n.path=t.replace(/^\//,"").split("/"),n}function p(e,t,n){if(n)return n(function(){t.children[0]&&t.removeChild(t.children[0])},function(){t.appendChild(e)});t.children[0]?t.replaceChild(e,t.children[0]):t.appendChild(e)}var f={},d={},h={};h.model=function(t,n){return new e(t,n)},h.sendToComponent=function(e,t){var n=this.getComponent(e);if(n&&n.onSend)return n.onSend(t)},h.triggerEvent=function(e,t,n){var r={},i=n||{};i.detail=t,r=new CustomEvent(e,i),(i.element||window).dispatchEvent(r,t)},h.installEvent=function(e,t,r,i){return n.addEvent(e||window,t,r,i)},h.subscribeToComponent=function(e,t,n,r){var i=this,o=this.getComponent(e),s=o&&o["__cr-id"];return o?(this.subscribe(this.id,s,t,n,r),function(){i.unsubscribe(i.id,s,t,n)}):function(){}},h.destroyComponents=function(e){var t=this;e.forEach(function(e){t.destroyComponent(e)})},h.subscribe=function(e,t,n,r,i){var o=this;if(e=e?e.name||e.components&&e.components[t]||e:this.name,f[e]=f[e]||{},(t=f[e][t]=f[e][t]||{})[n]=t[n]||[],r&&(t[n].push(r.callback||r),r.regexp&&!t[n].regexp&&(t[n].regexp=r.regexp,t[n].names=r.names)),n&&t[n])return i&&void 0!==t[n].value&&(r.callback||r).call(this,t[n].value),function(){o.unsubscribe(e,t,n,r)};delete f[e]},h.publish=function(e,t,n,r){e="string"==typeof e?e:this.name,f[e]=f[e]||{},f[e]&&((t=f[e][t]=f[e][t]||{})[n]=t[n]||[],t[n].value=r,t[n][0]&&o(this,t[n],r))},h.unsubscribe=function(e,t,n,r){var i=-1,o={};return e="string"==typeof e?e:e.name||this.name,f[e]&&f[e][t]&&f[e][t][n]&&-1!==(i=(o=f[e][t][n]).indexOf(r.callback||r))&&o.splice(i,1),r.callback||r},h.addRoute=function(e,t,n){var r=this,i="object"==typeof e.path?{regexp:e.path}:c(e.path),o=n||this.options.hash,l=u(i,a(o)),p=f[this.name]&&f[this.name].__router,d={};return this.subscribe(null,"__router",e.path,{callback:e.callback,names:i.names,regexp:i.regexp||i},t),t&&l&&e.callback.call(this,l),d=!p&&s(f[this.name].__router,this,o),function(){r.removedRoute(e),!p&&d()}},h.removedRoute=function(e){return this.unsubscribe(null,"__router",e.path,e.callback)},h.toggleRoute=function(e,t){var n=f[this.name].__router,r=n[e.path].paused||n[e.path];n[e.path]=t?r:[],n[e.path].paused=t?null:r},h.template=function(e,n){(n=n||{}).helpers=n.helpers||this.options.helpers;var r=new t(e,n);if(n.share)for(var i in r.schnauzer.partials)this.options.partials[i]||"self"===i||(this.options.partials[i]=r.schnauzer.partials[i]);return r},h.renderModule=function(e){var t=e.selector&&e.container,r=t&&"string"==typeof e.container?n.$(e.container):e.container,i={},o=d[e.context+e.selector],s=this;if(t)return o?new n.Promise(function(t){p(o.element,r,e.transition),o.instance&&o.instance.onLoad&&o.instance.onLoad(o.element,s),t(o)}):(i=document.createElement(e.selector),e.input&&i.setAttribute("cr-input",e.input),e.event&&i.setAttribute("cr-event",e.event),e.name&&i.setAttribute("cr-name",e.name),r.appendChild(i),new n.Promise(function(t){require([e.path||e.selector],function(n){var o=!n.instance&&n.init(i,null,e.data),a=n.instance||o;p(i,r,e.transition),a&&a.onLoad&&a.onLoad(i,s),t(d[e.context+e.selector]=n.instance?n:{element:i,instance:o})})}))},Object.defineProperties(i,{Toolbox:{value:n},instance:{value:new i}});for(var v in h)r[v]={value:h[v]};return r}}),define("controller",["toolbox","VOM"],function(e,t){"use strict";function n(e){this.options={element:document.body},this.events={};for(var t in e)this.options[t]=e[t]}function r(e,t,n,r,i,o){if(!e[r])return console.warn('No event handler "'+r+'" on instance:',e);t[i.type][r].forEach(function(t){!o._&&t.contains(i.target)&&(o._=!1===e[r](i,t,n),o._&&i.stopPropagation())})}function i(t,n,i,s,a){var c=e.closest(t.target,"[cr-event]"),l=a(c&&c.getAttribute("cr-id")||e.closest(t.target,"[cr-id]").getAttribute("cr-id")),u=l&&l.events&&o(l.events[t.type]),p=i&&o(i.events[t.type])||[],f=u&&u.length,d=f?l&&l.events:i&&i.events,h={_:!1};(f?u:i&&p||[]).forEach(function(e){r(n,d,l||i,e,t,h)}),c!==s&&f&&p.forEach(function(e){r(n,i.events,i,e,t,h)})}var o=e.keys;return n.prototype={installEvent:function(n,r,o,s){var a=this.options.element;this.events[o]||(this.events[o]=e.addEvent(r,o,function(e){i(e,n,s,a,t.getElementById)},!!/(?:focus|blur|mouseenter|mouseleave)/.test(o)))},installEvents:function(e,t,n,r){var i=this;o(n).forEach(function(n){i.installEvent(e,t,n,r)})},removeEvent:function(e){this.events[e]&&(this.events[e](),delete this.events[e])},removeEvents:function(e){e.forEach(this.removeEvent.bind(this))},destroy:function(){this.removeEvents(o(this.events)),this.options.element=null}},n}),define("circular",["toolbox","blick","VOM","api","controller"],function(e,t,n,r,i){"use strict";function o(e,t){this.options={hash:"#",partials:{},helpers:{},decorators:{}},s(this,e,t||{})}function s(e,t,n){var r="string"==typeof t;r||(n=t||{});for(var i in n)e.options[i]=n[i];e.version="1.0.0",e.id="cr_"+L++,e.name=r?t:e.id,F[e.id]={}}function a(e,t,n,r,s){var a=t.selector,l=H[a],u={},p="",f={},d={},m=t.circular||o.instance,g={},b=[],y=l.templates,x=e.getAttribute("cr-id"),C=e.getAttribute("cr-name");return x&&!r?F[m.id+":"+x]:(["partials","helpers","decorators","attributes"].forEach(function(e){t[e]||(t[e]=m.options[e])}),u={"cr-id":!r&&(e.setAttribute("cr-id",m.id+":"+L),L)||L,elements:{element:e},events:{},parentNode:{},views:{}},p=u["cr-id"],d=F[m.id][p]={instance:{},controller:{},models:[],parent:"",subscribers:[]},C&&(F[m.id][C]=F[m.id][p]),f=d.instance=c(n,e,m,L++,r,t,d,s),Object.defineProperty(f,"__cr-id",{value:m.id+":"+p}),g=d.controller=new i({element:e}),b=$(y).concat($(t.subscribe$)),d.models=b.filter(function(e,t){return b.indexOf(e)===t}).sort(function(e){return"this"===e?-1:0}).map(function(n){if(n)return v({instance:f,items:u,defData:t,template:!r&&y[n]&&y[n].template,childTemplate:!r&&y[n]&&y[n].child,templateContainer:!r&&y[n]?h(e,y[n].container+""):e,modelName:n,listeners:t.subscribe$&&t.subscribe$[n],crInstance:m,controller:g})}),e.removeAttribute("cr-cloak"),f.onInit&&f.onInit(e,m,u),f)}function c(e,t,n,r,i,o,s,a){var c=u(i||t.getAttribute("cr-input"),s.parent=a)||{},p=a&&a["__cr-id"].split(":")[1];return t.removeAttribute("cr-input"),new e(t,n,function(e,t){for(var s in c.vars)"null"!==s&&(e[s]=c.vars[s]);if(!1!==t)for(var s in c.origin)c.static[s]||"null"===s||F[n.id][r].subscribers.push(function(t,r){return n.subscribeToComponent(p,r,function(n){e[t[r]]=n},!0)}(c.names,s));i&&l(a,e,o)},function(){return a})}function l(e,t,n){var r=n.events||{};for(var i in r)e["pl-"+r[i]]||function(n){Object.defineProperty(e,"pl-"+n,{value:function(e,r,i){return t[n](e,r,i)}})}(r[i])}function u(e,t){for(var n=e&&e.split(/\s*,\s*/)||[],r=[],i={vars:{},origin:{},names:{},static:{}},o=!1,s="",a="",c=n.length;c--;)a=(s=(o="'"===(r=n[c].split(/\s+as\s+/))[0].charAt(0))?r[0].replace(/'/g,""):"")||r[0],i.vars[r[1]||a]=s||t[a],i.origin[a]=s||t[a],i.names[a]=r[1]||a,i.static[a]=o;return i}function p(e){var t=e.closest('[cr-id|="cr_"]'),n=t&&t.getAttribute("cr-id").substr(3).split(":"),r=n&&F["cr_"+n[0]][n[1]];return r&&r.instance||r}function f(e,t){var n=e.getAttribute("cr-event"),r=n?[n]:[];for(var i in t.events)r.push(i+": pl-"+t.events[i]);e.setAttribute("cr-event",r.join("; "))}function d(e,t,n,r){for(var i=-1!==(n.getAttribute("cr-plugin")||"").indexOf(e),o=[].slice.call(D('[cr-plugin*="'+e+'"]',n)),s=i?[n].concat(o):o,a=0,c=s.length;a<c;a++)H[e].init(s[a],t[a],r),s[a].removeAttribute("cr-plugin")}function h(e,t){var n=t&&e.querySelector('script[data-idx="'+t+'"]'),r=n&&n.parentNode;return n&&r.removeChild(n),r||e}function v(e){var t=b(e);if("this"===e.modelName||!I(e.instance[e.modelName]))return t;for(var r in n.prototype)Object.defineProperty(t.model,r,{value:t[r].bind(t)});return Object.defineProperty(e.instance,e.modelName,{get:function(){return t.model},set:function(e){m(t,t.model,e,e.isDelta)}}),t}function m(e,t,n,r){for(var i=0,o=n.length;i<o;i++)t[i]?g(e,t[i],n[i]):e.appendChild(n[i],t.parentNode||t[0]&&t[0].parentNode);if(!r)for(;t.length>n.length;)e.removeChild(t[t.length-1])}function g(e,t,n){for(var r in n)"childNodes"!==r&&(t[r]=n[r]);n.childNodes&&m(e,t.childNodes,n.childNodes)}function b(e){var t=e.instance,r=e.modelName,i=r+"$",o=r+"$$",s=r+"$PR";return new n("this"===r?t:t[r]||[],{idProperty:"cr-id",moveCallback:t[r+"$Move"]||function(){},enrichModelCallback:t[r+"$Enrich"]||function(){},listeners:e.listeners,preRecursionCallback:function(n,r,i){var o=e.template&&x(this,{item:n,type:r,siblPar:i,data:e});t[s]&&t[s](this,n,o)},subscribe:function(r,s,a,c,l){var u="childNodes"===r||!!n.prototype[r];e.template&&E(this,r,s,a,c,l,e),t[i]&&!u&&t[i](r,s,a,c),t[o]&&t[o](r,s,a,c,u),!u&&e.crInstance.publish(e.crInstance.id,t["__cr-id"],r,a)}})}function y(e){var t=e.parentNode,n=e.index,r=t&&t.childNodes.length-1===e.index,i=0===n;return t?{"@last":r,"@first":i,"@index":n,"@counter":n+1}:{}}function x(e,t){var n=t.item,r=t.data,i=r.items.elements.element,o=r.templateContainer,s=e.reinforceProperty,a=!n.childNodes&&!!r.childTemplate,c=a?r.childTemplate:r.template,l=(r.defData.extraModel||[]).concat(y(n)),u=c&&c.renderHTML(n,l),p=n.parentNode&&n.parentNode.elements,f=p&&p.container||o,d=a?f.lastElementChild:f,h=t.siblPar&&t.siblPar.elements&&t.siblPar.elements.element,v=void 0!==n.__index&&!n.childNodes,m=u?v?u.children[0]:w(u.children[0],t.type,d,h,!0):o,g=a?d:m.hasAttribute("cr-mount")?m:M("[cr-mount]",m);return m.hasAttribute("cr-id")||m.setAttribute("cr-id",e.id+":"+(n["cr-id"]||0)),o!==i?(s(n,"elements",{element:m,container:g}),s(n,"views",j(m,function(e){})),s(n,"events",k(m,"cr-event",function(e){r.controller.installEvent(r.instance,i,e)}))):(r.items.views=j(m,function(e){}),r.items.events=k(i,"cr-event",function(e){r.controller.installEvent(r.instance,i,e,r.items)})),C(m,r.defData,r.modelName,a,r.instance),m}function C(e,t,n,r,i){var o=t.components,s=t.plugins,a="this"===n,c=!a&&!r,l=a?"main":c?"loop":r?"child":"",u=[];for(var p in o)l&&o[p][l][n]&&[].slice.call(D(p,e)).forEach(function(e){u.push(H[p].init(e,null,i))});for(var p in s)l&&s[p][l]&&s[p][l][n]&&d(p,s[p][l][n],e,i);return u}function E(e,t,r,i,o,s,a){var c=r.elements&&r.elements.element,l=r.parentNode&&r.parentNode.elements||null,u=l?l.container||l.element:a.templateContainer,p=r["cr-id"],f=!r.childNodes&&a.childTemplate||a.template||null,d=f?f.collector:{},h="childNodes"===t||!!n.prototype[t];"removeChild"===t?(w(c,t,c.parentElement),_(d,p)):"sortChildren"===t?w(c,"appendChild",u):e[t]&&(r===s?x(e,{item:r,type:t,siblPar:s,data:a}):"replaceChild"!==t&&c&&h&&w(c,t,u,s.elements&&s.elements.element)),N(a,r,d,p,t,i,o);for(var v in a.defData.helpers)N(a,r,d,p,v,i,o)}function _(e,t,n){if(e[t]){for(var r in e[t])delete e[t][r];n||delete e[t]}}function N(e,t,n,r,i,o,s){var a=n[r]&&n[r][i],c={},l={};if(a)for(var u,p=a.length;p--;)if(c=a[p],l=c.components,o!==s||c.forceUpdate){if(u=c.fn(c.parent),e.controller&&u)for(var f=u.length;f--;)k(u[f],"cr-event",function(n,r){var i=(t.events||e.items.events)[n];i||(i=t.events[n]={},e.controller.installEvent(e.instance,e.instance.element,n)),i[r]?(i[r].filter(function(t,n){e.items.elements.element.contains(t)||i[r].splice(n,1)}),i[r].push(u[f])):i[r]=[u[f]]});if(l&&(e.crInstance.destroyComponents(l),c.components=null),u&&u.length)for(var d=0,h=u.length;d<h;d++)c.components=C(u[d].parentNode,e.defData,e.modelName,!1,e.instance)}}function w(e,t,n,r,i){return"prependChild"===t?(t="insertBefore",r=n.children[0]):"insertAfter"===t&&(r.nextElementSibling?(t="insertBefore",r=r.nextElementSibling):t=""),n[t||"appendChild"](e,r),e}function P(e,t){if(t.styles){var n=document.createElement("style");return n.setAttribute("name",e),n.innerHTML="\n"+t.styles+"\n",document.head.appendChild(n),n}}function A(e,t,n,r){for(var i=e.join("|.//"),o=(i?".//"+i+"|":"")+".//*[@cr-component]",s=e.length?document.evaluate(o,n||document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null):[],a=s.snapshotLength,c={};a--;)c=s.snapshotItem(a),t.push(c),r&&r(c,c.tagName.toLowerCase());return t}function O(e,t,n,r,i,o,s){var a=i&&n[i[0]]&&!Object.getOwnPropertyDescriptor(n[i[0]],"0").get,c=i?i.slice(0):i,l=s[n["cr-id"]]=s[n["cr-id"]]||{},u="";i&&a&&c.push(e),l[u=c&&c.join(".")||e]=l[u]||[],l[u].push({fn:t,forceUpdate:2===r,parent:i&&("this"!==e&&"."!==e?i.concat(e.split(".")):i)})}function S(e,n,r,i){return e?(e.parentNode&&e.parentNode.removeChild(e),e.removeAttribute("cr-for"),e.removeAttribute("cr-child"),k(e,"cr-plugin",function(e,t,o){H[e]&&H[e].preparePlugin(o,n,{where:r,modelName:i,value:t||"null"})}),A($(H),[],e,function(e,t){(n.components[t]=n.components[t]||{main:{},loop:{},child:{}})[r][i]=!0}),new t(e.outerHTML.replace(/(?:{{&gt;|cr-src=)/g,function(e){return"{"===e.charAt(0)?"{{>":"src="}),{helpers:n.helpers||{},decorators:n.decorators,partials:n.partials,attributes:n.attributes,registerProperty:O})):null}function T(e,t){e.innerHTML=t.template;var n={};return e.querySelectorAll("[cr-for]").forEach(function(e,r){var i=M("[cr-child]",e),o=e.getAttribute("cr-for");n[o]={container:r,child:i?S(i,t,"child",o):null,template:S(R(e,r),t,"loop",o)}}),n.this={template:S(e.firstElementChild,t,"main","this")},n}function R(e,t){var n=document.createElement("script");return n.setAttribute("type","placeholder/tmpl"),n.setAttribute("data-idx",t),e.parentNode.replaceChild(n,e)}function k(e,t,n){for(var r={},i=[e].concat([].slice.call(D("["+t+"]",e))),o=i.length,s="",a=[];o--;)for(var c=(a=(s=i[o].getAttribute(t))?s.split(/\s*;+\s*/):[]).length,l=[],u="",p="";c--;)u=(l=a[c].split(/\s*:+\s*/))[0],(p=l[1])?(r[u]=r[u]||{},r[u][p]=r[u][p]||[],r[u][p].push(i[o])):(r[u]=r[u]||[],r[u].push(i[o])),n&&n(u,p,i[o]);return r}function j(e,t){for(var n=(e.hasAttribute("cr-view")?[e]:[]).concat([].slice.call(D("[cr-view]",e))),r={},i=n.length;i--;)r[n[i].getAttribute("cr-view")]=n[i],t&&t(n[i]);return r}var M=e.$,D=e.$$,I=e.isArray,$=e.keys,L=0,H={},F={},q=document.createElement("div");return Object.defineProperties(o.prototype,r({getComponent:{value:function(e){var t=F[this.id][e];return t&&t.instance}},destroyComponent:{value:function(e){var t=e["__cr-id"].split(":"),n=F[t[0]][t[1]],r=n.instance;r.onDestroy&&r.onDestroy();for(var i in r)r[i]&&r.hasOwnProperty(i)&&I(r[i])&&(r[i]=[]);n.controller.removeEvents($(n.controller.events)),n.models.forEach(function(e){e.destroy()}),n.subscribers.forEach(function(e){e()});for(var i in n)n[i]=null;delete F[t[0]][t[1]]}},destroy:{value:function(){var e=F[this.id];this.destroyComponents($(e).map(function(t){return e[t].instance}))}}},o)),Object.defineProperties(o,{Module:{value:function(e,t){var n=M(e.selector,e.context),r=o.Component(e,t);return{component:r,instance:r.init(n,null,p(n)),element:n}}},Component:{value:function(e,t){return e.plugins={},e.components={},H[e.selector]||(H[e.selector]={Klass:t,selector:e.selector,templates:T(q,e),styles:P(e.selector,e),name:e.name||t.name,init:function(n,r,i){return a("string"==typeof n?M(n):n,e,t,r,i)},preparePlugin:function(t,n,r){var i=n.plugins[e.selector]=n.plugins[e.selector]||{},o=i[r.where]=i[r.where]||{};(o[r.modelName]=o[r.modelName]||[]).push(r.value),f(t,e)}})}},Plugin:{value:function(e,t){return o.Component(e,t)}}})});
//# sourceMappingURL=circular.min.js.map