!function(e){"use strict";function t(){return"_module_"+(f()+f())}function n(e){return h.href=e,(-1!==e.indexOf(h.host)?h.origin:"")+h.pathname+h.search}function r(e){var t=/(?:^\!|^http[s]*:|.*\.js$)/.test(e)?"":".js";return e=(p.paths[e]||e).replace(/^\!/,""),n((p.baseUrl||".")+"/"+e+t).replace(/^.\//,"")}function i(e){var t=p.lookaheadMap[e],n=p.options.minifyPrefix;if(t&&-1===(p.paths[e]||"").indexOf(n)){p(t);for(var r=0,o=t.length;r<o;r++)g[t[r]]||i(t[r])}}function o(e){for(var t=e.deps,n=!0,r=t.length;r--;)g[t[r]]&&!g[t[r]].done&&(n=!1);n&&a(e)}function a(e){var t=e.parents||[];e.factory?(e.done=e.factory.apply(null,e.deps.map(function(e){return g[e].done})),delete e.factory):e.done||delete g[e.name];for(var n=t.length;n--;)g[t[n]]&&o(g[t[n]])}function s(e){m.appendChild(e),clearTimeout(v),v=setTimeout(function(){document.head.appendChild(m)})}function l(t,n){var r=e.document.createElement("script");return r.type="text/javascript",r.async=r.defer=!n,r.charset="utf-8",r.onload=r.onreadystatechange=function(e){return function(t){var n=t.currentTarget||t.srcElement;"load"!==t.type&&"complete"!==n.readyState||(r.onload=r.onreadystatechange=null,c(e))}}(t),r.src=t.path,r}function c(e){var e=g[e.name];if(0===y.name.indexOf("_module_")){e.done=y.done,e.factory=y.factory,e.deps=y.deps;for(var t=e.deps.length,n={};t--;)(n=g[e.deps[t]].parents)[n.indexOf(y.name)]=e.name;delete g[y.name]}o(e)}function u(e,t,n){for(var o=t.length,c={},u="";o--;)u=t[o],g[u]?g[u].parents.push(e):(c=g[u]={name:u,isFile:"!"===u.charAt(0),path:r(u),parents:[e]}).isFile?p.getFile(c,a):(s(l(c,n)),i(u))}function p(e,n,r){e.constructor===Array?d(t(),e,n,r):d(t(),[],e,n)}function d(e,n,r,i){var a={};if("string"!=typeof e)return p(e,n,r);e=e||t(),a=g[e],u(e,n,i),a?(a.deps=n,a.factory=r):o(a=g[e]={name:e,deps:n,factory:r,parents:[]}),y=a}var f=e.Math.random,h=document.createElement("a"),m=e.document.createDocumentFragment(),v=0,g=p.modules={},y={};d.amd={},p.config=function(e){var t=["lookaheadMap","paths","options","baseUrl|string"];if(!p[t[0]])for(var n=t.length,r=[];n--;)p[(r=t[n].split("|"))[0]]="string"===r[1]?"":{};for(var i in e)if(-1!==t.indexOf(i))for(var o in e[i])p[i][o]=e[i][o]},p.getFile=function(e,t){return e},e.define=d,e.require=p}(this),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("toolbox",[],function(){return t(e)}):e.Toolbox=t(e)}(this,function(e,t){"use strict";function n(e){var t=document.cookie.split(e+"=")[1];return t&&t.split(";")[0]}function r(e,t,n){try{if(e.readyState===XMLHttpRequest.DONE){if(!(e.status<200||e.status>299))return e["xml"===t?"responseXML":"responseText"];var r=new Error(e.statusText);r.response=e.response,n(r)}}catch(e){n("Caught Exception: "+e.stack)}}function i(e){this._state=0,this._handled=!1,this._value=t,this._deferreds=[],c(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,setTimeout(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(e){return void s(t.promise,e)}a(t.promise,n)}else(1===e._state?a:s)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void c(n.bind(t),e)}e._state=1,e._value=t,l(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&setTimeout(function(){e._handled||console.warn("Possible Unhandled Promise Rejection:",e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1,r=function(e){n||(n=!0,s(t,e))};try{e(function(e){n||(n=!0,a(t,e))},r)}catch(e){r(e)}}var u=null,p=document.createElement("a"),d={undefined:t,null:null,NaN:NaN,true:!0,false:!1},f={convertToType:function(e){return d.hasOwnProperty(e)?d[e]:e.toString&&+e.toString()===e?+e:e},closest:function(e,t,n){if(e.closest)f.closest=function(e,t){return e.closest(t)};else{var r=e.msMatchesSelector||e.webkitMatchesSelector||e.matches;f.closest=function(e,t){if(!(n||document.documentElement).contains(e))return null;do{if(r.call(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}}return f.closest(e,t,n)},$:function(e,t){return(t||document.body).querySelector(e)},$$:function(e,t){return(t||document.body).querySelectorAll(e)},parentsIndexOf:function(e,t){for(var n=e.length;n--;)if(e[n].contains(t))return n;return-1},addClass:function(e,t){e&&e.classList.add(t)},removeClass:function(e,t){e&&e.classList.remove(t)},toggleClass:function(e,t,n){if(e){var r=e.classList.contains(t);r&&!n?e.classList.remove(t):r||!1===n||e.classList.add(t)}},hasClass:function(e,t){return e&&e.classList.contains(t)},toggleClasses:function(e,t,n,r){e&&n&&f.removeClass(e,n),t&&f.addClass(t,r||n)},addEvents:function(e,t,n,r,i){for(var o=e.length;o--;)f.addEvent(e[o],t,n,r,i)},removeEvents:function(e,t,n){for(var r=t.length;r--;)f.removeEvent(e,t[r],n)},addEvent:function(e,t,n,r,i){f.addEvent.events=f.addEvent.events||[],f.addEvent.events.push({e:e,t:t,f:n,c:r,i:i||f}),e.addEventListener(t,n,r)},removeEvent:function(e,t,n){var r={},i=!1,o=0;for(o=(f.addEvent.events||[]).length;o--;)r=f.addEvent.events[o],i=!t||r.e===t&&(!n||n===r.t),r.i===(e||f)&&i&&(r.e.removeEventListener(r.t,r.f,r.c),f.addEvent.events.splice(o,1))},storageHelper:{fetch:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):t},saveLazy:function(e,t,n){f.lazy(function(){f.storageHelper.save(e,t)},n||f.storageHelper)},save:function(e,t){localStorage.setItem(t,JSON.stringify(e))}},lazy:function(e,t,n){clearTimeout(t._timer),t._timer=setTimeout(e,0,n)},itemsSorter:function(e,t,n,r){var i=e[n].toUpperCase(),o=t[n].toUpperCase();return r?i<o?1:i>o?-1:0:i<o?-1:i>o?1:0},normalizePath:function(e){return p.href=e,(-1!==e.indexOf(p.host)?p.origin:"")+p.pathname+p.search},ajax:function(e,i){var o=null,a=!1,s=(new Date).getTime(),l=0;return i=i||{},e=f.normalizePath(e),l=h[e]&&h[e].time||0,a=!0===i.cache?s+1e8:i.cache?l>s?l:s+i.cache:0,o=a&&!i.resetCache&&l>s?h[e]:null,o=o||new f.Promise(function(o,a){var s=new XMLHttpRequest,l=(i.method||i.type||"GET").toUpperCase();if(s||a("Giving up :( Cannot create an XMLHTTP instance"),i||(e=(i=e).url),s.onreadystatechange=function(){var e=r(this,i.dataType,a);if(e!==t){if("json"===i.dataType)try{e=JSON.parse(e)}catch(e){return void a("Caught Exception: "+e.stack)}o(e)}},s.open(l,e,i.async||!0,i.username,i.password),"xml"===i.dataType&&s.setRequestHeader("Content-Type","text/xml"),"GET"!==l&&i.csrf&&s.setRequestHeader("X-CSRF-Token",n(i.csrf)),i.headers)for(var c in i.headers)s.setRequestHeader(c,i.headers[c]);s.send(i.data)}),a?(h[e]=o,h[e].time=a):delete h[e],o},errorHandler:function(e){console.error(e)},Promise:i,requireResources:function(e,n,r){for(var i=[],o=null,a="",s=!1,l="",c="",p="styles"===n,d=p?"href":"src",h=p?e.styleSheets:e.scripts,m=u=u||f.captureResources();o=h.shift();)s=(a=o.getAttribute(d))&&-1!==a.indexOf("://"),l=f.normalizePath(e.path&&!s?e.path+"/"+a:""+a),a&&m[l]||(p||(c=o.text,(o=document.createElement("script")).setAttribute("type","text/javascript"),o.async=!0,a||(o.text=c)),a&&(o[d]=l,document.head.appendChild(o),m[l]=o),i.push(new f.Promise(function(e){a&&o.onload!==t?o.onload=function(){e(this)}:(!a&&(p?r:document.body).appendChild(o),e(o))})));return f.Promise.all(i)},captureResources:function(){for(var e={},t=[].slice.call(document.scripts).concat([].slice.call(f.$$("link",document))),n="",r=t.length;r--;)(n=t[r].getAttribute("src")||t[r].getAttribute("href"))&&(e[n=f.normalizePath(n)]=t[r]);return e}};e.Event=e.Event||function(e,t){var n=document.createEvent("CustomEvent");return t=t||{},n.initCustomEvent(e,t.bubbles||!1,t.cancelable||!1,t.detail),n};var h={};return i._cache={},i.prototype.catch=function(e){return this.then(null,e||function(e){console.error(e)})},i.prototype.then=function(e,t){var n=new i(function(){});return o(this,{onFulfilled:e||null,onRejected:t||null,promise:n}),n},i.prototype.cancel=function(e){var t=i._cache[e];return t&&(t._deferreds=[],t.then=t.catch=function(){},t._handled=!0),i._cache[e]=this},i.all=function(e){var t=[];return e.reduce(function(e,n){return e.then(function(){return n}).then(function(e){return t.push(e)})},new i(function(e,t){e(null)})).then(function(){return t})},e.require&&(require.getFile=function(e,t){f.ajax(e.path,{cache:"!!"!==e.name.substr(0,2)}).then(function(n){e.done=n,t(e)})}),f}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return t(e)}):e.Schnauzer=t(e)}(this,function(e,t){"use strict";function n(e,t){var n="{{"===t[0]?["{{2,3}","}{2,3}"]:t,r=e.options.characters+"\\][";e.inlineRegExp=new RegExp("("+n[0]+")([>!&=])*\\s*([\\w\\"+r+"\\.]+)\\s*([\\w"+r+"|\\.\\s]*)"+n[1],"g"),e.sectionRegExp=new RegExp("("+n[0]+")([#^][*%]*)\\s*([\\w"+r+"]*)(?:\\s+([\\w$\\s|./"+r+"]*))*("+n[1]+")((?:(?!\\1[#^])[\\S\\s])*?)\\1\\/\\3\\5","g"),e.elseSplitter=new RegExp(n[0]+"else"+n[1])}function r(e,t){for(var n=0,r=e.length;n<r;n++)t[t.length]=e[n];return t}function i(e,n,i,o){var a=i!==t,s=!e.__schnauzerData,l=a&&!s&&e.extra||[],c=!s&&e.helpers||[];return{extra:n?r(n,l):l,path:s?[e]:a?r(e.path,[i]):e.path,helpers:o?r(c,a&&[o]||[{}]):c,__schnauzerData:!0}}function o(e,t){for(var n=0,r=t.length;n<r;n++)"./"!==t[n]&&(e=e&&e[t[n]]);return e}function a(e,n,r){return e!==t?e:r?o(n,r):n}function s(e,n,r,i){if(r){var s=e.path[i]||{},l=e.helpers[i]||{},c=a(l[n],l,r);if(c===t&&(c=o(s,r)),c!==t)return c;for(var u=e.extra.length;u--;)if((c=a(e.extra[u][n],e.extra[u],r))!==t)return c}}function l(e){if(!e)return{};var t=e.split("="),n=t.length>1?t[1]:t[0],r=n.charAt(0),i='"'===r||"'"===r,o=!1,a=0,s=[],l=[],c=!1,u="%"===n.charAt(1)?2:"%"===r?1:0;return i?n=n.replace(/(?:^['"]|['"]$)/g,""):((l=(n=u?n.substr(u):n).split("../")).length>1&&(n=("@"===l[0]&&"@"||"")+l.pop(),a=l.length),s=n.split(/[\.\/]/),n=n.replace(/^(\.\/|this\.|this\/|\*)/,function(e,t){return"*"===t?(o=!0,""):(c=!0,s[0]="./","")}).replace(/(?:^\[|\]$)/g,"")),{name:t.length>1?t[0]:n,value:n,isActive:u,isString:i,isInline:o,strict:c,keys:s,depth:a}}function c(e,t){return String(e).replace(t.entityRegExp,function(e){return t.options.entityMap[e]})}function u(e,t,n,r,o,a,l,u){return e.options.tools?e.options.tools(e,s,i,t,n,r,o,a,l,u):t[E(r)||a.isInline?"apply":"call"]({getData:function(e){return(e=a.rawParts[e]||{value:e,keys:[e],depth:0}).isString?e.value:s(o,e.value,e.keys,e.depth)},escapeHtml:function(t){return c(t,e)},getBody:function(){return l&&l(o)||""},gatAltBody:function(){return u&&u(o)||""}},a.isInline?[function(){return l||""},a.parts,e]:r)}function p(e,t,n,r,i,o,s){var l=t.name;return o=a(o,""),e.options.render?u(e,e.options.render,l,{name:l,data:n,section:!!t.section,partial:!!t.partial,isActive:t.isActive,fn:r,text:i,value:o,parent:t.parent,type:t.isInline&&e.decorators[l]&&"decorator"||t.partial&&e.partials[l]&&"partial"||e.helpers[l]&&"helper"||s||""},n,t,r):i+o}function d(e,t,n,r,i){for(var o={},a={},s=[],c=0,u=t.length,p={};c<u;c++)if(""!==t[c]){if("as"===t[c]){t.splice(c,1),s=[t.splice(c,1)[c],t.splice(c,1)[c]];break}o[(p=l(t[c])).name]=p,a[t[c]]=p}return{name:n.name,vars:t,parts:o,rawParts:a,partial:">"===i,isInline:n.isInline,isUnescaped:!e.options.doEscape||"&"===i||r,isActive:n.isActive,depth:n.depth,strict:n.strict,keys:n.keys,helpers:s}}function f(e,t,n,r,i,o){var a=i?{"@index":o,"@last":o===i-1,"@first":0===o,_parent:n&&[n.name,o]}:{};return a["@key"]=t,a["."]=a.this=e,0!==r.length&&(a[r[0]]=e,a[r[1]]=t),a}function h(e,t,n,r){var i=[],o=e.options.splitter;return t=t.replace(e.inlineRegExp,function(t,n,r,a,s){var c=r&&r.charAt(0)||"";return"!"===c||"="===c?"":(s=s.split(/\s+/),"-section-"===a?(a=l(s[1]),a.section=s[0],i.push(a),o):("*"===a&&(a+=s.shift()),i.push(d(e,s,l(a),"{{{"===n,c)),o))}).split(o),r=l(r).name,function(o,a){return m(e,o,t,n,r,i,a)}}function m(e,n,r,i,a,l,c){for(var d,f="",h="",m=null,g={},y={},b=0,x=r.length;b<x;b++)if((g=l[b])!==t)if(f+=r[b],g.section)g.parent=c&&o(n.helpers,[0,"_parent"]),f=p(e,g,n,m=i[g.section],f,m(n,c),a);else if(g.isInline)f=u(e,e.decorators[g.name||g.vars[0]],g.name,g.vars,n,g,f)||f,_(f)&&(f=f());else{if(g.partial){y=n.helpers[0]||(n.helpers[0]={}),d=t;for(var C in g.parts)d=g.parts[C],y[C]=d.keys.length&&s(n,d.name,d.keys,d.depth)||d.isString&&(d.value||d.name);h=e.partials[g.name](n)}else g.parent=c&&o(n.helpers,[0,"_parent"]),h=(m=v(e,g))(n);f=p(e,g,n,m,f,h,a)}else f=a?p(e,{},n,m,f,r[b],a):f+r[b];return f}function v(e,t){return function(n,r){var i=s(n,t.name,r||t.keys,t.depth),o=!t.strict&&(e.helpers[t.name]||e.partials[t.name])||_(i)&&i;return i=o?u(e,o,t.name,t.vars,n,t):i&&(t.isUnescaped?i:c(i,e))}}function g(e,t,n,r,i,o){var a=n;return n=l(!r.length||"if"!==n&&"each"!==n&&"with"!==n&&"unless"!==n?n:r.shift()),r=d(e,r,l(n.name),i,""),function(i,s){return y(e,i,t,n,r,o,a,s)}}function y(e,n,r,o,a,l,c,p){var d=s(n,o.name,E(p)?p:o.keys,o.depth),h=!o.strict&&(e.helpers[o.name]||_(d)&&d),m=h&&u(e,h,o.name,a.vars,n,a,r[0],r[1]),v=E(d),g="each"===c&&!v&&"object"==typeof d&&d,y="";if(d=d===t?E(n.path[0])&&n.path[0]:d,h){if(n.helpers[0]=f(m,o.name,t,a.helpers),"if"===c)return m?r[0](n):r[1]&&r[1](n);if("unless"===c)return m?r[1]&&r[1](n):r[0](n);v=E(d=m)}if("unless"===c?d=!d:g&&(d=N(d,[])),v||g){if(l)return d.length?"":r[0](d);n.path.unshift({}),n.helpers.unshift({});for(var b=0,x=d.length;b<x;b++)n.path[0]=v?d[b]:g[d[b]],n.helpers[0]=f(n.path[0],v?b:d[b],o,a.helpers,x,b),y+=r[0](n,d[b]);return n.path.shift(),n.helpers.shift(),y}return l&&!d||!l&&d?h&&"string"==typeof d?d:r[0]("unless"===c||"if"===c?n:i(n,t,d,f(d,o.name,t,a.helpers))):r[1]&&r[1](n)}function b(e,t,n){for(var r="",o=e.options.tags;r!==t&&(r=t);)t=t.replace(e.sectionRegExp,function(t,r,i,a,s,l,c){if("#*"===i){var u=s.replace(/(?:^['"]|['"]$)/g,"");return e.partials[u]=e.partials[u]||b(e,c,n),""}return c=c.split(e.elseSplitter),n.push(g(e,[h(e,c[0],n,a),c[1]&&h(e,c[1],n,a)],a,s&&s.replace(/[(|)]/g,"").split(/\s+/)||[],"{{{"===r,"^"===i)),o[0]+"-section- "+(n.length-1)+" "+(s||a)+o[1]});return t=h(e,t,n),function(e,n){return t(i(e,n&&(E(n)&&n||[n])))}}var x=function(e,n){this.version="1.3.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{},decorators:{},partials:{},recursion:"self",characters:'$"<>%-=@',splitter:"|##|",tools:t,render:t},C(this,n||{},e)},C=function(e,t,r){for(var i in t)e.options[i]=t[i];t=e.options,e.entityRegExp=new RegExp("["+N(t.entityMap,[]).join("")+"]","g"),n(e,t.tags),e.helpers=t.helpers,e.decorators=t.decorators,e.partials={};for(var o in t.partials)e.registerPartial(o,t.partials[o]);r&&e.registerPartial(t.recursion,r)},E=Array.isArray||function(e){return e&&e.constructor===Array},_=function(e){return e&&"function"==typeof e},N=Object.keys||function(e,t){for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return x.prototype={render:function(e,t){return this.partials[this.options.recursion](e,t)},parse:function(e){return this.registerPartial(this.options.recursion,e)},registerHelper:function(e,t){this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerDecorator:function(e,t){this.decorators[e]=t},unregisterDecorator:function(e,t){delete this.decorators[e]},registerPartial:function(e,t){return this.partials[e]=this.partials[e]||"function"==typeof t?t:b(this,t,[])},unregisterPartial:function(e){delete this.partials[e]},setTags:function(e){n(this,e)}},x}),function(e,t){"object"==typeof exports?module.exports=t(e,require("schnauzer")):"function"==typeof define&&define.amd?define("blick",["schnauzer"],function(n){return t(e,n)}):e.Blick=t(e,e.Schnauzer)}(this,function(e,t,n){"use strict";function r(e,t){for(var n in e)e[n]=document.createElement(e[n]);r=function(n){var r=((n||"").match(t)||[])[1],i=e[r]||e._default;return i.innerHTML=n||"",i}}function i(e,t){return document.evaluate('//text()[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue||document.evaluate('//@*[contains(., "'+t+'")]',e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function o(e){var t=m.length;return e.fn&&e.name&&e.isActive&&!e.partial&&"decorator"!==e.type&&"helper"!==e.type&&"@"!==e.name.charAt(0)?(e.isSection=s(e),m[t]=e,e.text+"{{#"+t+"}}"+e.value+"{{/"+t+"}}"):e.text+e.value}function a(e,t,n){return e.splitText(e.textContent.lastIndexOf(n)+n.length).textContent,e.splitText(e.textContent.indexOf(t))}function s(e,t){return e.section&&!e.type&&(-1!==e.value.indexOf("{{#")||t&&-1!==t.textContent.indexOf("{{#"))}function l(e){for(var t=!0,n={replacer:t,lastNode:t,fn:t,children:t,unregister:t,data:t},r=e.length;r--;){for(var i in e[r])n[i]||delete e[r][i];e[r]=null}return null}function c(e,t,n){for(;t.childNodes.length;)n.appendChild(t.childNodes[0]);if(!e)return n;e.parentNode.insertBefore(n,e.nextSibling)}function u(e,t,n,r){if(e&&0!==n.length)for(var i=n.length;i--;)n[i].children.push({unregister:function(e){return function(){r.unregisterProperty(e.name,e)}}(t)}),-1!==e.textContent.indexOf(n[i].search)&&(e.textContent=e.textContent.replace(n[i].search,""),n.pop());return n}function p(e,t){for(var n=0,r=0,i="";r<t.length;)e[n]!==t[r]||n===e.length?i+=t[r]:n++,r++;return i}function d(e,t,o,f,h){e.search;for(var v,g=r(o),y="",b="",x={},C={},E={},_=e.options,N=_.registerProperty,w=[],A=[],k={},P=t.length;P--;)y="{{#"+P+"}}",b="{{/"+P+"}}",x=t[P],(C=i(g,y))?C.ownerElement?(C.valueSplitter||((k=C.valueSplitter=[]).valueTracker={},k.push(C.textContent.replace(e.attrSplitter,function(e,t,n,r){return k.push(t),k.push(n),k.valueTracker[r]=k.length-1,""}))),x.replacer=function(e,t,r,i,o,a,s){return function(i,o){var l=o||a.fn(a.data,i);if(l===n&&(l=""),_.attributes[r])e=null,_.attributes[r](t,r,l);else if(l!==n){var c=e.valueSplitter.join("").trim(),u=[],d="";c!==e.textContent&&(d=e.textContent.split(c)[1]||"",u=(u=p(e.textContent,c))&&u.split(/\s+/)),e.valueSplitter[e.valueSplitter.valueTracker[s]]=l;for(var f=e.valueSplitter.join("").trim()+d,h=u.length;h--;)u[h]&&(f=f.replace(u[h],""));e.textContent=f}}}(C,C.ownerElement,C.name,0,C.textContent,x,P),N(x,C),A=u(C.ownerElement.previousSibling,x,A,_),x.replacer(null,x.value)):s(x,C)?((A=u(C,x,A,_)).push({search:y,children:x.children=[]}),E=i(C.parentNode,b),x.lastNode=E=E.splitText(E.textContent.lastIndexOf(b)),E.textContent=E.textContent.replace(b,""),(C=C.splitText(C.textContent.indexOf(y))).textContent=C.textContent.replace(y,""),x.replacer=function(t,n){return function(r){for(;n.lastNode.previousSibling&&n.lastNode.previousSibling!==t;)t.parentNode.removeChild(n.lastNode.previousSibling);if(n.children)for(var i=n.children.length;i--;)n.children[i].unregister();t.textContent="",w=d(e,m,n.fn(n.data,r),t,h),n.children=l(w);for(var o=[],a=n.lastNode;a!==t&&(a=a.previousSibling);)1===a.nodeType&&o.push(a);return o}}(C,x),N(x,C)):(C=a(C,y,b),x.replacer=function(e,t){return function(n){e.textContent=t.fn(t.data,n)}}(C,x),C.textContent=x.value,N(x,C),A=u(C,x,A,_)):window.console&&console.warn("There might be an error in the SCHNAUZER template");return v=c(f,g,h),f||(t=l(t)),m=[],f?t:v}r({option:"select",legend:"fieldset",area:"map",param:"object",thead:"table",tr:"tbody",col:"colgroup",td:"td",_default:"div"},/<\s*(\w*)\s*[\s\S]*?>/);var f=function(e,t){this.version="0.0.1",this.options={registerProperty:v,unregisterProperty:v,attributes:{value:y,disabled:g,checked:g,autocomplete:g,contenteditable:g,readonly:g,required:g,selected:g}},h(this,t||{},e)},h=function(e,n,r){for(var i in n)if("attributes"===i)for(var a in n[i])e.options[i][a]=n[i][a];else e.options[i]=n[i];var s=e.options.registerProperty;e.options.registerProperty=function(e,t){s(e.name,e.replacer,e.data.path[0],e.isActive,e.parent,t)},n.render=o,e.search=/{{#\d+}}[\S\s]*{{\/\d+}}/,e.attrSplitter=/([^}{]*)({{#(\d+)}}[\s\S]*?{{\/\d+}})/g,e.schnauzer=new t(r,n)},m=[],v=function(){},g=function(e,t,n){!0===n||"true"===n||!n&&!1!==n?(e.setAttribute(t,""),e[t]=!0):(e.removeAttribute(t),e[t]=!1,"focus"===n&&e.focus())},y=function(e,t,n){e.setAttribute("value",n),e.value=n};return f.prototype={render:function(e,t){return this.schnauzer.render(e,t)},renderHTML:function(e,t){var n=document.createDocumentFragment(),r=this.schnauzer.render(e,t);return d(this,m,r,null,n)}},f}),function(e,t){"object"==typeof exports?module.exports=t(e):"function"==typeof define&&define.amd?define("VOM",[],function(){return t(e)}):e.VOM=t(e)}(this,function(e,t){"use strict";function n(e,t){for(var n=0,r=t.length;n<r;n++){if("*"===t[n])return e;e=e&&e[t[n]]}return e}function r(e,t){for(var n=t.length;n--;)t[n][e.options.childNodes]&&r(e,t[n][e.options.childNodes]),delete b[e.id][t[n][e.options.idProperty]],t.pop();return t}function i(e,n){return n.__index!==t?n.__index:(n.parentNode?o(n.parentNode,e.options.childNodes):e.model).indexOf(n)}function o(e,t){return e[t]=e[t]||[],e[t]}function a(e,t,n,r,i,a){var u=e.options,p=t.parentNode;return t.parentNode?u.parentCheck&&l(t,n,u):(t.__index=r,c(e,[t],n,i,a)),e.type=i,e.sibling=a,t.parentNode===n&&r>t.index&&-1!==t.index&&r--,t=-1!==t.index&&t.parentNode&&s(e,t,!0)||t,o(n,u.childNodes).splice(r||0,0,t),t.parentNode=n,u.moveCallback.call(e,t,i,a,p),t}function s(e,t,n){return!n&&r(e,[t]),o(t.parentNode,e.options.childNodes).splice(t.index,1)[0]||t}function l(e,t,n){var r=t;for(e===t&&m("ERROR: can't move element inside itself",n);r=r.parentNode;)r===e&&m("ERROR: can't move parent inside it's own child",n)}function c(e,t,n,r,i){for(var o=e.options,a=!1,s=!0,l=o.idProperty,f={},h=0,m=t.length;h<m;h++)(f=t[h])[l]||(f[l]="vom_"+x++,s=!1),b[e.id][f[l]]=f,a=!f.parentNode,f.parentNode=n||e.model.root,f.index=f.index||0,a&&(d(f,l,f[l],s),u(e,"index",{current:f},null,!0),u(e,"parentNode",{current:f},null,!0),p(e,f,e.options.listeners)),o.preRecursionCallback.call(e,f,r,i),f[o.childNodes]&&c(e,f[o.childNodes],f),o.enrichModelCallback.call(e,f,r,i),delete f.__index;return t}function u(e,t,n,r,i){var o={};if(e.options.forceEnhance||n.current.hasOwnProperty(t))return o[t]=n.current[t],f(e,t,n,o,!i,r)}function p(e,t,r,i,o){for(var a=[],s=0,l=0,c="",d={},f=[],h=r.length;h--;)if(a=r[h],s=a.indexOf("*"),c=(i||"")+a.join("."),d=o||n(t,a),-1!==s){l=s+1;for(var m in d)l===a.length?u(e,m,{current:d,root:t},c.replace("*",m)):(f=a.slice(l),p(e,t,[a.slice(l)],c.split("*")[0]+m+".",n(d[m],f.slice(0,f.length-1))))}else d=1!==a.length?n(o||t,a.slice(0,-1)):t,u(e,a[a.length-1],{current:o||d,root:t},c);return t}function d(e,t,n,r,i){return delete e[t],Object.defineProperty(e,t,{enumerable:!!i,configurable:!1,writable:!!r,value:n})}function f(e,t,n,r,o,a){return Object.defineProperty(n.current,t,{get:function(){return"index"===t?i(e,n.current):r[t]},set:function(i){h(a||t,n,r[t],r[t]=i,r,e)},enumerable:o})}function h(e,t,n,r,i,o){(e===o.options.idProperty||"index"===e||o.options.subscribe.call(o,o.type||e,t.root||t.current,r,n,o.sibling))&&(i[e]=n,m('ERROR: Cannot set property "'+e+'" to "'+r+'"',o.options)),delete o.type,delete o.sibling}function m(n,r){if(!r.throwErrors&&e!==t&&e.console)return console.warn?console.warn(n):console.log(n);throw n}var v=function(e,t){this.options={parentCheck:!1,idProperty:"id",subscribe:function(){},enrichModelCallback:function(){},preRecursionCallback:function(){},moveCallback:function(){},listeners:[],forceEnhance:!1,childNodes:"childNodes",throwErrors:!1},this.model=e||[],g(this,t||{})},g=function(e,t){var n={},r=e.options;b.push({}),d(e,"id",b.length-1);for(var i in t)r[i]=t[i];r.listeners=[];for(var o=t.listeners.length;o--;)t.listeners[o]&&(r.listeners[o]=t.listeners[o].split(y));n[r.childNodes]=e.model,d(e.model,"root",n),c(e,e.model)},y=/\.|\//,b=[],x=0;return v.prototype={getElementById:function(e){return b[this.id][e]},getElementsByProperty:function(e,r){var i=[],o=t!==r,a=t!==e,s=[],l=null;for(var c in b[this.id])l=t!==b[this.id][c][e]?b[this.id][c][e]:n(b[this.id][c],s[0]?s:s=a&&e.split(y)),(o&&l===r||!o&&t!==l||!o&&!a)&&i.push(b[this.id][c]);return i},appendChild:function(e,t){return t=t||this.model.root,a(this,e,t,o(t,this.options.childNodes).length,"appendChild",t)},prependChild:function(e,t){return t=t||this.model.root,a(this,e,t,0,"prependChild",t)},insertBefore:function(e,t){return a(this,e,t.parentNode,t.index,"insertBefore",t)},insertAfter:function(e,t){return a(this,e,t.parentNode,t.index+1,"insertAfter",t)},replaceChild:function(e,t){var n=t.index,r=t.parentNode;return e!==t&&s(this,t),a(this,e,r,n,"replaceChild",t),t},removeChild:function(e){return s(this,e),this.options.subscribe.call(this,"removeChild",e),e},sortChildren:function(e,t,n){for(var r=0,i=(t=(t||this.model).sort(e)).length;r<i;r++)this.options.subscribe.call(this,"sortChildren",t[r]),n&&t[r][this.options.childNodes]&&this.sort(e,t[r][this.options.childNodes],n)},addProperty:function(e,t,n){return u(this,e.split(y)[0],{current:t,root:t},e,n)},reinforceProperty:d,getProperty:function(e,t){return n(t,e.split(y))},getCleanModel:function(e){return JSON.parse(JSON.stringify(e||this.model))},destroy:function(){return r(this,this.model)}},v}),function(e,t){"object"==typeof exports?module.exports=t(e,require("toolbox"),require("blick"),require("VOM")):"function"==typeof define&&define.amd?define("circular",["toolbox","blick","VOM"],function(n,r,i){return t(e,n,r,i)}):e.Circular=t(e,e.Toolbox,e.Blick,e.VOM)}(this,function(e,t,n,r,i){"use strict";function o(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r]&&t[r].call(e,n)}function a(n,r,a){var l=e.onpopstate!==i?"popstate":"hashchange";t.addEvent(e,l,function(e){var t={};for(var i in n)(t=u(n[i],s(a)))&&o(r,n[i],t)},r.id)}function s(e){return decodeURI(e?location.hash.substr(e.length):location.pathname+location.search)}function l(e){var t=[];return e=e.replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(e,n){return t.push(e.substr(1)),n?e:"([^/?]+)"}).replace(/\*/g,"([^?]*?)"),{regexp:new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$"),names:t}}function c(e){for(var t=0,n=(e=e?e.split("&"):[]).length,r={},i=[];t<n;t++)r[(i=e[t].split("="))[0]]=i[1];return r}function u(e,t){var n=e.regexp&&e.regexp.exec(t),r={};if(!n)return null;for(var i=0,o=(n=n.slice(1)).length;i<o;i++)n[i]=n[i]?i===o-1?n[i]:decodeURIComponent(n[i]):null,e.names[i]&&(r[e.names[i]]=n[i]);return n.parameters=r,n.queries=c(n[o-1]),n.path=t.replace(/^\//,"").split("/"),n}function p(e){for(var t=e.container.childNodes;t[0];)(e.modulesMap||S)[e.previousName].cache.appendChild(t[0])}function d(e,n,r,i){var o=e&&e.then?e:n.data,a=n.container,s=n.previousName,l=r[s],c=n.name,u=r[c].wrap,p=function(){s&&s!==c&&l.cache.appendChild(l.wrap)},d=function(){r[c].dontWrap&&(r[c].wrap=u=r[c].wrap.children[0],delete r[c].dontWrap),a&&a.appendChild(u),i&&!1!==n.init&&e(n.data,i)};!0===n.transition?(p(),d()):n.transition({container:a,remove:p,append:d,promise:new t.Promise(function(e){o?o.then(function(t){return e(),t}):e()}),component:u,previousComponent:(l||{}).wrap})}function f(e,t,n,r,i,o){var a="prependChild"===t,s={};if(11===e.nodeType){if(s=e.children[0],n&&"parent"===n.getAttribute("cr-mount")){var l=s.children[0];s.parentNode.replaceChild(s.children[0],s),s=l}else s.hasAttribute("cr-mount")&&s.removeChild(s.children[0]);s.setAttribute(i,o)}else s=e;return s&&((a||"insertAfter"===t)&&(r=r&&r.nextSibling||a&&n.children[0],t=r?"insertBefore":"appendChild"),(n||s.parentElement)&&(n||s.parentElement)[t](s,r)),s}function h(e,t,n){for(var r=k(b(e.viewAttr),n),i="",o=(r=[n].concat([].slice.call(r))).length;o--;)(i=r[o].getAttribute(e.viewAttr))&&(t[i]=r[o])}function m(e,t,n,r,i){for(var o in e.prototype)r[o]||(i[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));return i}function v(e,t,n,r){var i=[],o=[],a={};if(n){a={};for(var s=0,l=0,c=(i=r||k("[cr-replace]",e)).length;l<c;l++)a[s=i[l].getAttribute("cr-replace")]||(i[l].parentNode.replaceChild(n[s],i[l]),a[s]=!0);(i=i.length!==n.length&&k("[cr-replace]",e)).length&&v(e,t,n,i)}else if(e&&t){for(var u={},l=0,p=(i=k(b(t),e)).length;l<p;l++)(u=document.createElement(i[l].tagName)).setAttribute("cr-replace",l),i[l].parentNode.replaceChild(u,i[l]),o.push(i[l]);return o}}function g(e,t){var n="";return"script"===e.tagName.toLowerCase()?e.innerHTML:(e.removeAttribute(t.templateAttr),n=e.outerHTML.replace(/(?:{{&gt;|cr-src=)/g,function(e){return"{"===e.charAt(0)?"{{>":"src="}),e.parentNode.removeChild(e),n)}function y(e,t,r,i){for(var o,a=r.getAttribute(e.componentAttr),s=a&&a!==i?a:i,l=r||document.body,c=e.containerAttr,u=b(e.templateAttr,s),p=r.hasAttribute(c)?r:A(b(c),r),d=p&&p.getAttribute(e.containerAttr),f=p&&(A(u,l)||A(u,document.body)),h=k(b(e.templatesAttr,s),l)||[],m={},v=h.length;v--;)o=g(h[v],e),m[h[v].id||h[v].getAttribute("name")]=new n(o,{helpers:t.helpers||e.helpers});return{element:r,template:f?g(f,e):f,templates:m,container:p,type:d?d+"Child":""}}function b(e,t){return"["+e+(t?'="'+t+'"]':"]")}function x(e,t){return e.isConnected!==i?e.isConnected||t.contains(e):t.contains(e)}function C(e,n,r,i){var o,a=(t.closest(e.target,b(n))||r.element).getAttribute(n),s="elements.element",l=r.getElementById(a)||r.getElementsByProperty(s,r.element)[0]||r.getElementsByProperty(s,e.target)[0]||r.model[0],c=l&&l.events[e.type],u={},p=!1;for(var d in c)if(o=i.options.eventListeners[d])for(var f=c[d].length;f--;)x(u=c[d][f],i.options.appElement)?p||u!==e.target&&!u.contains(e.target)||(p=!1===o.call(r,e,u,l,l.elements.element))&&e.stopPropagation():c[d].splice(f,1)}var E=function(e,t){this.options={componentAttr:"cr-component",containerAttr:"cr-container",templateAttr:"cr-template-for",templatesAttr:"cr-template",eventAttribute:"cr-event",viewAttr:"cr-view",devAttribute:"cr-dev",mountAttribute:"cr-mount",modelAttribute:"cr-model",elements:"elements",events:"events",views:"views",hash:"#",partials:{},helpers:{},decorators:{}},_(this,e,t)},_=function(e,n,r){var i="string"==typeof n;i||(r=n);for(var o in r)e.options[o]=r[o];e.version="0.1.0",e.components={},e.data={},e.id="cr_"+P++,e.Toolbox=t,e.name=i?n:e.id},N=function(e){this.options={appElement:document.body},w(this,e)},w=function(e,t){for(var n in t)e.options[n]=t[n];e.events={}},A=t.$,k=t.$$,P=0,R={},S={},T={},O=null,M={};return E.prototype.component=function(o,a){if("string"!=typeof o&&(o=(a=o).name||"component_"+P++),this.components[o])return this.components[o].reset(a.model,a.extraModel);var s=this,l={},c={},u=this.options,p=u.elements,d=u.componentAttr,g=b(d,o),x="string"==typeof a.element?A(a.element,a.wrapper||document):a.element||A(g,a.wrapper||document)||A(o,a.wrapper||document);if(x){var C=v(x,d),E=x&&x.getAttribute("name"),_=y(u,a,x,E||o),w=this.components[o]={name:o,model:a.model||[],element:_.element,container:_.container,templates:_.templates},k=a.mountSelector||b(u.mountAttribute),S=a.template,O=a.storage,L=O||{},j=t.storageHelper,D=O&&j.fetch(L.name)||{},I=L.category,q=L.listeners||a.listeners,H=L.storeAll||q&&-1!==q.indexOf("*");if(s.data[o]={extraModel:a.extraModel||u.extraModel},M[this.name]=M[this.name]||{},M[this.name][o]={},R[this.id]=R[this.id]||{},l=R[this.id][o]={},l.nestingData=C,a.onBeforeInit&&a.onBeforeInit(w),l.controller=a.eventListeners&&new N({appElement:_.element,eventAttribute:u.eventAttribute,eventListeners:a.eventListeners,instanceID:s.id}),l.collector={},l.template=S&&S.version?S:T[o]||S||_.template?new n(S||_.template,{helpers:a.helpers||u.helpers,decorators:a.decorators||u.decorators,attributes:a.attributes||u.attributes||{},partials:u.partials,registerProperty:function(e,t,n,r,i){var o=i&&n[i[0]]&&!Object.getOwnPropertyDescriptor(n[i[0]],"0").get,a=i?i.slice(0):i;i&&o&&a.push(e);var s=l.collector[n["cr-id"]]=l.collector[n["cr-id"]]||{},c=a&&a.join(".")||e;s[c]=s[c]||[],s[c].push({fn:t,forceUpdate:2===r,parent:i&&("this"!==e&&"."!==e?i.concat(e.split(".")):i)})}}):null,l.template&&(T[o]=l.template),O){var z=D[I]||D;for(var $ in w.model[0])z&&z[$]!==i&&(w.model[0][$]=z[$])}return l.template&&w.container&&(l.altContent=[].slice.call(w.container.childNodes),w.model.length&&(w.container.innerHTML="")),l.vom=new r(w.model,{idProperty:s.options.idProperty||"cr-id",moveCallback:a.moveCallback||function(){},preRecursionCallback:function(e,t,n){var r=this.options.idProperty,c=e[r],d=l.template&&l.template.schnauzer.partials.self&&l.template.renderHTML(e,s.data[o].extraModel),m="replaceChild"===t&&n[p].element,v=e.parentNode[p]&&e.parentNode[p].container,g=d&&y||v||w.container,y=g?m||i:n&&n[p]&&n[p].element,b=d&&f(d,t||_.type||"appendChild",g,y,r,c)||w.element;this.reinforceProperty(e,p,{element:b,container:b.hasAttribute("cr-mount")?b:A(k,b)},!0),this.reinforceProperty(e,u.events,{},!0),l.controller&&l.controller.getEventListeners(e[p].element||w.element,e[u.events],w,r),this.reinforceProperty(e,u.views,{},!0),h(u,e[u.views],e[p].element||w.element),a.preRecursionCallback&&a.preRecursionCallback.call(this,e,b)},enrichModelCallback:this.options.enrichModelCallback||a.enrichModelCallback||function(){},listeners:this.options.listeners||a.listeners||[],subscribe:function(e,t,n,r,i){var c=this.options.idProperty,d=t[c],m=t[p]&&t[p].element,v=t.parentNode&&t.parentNode[p]?t.parentNode[p].container||t.parentNode[p].element:w.container,g=[];if("removeChild"===e)f(m,e,m.parentElement),delete l.collector[d];else if("sortChildren"===e)f(m,"appendChild",v);else if(this[e])if(t===i){m=f(l.template.renderHTML(t,s.data[o].extraModel),e,v,i[p].element,c,t[c]),t[p].element=m,t[p].container=A(k,m);for(b=(t.childNodes||[]).length;b--;)t[p].container.appendChild(t.childNodes[b].elements.element);t[u.events]={},l.controller&&l.controller.getEventListeners(t[p].element||w.element,t[u.events],w,this.options.idProperty),t[u.views]={},h(u,t[u.views],t[p].element||w.element)}else"replaceChild"===e||this.__isNew||f(m,e,v,i[p]&&i[p].element);else O&&(H||-1!==q.indexOf(e))&&(D=j.fetch(L.name)||{},H?D[I]=w.model[0]:(D[I]=D[I]||{},D[I][e]=n),j[!1===L.saveLazy?"save":"saveLazy"](I?D:D[I],L.name,this));if(g=l.collector[d]&&l.collector[d][e])for(var y,b=g.length;b--;)if((g[b].forceUpdate||n!==r)&&(y=g[b].fn(g[b].parent),l.controller&&y))for(var x=y.length;x--;)l.controller.getEventListeners(y[x],t[u.events],w,c,!0);a.subscribe&&a.subscribe.call(this,e,t,n,r),s.publish(w,o,e,{property:e,item:t,value:n,oldValue:r})}}),v(x,null,C),c=m(r,l.vom,0,this,c),c.uncloak=function(e){var n=e&&e.element||w.element;t.removeClass(n,"cr-cloak"),n.removeAttribute("cr-cloak")},c.reset=function(e,t){if(t&&(s.data[w.name].extraModel=t),l.vom.destroy(),this.container&&(this.container.innerHTML="",!e.length&&l.altContent))for(var n=0,r=l.altContent.length;n<r;n++)this.container.appendChild(l.altContent[n]);l.vom.__isNew=!0;for(var n=0,i=e.length;n<i;n++)this.appendChild(e[n]);return l.nestingData.length&&v(x,null,l.nestingData),delete l.vom.__isNew,w},w.__proto__=c,w.uncloak(),e.setTimeout(function(){a.onInit&&a.onInit(w)}),w}},E.prototype.getBaseModel=function(e){var t=this.components[e];return t?t.model[0]:null},E.prototype.destroy=function(e){var t=R[this.id],n={};for(var r in t)if(!e||e===r)for(var i in t[r])(n=t[r][i])&&n.destroy&&n.destroy(r)},E.prototype.model=function(e,t){return new r(e,t)},E.prototype.template=function(e,t){(t=t||{}).helpers=t.helpers||this.options.helpers;var r=new n(e,t);if(t.share)for(var i in r.schnauzer.partials)this.options.partials[i]||"self"===i||(this.options.partials[i]=r.schnauzer.partials[i]);return r},E.Toolbox=t,E.extend=function(e){return function(t,n,r){var i=!1,o="",a=r?[].concat(e,r):e,s={},l={};this.extend&&!this.prototype&&(r=n,n=t,t=this),n=n||{};for(var c in t)if(s[c]=t[c]||{},"model"!==c||n.model||(s[c]=JSON.parse(JSON.stringify(t[c]))),a[c])for(var u in t[c])s[c][u]=t[c][u];for(var c in n)"extend"!==c&&(o=c,i=!1,"$"===c.charAt(0)&&(i=!0,o=c.substr(1),-1!==a.indexOf(o)&&(i=!1)),"function"==typeof(l=n[c])?s[o]=i&&s[o]?function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(s[o],l):l:l&&l.constructor===Array?s[o]=i&&s[o]&&"*"!==l.toString()?s[o].concat(l):l:-1!==a.indexOf(o)?s[o]=E.extend(s[o],l):s[o]=l);return s}}(["eventListeners","helpers","decorators","attributes","storage"]),E.prototype.subscribe=function(e,t,n,r,o){if(e=e?e.name||e.components&&e.components[t]||e:this.name,M[e]=M[e]||{},(t=M[e][t]=M[e][t]||{})[n]=t[n]||[],r&&(t[n].push(r.callback||r),r.regexp&&!t[n].regexp&&(t[n].regexp=r.regexp,t[n].names=r.names)),n&&t[n])return o&&t[n].value!==i&&(r.callback||r).call(this,t[n].value),r.callback||r;delete M[e]},E.prototype.publish=function(e,t,n,r){e="string"==typeof e?e:this.name,M[e]=M[e]||{},M[e]&&((t=M[e][t]=M[e][t]||{})[n]=t[n]||[],t[n].value=r,t[n][0]&&o(this,t[n],r))},E.prototype.unsubscribe=function(e,t,n,r){var i=-1,o={};return e="string"==typeof e?e:e.name||this.name,M[e]&&M[e][t]&&M[e][t][n]&&-1!==(i=(o=M[e][t][n]).indexOf(r.callback||r))&&o.splice(i,1),r.callback||r},E.prototype.addRoute=function(e,t,n){var r="object"==typeof e.path?{regexp:e.path}:l(e.path),i=n||this.options.hash,o=u(r,s(i)),c=M[this.name]&&M[this.name].__router;return this.subscribe(null,"__router",e.path,{callback:e.callback,names:r.names,regexp:r.regexp||r},t),t&&o&&e.callback.call(this,o),!c&&a(M[this.name].__router,this,i),e},E.prototype.removedRoute=function(e){return this.unsubscribe(null,"__router",e.path,e.callback)},E.prototype.toggleRoute=function(e,t){var n=M[this.name].__router,r=n[e.path].paused||n[e.path];n[e.path]=t?r:[],n[e.path].paused=t?null:r},E.prototype.loadResource=function(e,n){var r=this,i=function(e){return!e.hasAttribute(r.options.devAttribute)};return t.ajax(e,{cache:n}).then(function(t){return O=O||document.implementation.createHTMLDocument(""),O.documentElement.innerHTML=t,{scripts:[].slice.call(O.scripts).filter(function(e){return"text/javascript"===e.type&&i(e.parentNode.removeChild(e))}),styleSheets:[].slice.call(k("link",O)||[]).filter(i).concat([].slice.call(k("style",O)||[]).filter(i)),body:O.body,head:O.head,path:e.split("/").slice(0,-1).join("/")}}).catch()},E.prototype.insertResources=function(e,n){var r=A(b(this.options.devAttribute,"container"),n.body)||n.body;for(t.requireResources(n,"styles",e);r.childNodes[0];)e.appendChild(r.childNodes[0]);return t.requireResources(n,"scripts",e)},E.prototype.insertModule=function(e,t){var n=this;return this.loadResource(e,!0).then(function(e){return n.insertResources(t,e).then(function(){return{path:e.path,container:t}})})},E.prototype.renderModule=function(e){var n=null,r=e.container,i=e.modulesMap||S,o=e.name,a=o&&i[o],s=a&&a.init,l=e.transition,c=t.Promise;return!i[e.previousName]||l&&o||p(e),o&&a?(s=s&&!1!==e.init&&s(e.data,a.path),l?d(s,e,i):e.container.appendChild(a.cache),new c(function(t){t(e.returnData?e.data:s)})):(i[o]=a={cache:document.createDocumentFragment(),dontWrap:e.dontWrap},r||((n=document.createElement("div")).style.display="none",document.body.appendChild(n)),l&&(a.wrap=document.createElement("div"),a.wrap.setAttribute("cr-wrap",o),n?n.appendChild(a.wrap):e.data&&-1===(e.preInit||[]).indexOf(e.name)&&"*"!==(e.preInit||[])[0]||e.container.appendChild(a.wrap)),o?this.insertModule(e.path,a.wrap||e.container||n).then(function(t){return new c(function(s){var c=!0===e.require?o:!1===e.require?"":e.require;a.path=t.path,c?require([c],function(o){a.init=o,r||l?l?d(o,e,i,t.path):!1!==e.init&&o(e.data,t.path):(!1!==e.init&&o(e.data,t.path),e.container=n,p(e),n.parentElement.removeChild(n)),e.data&&e.data.then?e.data.then(function(){s(e.returnData?e.data:o)}):s(e.returnData?e.data:o)}):n&&(p(e),n.parentElement.removeChild(n),s())})}).catch():new c(function(e){e()}))},N.prototype={getEventListeners:function(e,t,n,r,o){for(var a=this.options.eventAttribute,s=e.querySelectorAll(b(a)),l="",c="",u="",p="",d=[],f={},h=e===n.element||o?[]:n.element,m=(s=[e].concat([].slice.call(s),h)).length;m--;)if(l=s[m].getAttribute(a))for(var v=(d=l.split(/\s*;+\s*/)).length;v--;){if(c=d[v].split(/\s*:+\s*/),u=c[0],p=c[1],(f=t[u]=t[u]||{})[p]===i&&(f[p]=[]),f[p].push(s[m]),o)for(var g in f)for(var y=f[g],x=0,C=y.length;x<C;x++)if(y[x]!==s[m]&&y[x].contains(s[m])){var E=f[g];delete f[g],f[g]=E}this.events[u]||(this.events[u]=!0)}this.installed&&!o||this.installEventListeners(n,r)},installEventListeners:function(e,n){var r=this;this.installed=this.installed||{};for(var i in this.events)i&&!this.installed[i]&&(t.addEvent(this.options.appElement,i,function(t){C(t,n,e,r)},!!/(?:focus|blur|mouseenter|mouseleave)/.test(i),this.options.instanceID+"_"+e.name),this.installed[i]=!0);i||(this.installed=!1)},destroy:function(e){t.removeEvent(this.options.instanceID+"_"+e.name)}},E});
//# sourceMappingURL=circular.min.js.map