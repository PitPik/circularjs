!function(a,b){"object"==typeof exports?module.exports=b(a):"function"==typeof define&&define.amd?define("toolbox",[],function(){return b(a)}):a.Toolbox=b(a)}(this,function(a,b){"use strict";var c={closest:function(a,b,c){return a&&a.closest(b)},$:function(a,b){return a.querySelector(b)},$$:function(a,b){return a.querySelectorAll(b)},addClass:function(a,b){a.classList.add(b)},removeClass:function(a,b){a.classList.remove(b)},toggleClass:function(a,b,c){var d=a.classList.contains(b);d&&!c?a.classList.remove(b):d||c===!1||a.classList.add(b)},hasClass:function(a,b){return a.classList.contains(b)},addEvents:function(a,b,d,e,f){for(var g=a.length;g--;)c.addEvent(a[g],b,d,e,f)},removeEvents:function(a,b,d){for(var e=b.length;e--;)c.removeEvent(a,b[e],d)},addEvent:function(a,b,d,e,f){c.addEvent.events=c.addEvent.events||[],c.addEvent.events.push({e:a,t:b,f:d,c:e,i:f||c}),a.addEventListener(b,d,e)},removeEvent:function(a,b,d){var e={},f=!1,g=0;for(g=(c.addEvent.events||[]).length;g--;)e=c.addEvent.events[g],f=!b||e.e===b&&(!d||d===e.t),e.i===(a||c)&&f&&(e.e.removeEventListener(e.t,e.f,e.c),c.addEvent.events.splice(g,1))},storageHelper:{fetch:function(a){return JSON.parse(localStorage.getItem(a)||"[]")},save:function(a,b){c.lazy(function(){localStorage.setItem(b,JSON.stringify(a))},c.storageHelper)}},lazy:function(a,b){clearTimeout(b.timer),b.timer=setTimeout(a,0)},itemsSorter:function(a,b,c,d){var e=a[c].toUpperCase(),f=b[c].toUpperCase();return d?e<f?1:e>f?-1:0:e<f?-1:e>f?1:0}};return c}),function(a,b){"object"==typeof exports?module.exports=b(a):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return b(a)}):a.Schnauzer=b(a)}(this,function(a,b){"use strict";function c(a,b){var c="{{"===b[0],d=c?["{{2,3}","}{2,3}"]:b;a.options.tags=d,a.variableRegExp=new RegExp("("+d[0]+")([>!&=]\\s*)*([\\w\\"+a.options.characters+"\\.\\s*]+)*"+d[1],"g"),a.sectionRegExp=new RegExp(d[0]+"(#|\\^)([\\w\\.]*)\\s*(.*?)"+d[1]+"([\\S\\s]*?)("+d[0]+")\\/\\2("+d[1]+")","g")}function d(a){return a&&a.constructor===Array}function e(a){return a&&"function"==typeof a}function f(a,b){for(var c=0,d=b.length;c<d;c++)a=a&&a[b[c]];return a}function g(a,c,d){if("string"==typeof d){var e=[],g=a[d]!==b?a[d]:f(a,e=d.split("."));if(g!==b)return g;for(var h=c.length;h--;){if(c[h][d]!==b)return c[h][d];if(g=f(c[h],e))return g}}}function h(a,b){return String(a).replace(b.entityRegExp,function(a){return b.options.entityMap[a]})}function i(a,b,c){return{getData:function(a){return g(b,c,a)},escapeHtml:function(b){return h(b,a)}}}function j(a,c){var d=[],f=a.options;return c=c.replace(a.variableRegExp,function(b,c,e,g){var h=e&&("!"===e[0]||"="===e[0]),i=!f.doEscape||"{{{"===c||e&&"&"===e[0],j=e&&">"===e[0],k=!1,l="",m={};if(h)return"";if(g=g.split(/\s+/),l=g.shift(g),j)for(var n=g.length,o=[];n--;)o=g[n].split("="),m[o[1]?o[0]:"$"+n]=(o[1]?o[1]:o[0]).replace(/"/g,"");return k=l===f.recursion,d.push(j&&(a.partials[l]||k)?[a.partials[l],m,j,i,k]:[l,g,null,i]),f.splitter}).split(f.splitter),function(j,k,l){l&&(k=[l].concat(k));for(var m,n,o=0,p=c.length,q="";o<p;o++)q+=c[o],d[o]!==b&&(n=d[o][0],d[o][2]===!0?m=(n||a.partials[f.recursion])(j,d[o][4]?null:k,d[o][1]):(m=j[n]!==b?j[n]:g(j,k,n),m=f.helpers[n]?f.helpers[n].apply(i(a,j,k),[""].concat(d[o][1])):e(m)?m.apply(i(a,j,k),[""].concat(d[o][1])):"executor"===n.name?n(j,k):m&&(d[o][3]?m:h(m,a))),m!==b&&(q+=m));return q}}function k(a,b,c,f,h){return function(j,k,l){var m=g(j,k,c);if(d(m)){if(h)return m.length?"":b(m,k);for(var n=0,o=m.length,p="";n<o;n++)p+="object"==typeof m[n]?b(m[n],[m[n]].concat(k)):b({".":m[n]},k);return p}return a.options.helpers[c]?a.options.helpers[c].apply(i(a,j,k),[b(j,k)].concat(f.split(/\s+/))):(l=j[c]||m,l&&e(l)?l.apply(i(a,j,k),[b(j,k)].concat(f.split(/\s+/))):h&&!l||!h&&l?b(j,k):void 0)}}function l(a,b){for(var c=a.options,d=[],f=[],g=[],h=-1,i=c.stopper,m=i+"\\d+"+i,n=b.replace(a.sectionRegExp,function(b,e,f,n,p,q,r){var s=q+e+f+n+r,t=p.lastIndexOf(s);return h++,t!==-1?(g.push(h--),s+p.substring(0,t)+q+e+f+i+o+i+r+p.substring(t+s.length)+q+"/"+f+i+o+++i+r):(f=f.replace(new RegExp(m),""),d.push(new RegExp(c.tags[0]+"[#^]").test(p)?k(a,l(a,p),f,n,"^"===e):k(a,j(a,p),f,n,"^"===e)),c.splitter)}).split(c.splitter),p=0,q=g.length;p<q;p++)n[g[p]]=l(a,n[g[p]]);for(var p=0,q=n.length;p<q;p++)f.push(e(n[p])?n[p]:j(a,n[p])),d[p]&&f.push(d[p]);return function(a,b,c){for(var d=0,e=f.length,g="";d<e;d++)g+=f[d](a,b||[a],c)||"";return g}}var m=function(a,b){this.version="0.1.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{},partials:{},recursion:"self",characters:'$"<>%=@',splitter:"|##|",stopper:"__"},n(this,b||{},a)},n=function(a,b,d){for(var e in b)a.options[e]=b[e];b=a.options,a.entityRegExp=function(a,b){for(var c in a)b+=c;return new RegExp("["+b+"]","g")}(b.entityMap,[]),c(a,b.tags),a.partials={};for(var f in b.partials)a.registerPartial(f,b.partials[f]);d&&a.registerPartial(b.recursion,d)},o=0;return m.prototype={render:function(a,b){return b=b&&(d(b)&&b||[b]),this.partials[this.options.recursion](a,b)},parse:function(a){this.partials[this.options.recursion]||this.registerPartial(this.options.recursion,a)},registerHelper:function(a,b){this.options.helpers[a]=b},unregisterHelper:function(a){delete this.options.helpers[a]},registerPartial:function(a,b){return this.partials[a]=l(this,b)},unregisterPartial:function(a){delete this.options.partials[a]},setTags:function(a){c(this,a)}},m}),function(a,b){"object"==typeof exports?module.exports=b(a):"function"==typeof define&&define.amd?define("VOM",[],function(){return b(a)}):a.VOM=b(a)}(this,function(a){"use strict";function b(a,c){for(var d=c.length;d--;)c[d][a.options.childNodes]&&b(a,c[d][a.options.childNodes]),delete p[a.id][c[d][a.options.idProperty]];return c}function c(a,b){return(b.parentNode?d(b.parentNode,a.options.childNodes):a.model).indexOf(b)}function d(a,b){return a[b]=a[b]||[],a[b]}function e(a,b,c,e,i,j){return a.options.moveCallback.call(a,b,i,j),b.parentNode?a.options.parentCheck&&g(a,b,c):h([b],a,c,i,j),a.type=i,a.sibling=j,b.parentNode===c&&e>b.index&&b.index!==-1&&e--,b=b.index!==-1&&b.parentNode&&f(a,b,!0)||b,d(c,a.options.childNodes).splice(e||0,0,b),b.parentNode=c,b}function f(a,c,e){return!e&&b(a,[c]),d(c.parentNode,a.options.childNodes).splice(c.index,1)[0]||c}function g(a,b,c){var d=c;for(b===c&&m("ERROR: can't move element inside itself",a.options);d=d.parentNode;)d===b&&m("ERROR: can't move parent inside it's own child",a.options)}function h(a,b,c,d,e){for(var f=(b.options,!1),g=!0,j=b.options.idProperty,k={},l=0,m=a.length;l<m;l++)k=a[l],f=!k.parentNode,k[j]||(k[j]="vom_"+q++,g=!1),p[b.id][k[j]]=k,k.parentNode=c||b.model.root,k.index=0,f&&(k=i(b,k,g)),b.options.preRecursionCallback.call(b,k,d,e),k[b.options.childNodes]&&h(k[b.options.childNodes],b,k),b.options.enrichModelCallback.call(b,k,d,e);return a}function i(a,b,c){var d=!1,e=a.options.enhanceMap,f=0,g=0,h="",i="",k="",l="",m={},n={},o=[];for(var p in b)if(f=e[p]&&e[p].length-1){g=e[p].indexOf("*"),m=s(b,e[p],g>-1?f-g+1:1),l=e[p].join("."),h=l.split("*")[1]||"",o=h.split(".").splice(1);for(var q in m)n=h?s(m[q],o,1):m,i=l.replace("*",q),k=o[o.length-1]||q,a.addProperty(k,[n,b],i)}else d="parentNode"===p||p===r,p===a.options.idProperty?j(b,p,b[p],c):(e[p]||e["*"]||d)&&a.addProperty(p,b,null,d);return b}function j(a,b,c,d,e){return delete a[b],Object.defineProperty(a,b,{enumerable:!!e,configurable:!1,writable:!!d,value:c})}function k(a,b,d,e,f,g,h){return Object.defineProperty(b[0]||b,a,{get:function(){return a===f?c(e,b[0]||b):d[h||a]},set:function(c){var g=d[h||a];d[h||a]=c,l(h||a,b,c,g,d,e,f)},enumerable:g})}function l(a,b,c,d,e,f,g){(a===f.options.idProperty||a===g||f.options.setterCallback.call(f,f.type||a,b[1]||b,c,d,f.sibling))&&(e[a]=d,m("ERROR: Cannot set property '"+a+"' to '"+c+"'",f.options)),delete f.type,delete f.sibling}function m(b,c){if(!c.throwErrors&&void 0!==a&&a.console)return console.warn?console.warn(b):console.log(b);throw b}var n=function(a,b){this.options={parentCheck:!1,idProperty:"id",setterCallback:function(){},enrichModelCallback:function(){},preRecursionCallback:function(){},moveCallback:function(){},enhanceMap:[],childNodes:"childNodes",throwErrors:!1},this.model=a||[],o(this,b||{})},o=function(a,b){var c="",d={};p.push({}),j(a,"id",p.length-1);for(var e in b)a.options[e]=b[e];for(;c=a.options.enhanceMap.shift();)c=c.split("."),a.options.enhanceMap[c[0]]=c;d[a.options.childNodes]=a.model,j(a.model,"root",d),h(a.model,a)},p=[],q=0,r="index",s=function(a,b,c){for(var d=0,e=b.length-(c||0);d<e;d++)a=a&&a[b[d]];return a};return n.prototype={getElementById:function(a){return p[this.id][a]},getElementsByProperty:function(a,b){var c=[],d=void 0!==b,e=void 0!==a,f=[],g=null;for(var h in p[this.id])g=void 0!==p[this.id][h][a]?p[this.id][h][a]:s(p[this.id][h],f[0]?f:f=e&&a.split(".")),(d&&g===b||!d&&void 0!==g||!d&&!e)&&c.push(p[this.id][h]);return c},appendChild:function(a,b){return b=b||this.model.root,e(this,a,b,d(b,this.options.childNodes).length,"appendChild",b)},prependChild:function(a,b){return e(this,a,b||this.model.root,0,"prependChild",b)},insertBefore:function(a,b){return e(this,a,b.parentNode,b.index,"insertBefore",b)},insertAfter:function(a,b){return e(this,a,b.parentNode,b.index+1,"insertAfter",b)},replaceChild:function(a,b){var c=b.index,d=b.parentNode;return a!==b&&f(this,b),e(this,a,d,c,"replaceChild",b),b},removeChild:function(a){return f(this,a),this.options.setterCallback.call(this,"removeChild",a),a},sortChildren:function(a,b,c){b=(b||this.model).sort(a);for(var d=0,e=b.length;d<e;d++)this.options.setterCallback.call(this,"sortChildren",b[d]),c&&b[d][this.options.childNodes]&&this.sort(a,b[d][this.options.childNodes],c)},reinforceProperty:j,addProperty:function(a,b,c,d){var e={};e[c||a]=(b[0]||b)[a],k(a,b,e,this,r,!d,c)},getProperty:function(a,b){return s(b,a.split("."))},getCleanModel:function(){return JSON.parse(JSON.stringify(this.model))},destroy:function(){return b(this,this.model)}},n}),function(a,b){"object"==typeof exports?module.exports=b(a,require("toolbox")):"function"==typeof define&&define.amd?define("controller",["toolbox"],function(c){return b(a,c)}):a.Controller=b(a,a.Toolbox)}(this,function(a,b){"use strict";var c=function(a){this.options={appElement:document.body,eventAttribute:"cr-event"},d(this,a)},d=function(a,c){for(var d in c)a.options[d]=c[d];a.events={};var e=a;a.eventDistributor=function(a,c,d){var f=b.closest(a.target,"["+c+"]")||d.element,g=f.getAttribute(c),h=d.getElementById(g)||d.getElementsByProperty("elements.element",d.element)[0];h||(h=d.getElementsByProperty("elements.element",a.target)[0]);var i=h&&h.events[a.type],j=!1,k={};for(var l in i)for(var m=i[l].length;m--;)k=i[l][m],j||k!==a.target&&!k.contains(a.target)||!e.options.eventListeners[l]||(j=e.options.eventListeners[l].call(d,a,k,h)===!1)&&a.stopPropagation()}};return c.prototype={getEventListeners:function(a,b,c,d){var e=b.querySelectorAll("["+this.options.eventAttribute+"]"),f="",g="",h="",i="",j=[];e=[b].concat([].slice.call(e));for(var k=e.length;k--;)if(f=e[k].getAttribute(this.options.eventAttribute)){j=f.split(/\s*;+\s*/);for(var l=j.length;l--;)g=j[l].split(/\s*:+\s*/),h=g[0],i=g[1],void 0===c[h]&&(c[h]={}),void 0===c[h][i]&&(c[h][i]=[]),c[h][i].push(e[k]),this.events[h]||(this.events[h]=!0)}this.installed||this.events==={}||this.installEventListeners(a,d)},installEventListeners:function(a,c){var d=this;for(var e in this.events)b.addEvent(this.options.appElement,e,function(b){d.eventDistributor(b,a.options.idProperty,c)},!!/(?:focus|blur)/.test(e),this);this.installed=!0},destroy:function(){b.removeEvent(this)}},c}),function(a,b){"object"==typeof exports?module.exports=b(a,require("toolbox"),require("controller"),require("schnauzer"),require("VOM")):"function"==typeof define&&define.amd?define("circular",["toolbox","controller","schnauzer","VOM"],function(c,d,e,f){return b(a,c,d,e,f)}):a.Circular=b(a,a.Toolbox,a.Controller,a.Schnauzer,a.VOM)}(this,function(a,b,c,d,e){"use strict";function f(a,b,c,d,e){var f="string"==typeof b,g="prependChild"===c,h={};return f?(a.innerHTML=b,h=a.children[0]):h=b,m(function(){(g||"insertAfter"===c)&&(e=e&&e.nextSibling||g&&d.children[0],c=e?"insertBefore":"appendChild"),(d||h.parentElement)[c](h,e)}),h}function g(a,b,c){var d=o(c,"["+a.viewAttr+"]"),e="";d=[c].concat([].slice.call(d));for(var f=d.length;f--;)(e=d[f].getAttribute(a.viewAttr))&&(b[e]=d[f])}function h(a,b,c,d,e){for(var f in a.prototype)d[f]||(e[f]=function(a){return function(){return b[a].apply(b,arguments)}}(f));return e}function i(a,b,c){var d={},e={};if(c)c[0]?c[1].insertBefore(c[2],c[0]):c[1].appendChild(c[2]);else if(a&&b)return d=n(a,"["+b+"]"),d&&(e=document.createDocumentFragment(),c=[d.nextSibling,d.parentNode,e],e.appendChild(d)),c}function j(a,b,c,e){for(var f=a.containerAttr,g=c.hasAttribute(f)?c:n(c,"["+f+'="'+e+'"]')||n(c,"["+f+"]"),h=n(document.body,"["+a.templateAttr+'="'+e+'"]'),i=o(document.body,"["+a.templatesAttr+'="'+e+'"]')||[],j={},k=i.length;k--;)j[i[k].id||i[k].getAttribute("name")]=new(a.Template||d)(i[k].innerHTML,{doEscape:!1,helpers:b.helpers||a.helpers||{}});return{element:c,template:h?h.innerHTML:h,templates:j,container:g}}var k=function(a){this.options={componentAttr:"cr-component",containerAttr:"cr-container",templateAttr:"cr-template-for",templatesAttr:"cr-template",eventAttribute:"cr-event",viewAttr:"cr-view",elements:"elements",events:"events",views:"views"},l(this,a)},l=function(a,b){for(var c in b)a.options[c]=b[c];a.version="0.1.0",a.components={},a.id="cr_"+p++},m=a.requestAnimationFrame||a.webkitRequestAnimationFrame||function(a){a()},n=b.$,o=b.$$,p=0,q={};return k.prototype.component=function(a,b){var k={},l={},m=this.options,o=m.elements,p=b.extraModel||m.extraModel,r=m.componentAttr,s="["+r+'="'+a+'"]',t=n(document.body,s),u=i(t,r),v=j(m,b,t,a),w=this.components[a]={name:a,model:b.model||[],element:v.element,container:v.container};return q[this.id]=q[this.id]||{},k=q[this.id][a]={},k.helper=document.createElement("div"),k.controller=b.eventListeners&&new c({appElement:v.element,eventListeners:b.eventListeners}),k.template=v.template?new(m.Template||d)(b.template||v.template,{doEscape:!1,helpers:b.helpers||m.helpers||{}}):null,w.templates=v.templates,k.vom=new e(w.model,{preRecursionCallback:function(a,c,d){var e=k.template&&k.template.partials.self&&k.template.render(a,p),h=c||"appendChild",i="replaceChild"===c&&d[o].element,j=a.parentNode[o]&&a.parentNode[o].container,l=e&&q||j||w.container,q=l?i||void 0:d&&d[o].element,r=e&&f(k.helper,e,h,l,q)||w.element;this.reinforceProperty(a,o,{element:r,container:b.mountSelector&&n(r,b.mountSelector)},!0),this.reinforceProperty(a,m.events,{},!0),k.controller&&k.controller.getEventListeners(this,a[o].element||w.element,a[m.events],w),this.reinforceProperty(a,m.views,{},!0),g(m,a[m.views],a[o].element||w.element),b.preRecursionCallback&&b.preRecursionCallback.call(this,a)},enrichModelCallback:this.options.enrichModelCallback||b.enrichModelCallback||function(){},enhanceMap:this.options.enhanceMap||b.enhanceMap||[],setterCallback:function(a,c,d,e,h){var i=c[o]&&c[o].element,j=c.parentNode&&c.parentNode[o]?c.parentNode[o].element:w.container;"removeChild"===a?f(k.helper,i,a,i.parentElement):"sortChildren"===a?f(k.helper,i,"appendChild",j):this[a]&&(c===h?(i=f(k.helper,k.template.render(c,p),a,j,h[o].element),c[o].element=i,c[o].container=b.mountSelector&&n(i,b.mountSelector),c[m.events]={},k.controller&&k.controller.getEventListeners(this,c[o].element||w.element,c[m.events],w),c[m.views]={},g(m,c[m.views],c[o].element||w.element)):"replaceChild"!==a&&f(k.helper,i,a,j,h[o]&&h[o].element)),b.setterCallback&&b.setterCallback.call(this,a,c,d,e)}}),i(null,null,u),l=h(d,k.template,w,this,l),l=h(e,k.vom,w,this,{render:l.render}),w.__proto__=l,w},k.prototype.destroy=function(){var a=q[this.id];for(var b in a)for(var c in a[b])a[b][c]&&a[b][c].destroy&&a[b][c].destroy()},k.Toolbox=b,k});
//# sourceMappingURL=circular.js.map