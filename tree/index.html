<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<link rel="stylesheet" type="text/css" href="index.css">
	<link rel="stylesheet" type="text/css" href="js-tree.css">
	<link rel="stylesheet" type="text/css" href="js-tree-app.css">

	<title>JS Tree</title>
</head>
<body>
<div id="appWrapper">
	<div id="appTop">

	</div>
	<div id="contentWrapper">
		<div id="appLeft">

			<ul class="js-tree" data-jstree="container" cr-component="tree" cr-container="">
				<script type="text/template" data-jstree="template" cr-template-for="tree">
					<li class="js-tree-leaf{{#if childNodes}} hasChildren{{/if}}{{^childNodes}} hasNoChildren{{/childNodes}}{{#isOpen}} isOpen{{/isOpen}}" id="{{id}}" name="{{name}}" data-jstree="leaf">
						{{#isLast}}<em class="sizer" cr-event="mousedown: resize" data-dnd="no-offset no-scroll"></em>{{/isLast}}
						<a hrefs="{{text}}" cr-view="link" cr-event="click: listLink" title="{{title}}" class="link{{#class}} {{class}}{{/class}}">
							<em class="dropdown" cr-event="click: dropdown; mousedown: mousedown"></em>
							<em class="toggle" cr-event="click: toggle"></em>
							<em class="publish" cr-event="click: publish"></em><span cr-view="text">{{text}}</span>
						</a>
						{{#if childNodes}}<ul class="js-tree-branch" data-jstree="branch"></ul>{{/if}}
					</li>
				</script>
			</ul>

		</div>
		<div id="appMid">

			<!-- <iframe src="./iframe/index.html" style="border: 0" height="100%" width="100%"></iframe> -->

		</div>
		<div id="appRight">
			<div draggable="true" class="js-drop">DropZone<div class="disturbor">Disturbor</div></div>
		</div>
	</div>

</div>

<!-- <script type="text/javascript" src="../toolbox.js"></script>
<script type="text/javascript" src="../VOM.js"></script>
<script type="text/javascript" src="../controller.js"></script>
<script type="text/javascript" src="../schnauzer.js"></script>
<script type="text/javascript" src="../DOMinator.js"></script> -->
<script type="text/javascript" src="../circular.min.js"></script>
<script type="text/javascript" src="model.js"></script>
<script type="text/javascript">
(function(window, undefined) {
	'use strict';

	var dummy = function dummy(e, element, item) {
			console.log(e.type, e.target, element, item);
		},
		dummySP = function dummySP(e, element, item) {
			console.log(e.type, e.target, element, item);
			return false;
		};

	// ----- install tree
	var circular = window.circular = new Circular({
			helpers: {
				if: function(text, $1) {
					if (this.getData($1)) {
						return text;
					}
				}
			}
		});

	window.tree = circular.component('tree', {
		eventListeners: {
			listLink: dummy,
			dropdown: dummySP,
			toggle: dummySP,
			publish: dummySP,
			mousedown: dummySP,
			resize: dummySP
		},
		model: treeModel,
		mountSelector: '[data-jstree="branch"]',
		enhanceMap: ['text', 'isOpen'], // isOpen not present...??
		setterCallback: function(property, item, value, oldValue) {
			if (property === 'text') {
				item.views.text.textContent = value;
			}
		}
	});

	// test...
	// var tree = circular.components.tree;
	// var parent = tree.model[0].childNodes[0];
	// var newItems = window.treeModelExt[0];
	// var items = tree.appendChild(newItems, parent);
})(window);
</script>
</body>
</html>